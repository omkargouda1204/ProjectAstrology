<!DOCTYPE html>
<html lang="en">
<head>
            <script>
            // Ensure globalChatbotConfig is defined to prevent ReferenceError
            window.globalChatbotConfig = window.globalChatbotConfig || {
                welcome_message: ''
            };
            </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sri Mahakali Bhairavi Astrology Center | Best Astrologer in Mysuru | ಶ್ರೀ ಮಹಾಕಾಳಿ ಭೈರವಿ ಜ್ಯೋತಿಷ್ಯ ಕೇಂದ್ರ</title>
    <meta name="description" content="Sri Mahakali Bhairavi Astrology Center - Expert Vedic astrology services, horoscope reading, kundali matching, pooja services in Mysuru, Karnataka. Best astrologer Venkatanatha Kulakarni. ಶ್ರೀ ಮಹಾಕಾಳಿ ಭೈರವಿ ಜ್ಯೋತಿಷ್ಯ ಕೇಂದ್ರ - ಮೈಸೂರಿನಲ್ಲಿ ಅತ್ಯುತ್ತಮ ಜ್ಯೋತಿಷ್ಯ ಸೇವೆಗಳು.">
    <meta name="keywords" content="Best astrologer Mysuru, Sri Mahakali Bhairavi Astrology, Venkatanatha Kulakarni astrologer, Om Sri Mahakali Bhairavi Jyotishya Shastram, Astrology services Mysuru, Horoscope reading Mysore, Kundali matching Karnataka, Pooja puja services, Vedic astrology consultation, Remedies parihara, Jyotish services, Nadi astrology, Marriage compatibility, Birth chart analysis, Vastu consultation, Numerology services, Gemstone recommendation, Graha shanti pooja, Nakshatra analysis, Dasha predictions, Rashi phal, Best jyotishi Mysuru, Famous astrologer Karnataka, Online astrology consultation, Telephone astrology, Mysuru jyotish kendra, ಮೈಸೂರು ಜ್ಯೋತಿಷ್ಯರು, ಜ್ಯೋತಿಷ್ಯ ಶಾಸ್ತ್ರ, ಕುಂಡಲಿ ಗುರು, ಪರಿಹಾರ ಪೂಜೆ, ವೇದಿಕ್ ಜ್ಯೋತಿಷ್ಯ, ಹೊರೊಸ್ಕೋಪ್ ರೀಡಿಂಗ್, ನವಗ್ರಹ ಶಾಂತಿ ಪೂಜೆ, ವಾಸ್ತು ಸಲಹೆ, ಮೈಸೂರು ಅತ್ಯುತ್ತಮ ಜ್ಯೋತಿಷ್ಯ, ಕರ್ನಾಟಕ ಜ್ಯೋತಿಷ್ಯ ಕೇಂದ್ರ, ಆನ್ಲೈನ್ ಜ್ಯೋತಿಷ್ಯ ಸಲಹೆ, ಜನ್ಮ ಪತ್ರಿಕೆ ವಿಶ್ಲೇಷಣೆ, ಮದುವೆ ಹೊಂದಾಣಿಕೆ, ಗ್ರಹ ಶಾಂತಿ ಪೂಜೆ, ರಾಶಿ ಫಲ, ನಕ್ಷತ್ರ ವಿಶ್ಲೇಷಣೆ, ದಶಾ ಭವಿಷ್ಯ, Mysore astrologer, Karnataka astrology center, South India astrologer, Temple pooja services">
    <meta name="author" content="Venkatanatha Kulakarni">
    <meta name="language" content="English, Kannada, Hindi">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <link rel="canonical" href="https://astrology-center.com/">
    
    <!-- Fonts - Load First for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.15.4/css/all.css">
    <link rel="stylesheet" href="/static/styles/main.css">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Critical Base Styles - Clean, No Animations -->
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; overflow-x: hidden !important; }
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            background: #f9fafb;
            overflow-x: hidden !important;
            max-width: 100vw !important;
            width: 100% !important;
        }
        img { max-width: 100%; height: auto; display: block; }
        .goog-te-banner-frame { display: none !important; }
        body { top: 0 !important; }
        
        /* GLOBAL: Remove ALL unwanted scrollbars */
        html, body {
            overflow-x: hidden !important;
            max-width: 100vw !important;
        }
        *, *::before, *::after { 
            max-width: 100vw;
        }
        section, .container, main, header, footer, nav {
            overflow-x: hidden !important;
        }
        /* Remove scrollbars from gallery and reviews containers */
        #gallery, #reviews {
            overflow: hidden !important;
        }
        #gallery-slides-container, #reviews-carousel {
            overflow: visible !important;
        }
        /* Hide scrollbar for Chrome, Safari and Opera */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE, Edge and Firefox */
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* Hero slide - STATIC, no transitions */
        .hero-slide { 
            opacity: 0; 
            visibility: hidden; 
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .hero-slide.active { 
            opacity: 1 !important; 
            visibility: visible !important; 
            z-index: 2 !important; 
        }
        
        /* Service cards - Clean, minimal hover */
        .service-card {
            background: rgba(255, 255, 255, 0.95);
        }
        
        .service-card:hover {
            box-shadow: 0 10px 25px rgba(124, 58, 237, 0.15);
        }
        
        .shadow-3xl {
            box-shadow: 0 35px 70px rgba(0, 0, 0, 0.2);
        }
        
        /* Line clamp utility for descriptions */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .line-clamp-4 {
            display: -webkit-box;
            -webkit-line-clamp: 4;
            line-clamp: 4;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Reviews Carousel - Clean horizontal scroll */
        #reviews-carousel {
            display: flex;
            gap: 16px;
            flex-wrap: nowrap !important;
        }
        
        /* Review Cards - Fixed size, no animations */
        .review-card {
            flex-shrink: 0;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 280px;
            min-width: 280px;
            max-width: 280px;
        }
        
        @media (max-width: 640px) {
            .review-card {
                width: 240px;
                min-width: 240px;
                max-width: 240px;
                min-height: 180px;
            }
            .review-card p {
                font-size: 0.875rem;
                line-height: 1.4;
            }
        }
        
        @media (min-width: 641px) and (max-width: 1024px) {
            .review-card {
                width: 260px;
                min-width: 260px;
                max-width: 260px;
                min-height: 200px;
            }
        }
        
        @media (min-width: 1025px) {
            .review-card {
                width: 300px;
                min-width: 300px;
                max-width: 300px;
                min-height: 220px;
            }
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .service-card {
                padding: 1rem !important;
                width: 200px !important;
                min-width: 200px !important;
                max-width: 200px !important;
                flex-shrink: 0 !important;
                flex-grow: 0 !important;
            
            .service-card h3 {
                height: 150px !important;
                line-height: 1.3 !important;
            }
            
            #astrological-services-grid {
                gap: 0.75rem !important;
                padding: 0 0.5rem;
            }
        }
        
        /* Tablet responsive design */
        @media (min-width: 768px) and (max-width: 1023px) {
            #astrological-services-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 1.5rem;
            }
            
            .service-card h3 {
                font-size: 1.125rem !important;
            }
        }
        
        /* Desktop responsive design */
        @media (min-width: 1024px) {
            .service-card {
                padding: 2rem !important;
            }
            
            .service-card:hover {
                transform: translateY(-20px) scale(1.1);
            }
            
            #astrological-services-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 2rem;
                max-width: 1400px;
            }
        }
        
        /* Large desktop */
        @media (min-width: 1440px) {
            #astrological-services-grid {
                grid-template-columns: repeat(5, 1fr);
                gap: 2.5rem;
            }
        }
        
        /* Extra large screens */
        @media (min-width: 1920px) {
            #astrological-services-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 3rem;
            }
        }
        
        /* Logo styles - Direct display (no round shape) - Responsive */
        .logo-container img, .navbar-logo {
            border-radius: 0 !important;
            object-fit: contain !important;
            border: none !important;
            background: transparent !important;
            transition: transform 0.3s ease !important;
        }
        
        .logo-container img:hover, .navbar-logo:hover {
            transform: scale(1.05) !important;
        }
        
        /* Responsive Logo Sizes */
        @media (max-width: 480px) {
            .logo-container img, #navbar-logo {
                max-width: 120px !important;
                max-height: 80px !important;
                height: auto !important;
            }
            #website-name {
                font-size: 0.875rem !important;
                line-height: 1.2 !important;
            }
        }
        @media (min-width: 481px) and (max-width: 640px) {
            .logo-container img, #navbar-logo {
                max-width: 150px !important;
                max-height: 100px !important;
                height: auto !important;
            }
            #website-name {
                font-size: 1rem !important;
            }
        }
        @media (min-width: 641px) and (max-width: 768px) {
            .logo-container img, #navbar-logo {
                max-width: 180px !important;
                max-height: 120px !important;
                height: auto !important;
            }
            #website-name {
                font-size: 1.25rem !important;
            }
        }
        @media (min-width: 769px) and (max-width: 1024px) {
            .logo-container img, #navbar-logo {
                max-width: 220px !important;
                max-height: 140px !important;
                max-width: 240px !important;
                flex-shrink: 0 !important;
                flex-grow: 0 !important;
            }
            #website-name {
                font-size: 1.5rem !important;
            }
        }
        @media (min-width: 1025px) {
            .logo-container img, #navbar-logo {
                max-width: 280px !important;
                max-height: 180px !important;
                height: auto !important;
            }
            #website-name {
                font-size: 2rem !important;
            }
        }
        
        /* Animation classes - disabled for static layout */
        .fade-in, .slide-in-left, .slide-in-right, .scale-in {
            opacity: 1;
        }
        
        /* Hover Effects */
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Image container - no zoom effects */
        .image-zoom {
            overflow: hidden;
        }
        .image-zoom img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .about-visual {
            overflow: hidden;
        }
        
        /* Smooth Transitions */
        * {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Service Card Enhancement */
        .service-card {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(147, 51, 234, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .service-card:hover::before {
            left: 100%;
        }
        
        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(147, 51, 234, 0.2);
        }
        
        /* Button Hover Effects */
        .btn-hover {
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .btn-hover::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
            z-index: -1;
        }
        
        .btn-hover:hover::before {
            width: 300px;
            height: 300px;
        }
        
        /* Comprehensive Responsive Utilities */
        @media (max-width: 640px) {
            .container { padding-left: 1rem; padding-right: 1rem; }
            h1 { font-size: 1.875rem !important; line-height: 1.2 !important; }
            h2 { font-size: 1.5rem !important; line-height: 1.3 !important; }
            h3 { font-size: 1.25rem !important; line-height: 1.3 !important; }
            
            /* Navbar mobile improvements */
            #main-navbar { padding-top: 0.5rem; padding-bottom: 0.5rem; }
            #mobile-menu { max-height: calc(100vh - 5rem); overflow-y: auto; }
            #mobile-menu-items a { font-size: 0.95rem; padding: 0.75rem 1rem; }
            
            /* Reviews carousel mobile */
            #reviews-carousel .review-card { 
                margin-bottom: 1rem; 
                padding: 0.5rem !important;
            }
            #reviews-carousel .review-card .bg-white { 
                padding: 1rem !important; 
            }
            #reviews-carousel .review-card img {
                width: 3rem !important;
                height: 3rem !important;
            }
            #reviews-carousel .review-card h4 {
                font-size: 1rem !important;
            }
            #reviews-carousel .review-card p {
                font-size: 0.875rem !important;
                line-height: 1.4 !important;
            }
            #review-dots {
                gap: 0.5rem !important;
                padding: 0.5rem 0 !important;
            }
            
            /* Gallery mobile */
            #gallery-slides-container { gap: 0.75rem !important; }
            
            /* Service cards mobile */
            .service-card { 
                margin-bottom: 1rem !important;
                padding: 1rem !important;
            }
            .service-card h3 { font-size: 1.1rem !important; }
            .service-card p { font-size: 0.875rem !important; }
            
            /* FAQ mobile */
            .faq-item, .faq-question { 
                padding: 0.875rem !important; 
                font-size: 0.95rem !important;
            }
            
            /* Footer mobile */
            footer { padding: 2rem 0 !important; }
            footer .grid { 
                grid-template-columns: 1fr !important; 
                gap: 1.5rem !important; 
            }
            footer h3, footer h4 { 
                font-size: 1.125rem !important; 
                margin-bottom: 0.75rem !important;
            }
            footer p, footer a, footer li { 
                font-size: 0.875rem !important; 
            }
            footer .text-center p { 
                font-size: 0.75rem !important; 
            }
            
            /* Contact section mobile */
            .contact-info p, .contact-info a {
                font-size: 0.875rem !important;
            }
            
            /* Button sizes mobile */
            .btn, button {
                padding: 0.625rem 1.25rem !important;
                font-size: 0.875rem !important;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 375px) {
            h1 { font-size: 1.5rem !important; }
            h2 { font-size: 1.25rem !important; }
            h3 { font-size: 1.1rem !important; }
            
            #reviews-carousel .review-card img {
                width: 2.5rem !important;
                height: 2.5rem !important;
            }
            
            #review-dots button {
                width: 0.5rem !important;
                height: 0.5rem !important;
            }
        }
        
        /* Tablet responsive */
        @media (min-width: 641px) and (max-width: 1024px) {
            .container { padding-left: 1.5rem; padding-right: 1.5rem; }
            h1 { font-size: 2.25rem !important; }
            h2 { font-size: 1.875rem !important; }
            h3 { font-size: 1.5rem !important; }
            
            #reviews-carousel { padding: 0 1.5rem; }
            #reviews-carousel .review-card img {
                width: 4rem !important;
                height: 4rem !important;
            }
            
            footer .grid { 
                grid-template-columns: repeat(2, 1fr) !important; 
                gap: 2rem !important;
            }
            
            .service-card {
                padding: 1.5rem !important;
            }
        }
        
        /* Large screens */
        @media (min-width: 1025px) {
            .container { max-width: 1280px; }
            h1 { font-size: 2.5rem !important; }
            h2 { font-size: 2rem !important; }
            h3 { font-size: 1.75rem !important; }
            
            footer .grid { 
                grid-template-columns: repeat(3, 1fr) !important; 
            }
            
            #reviews-carousel .review-card img {
                width: 5rem !important;
                height: 5rem !important;
            }
        }
        
        /* Very small mobile devices */
        @media (max-width: 480px) {
            #hero-slider { height: 60vh !important; min-height: 400px !important; }
            .hero-slide h1 { font-size: 1.5rem !important; padding: 0 1rem !important; }
            .hero-slide p { font-size: 0.875rem !important; padding: 0 1rem !important; }
            
            /* Enhanced mobile hero slider buttons - Fully Responsive */
            #prev-slide, #next-slide {
                min-width: 36px !important;
                min-height: 36px !important;
                width: 36px !important;
                height: 36px !important;
                padding: 0.5rem !important;
                font-size: 0.875rem !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }
            
            @media (min-width: 640px) {
                #prev-slide, #next-slide {
                    min-width: 48px !important;
                    min-height: 48px !important;
                    width: 48px !important;
                    height: 48px !important;
                    padding: 12px !important;
                }
            }
            
            @media (min-width: 768px) {
                #prev-slide, #next-slide {
                    min-width: 52px !important;
                    min-height: 52px !important;
                    width: 52px !important;
                    height: 52px !important;
                    padding: 14px !important;
                }
            }
            
            @media (min-width: 1024px) {
                #prev-slide, #next-slide {
                    min-width: 56px !important;
                    min-height: 56px !important;
                    width: 56px !important;
                    height: 56px !important;
                    padding: 16px !important;
                }
            }
            
            /* Original styles */
            #prev-slide, #next-slide {
                min-width: 48px !important;
                min-height: 48px !important;
                padding: 12px !important;
                margin: 8px !important;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
            }
            
            #prev-slide {
                left: 4px !important;
            }
            
            #next-slide {
                right: 4px !important;
            }
        }
        
        /* Touch interaction improvements */
        .touch-manipulation {
            touch-action: manipulation;
            -webkit-tap-highlight-color: rgba(0,0,0,0.1);
        }
        
        /* Hero slider button enhancements */
        #prev-slide:active, #next-slide:active {
            transform: translate(-50%, -50%) scale(0.95);
        }
        
        @media (hover: none) and (pointer: coarse) {
            /* Mobile/touch devices */
            #prev-slide, #next-slide {
                opacity: 0.8 !important;
            }
        }
        
        /* Scroll Animation Classes */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .slide-in-left {
            opacity: 0;
            transform: translateX(-50px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .slide-in-left.visible {
            opacity: 1;
            transform: translateX(0);
        }
        .slide-in-right {
            opacity: 0;
            transform: translateX(50px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .slide-in-right.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        /* Service Card Hover Animation */
        .service-card {
            transition: all 0.3s ease;
        }
        .service-card:hover {
            transform: translateY(-10px);
        }
        
        /* Pooja Circle Glow Effect */
        .pooja-circle {
            position: relative;
            transition: all 0.3s ease;
        }
        .pooja-circle::before {
            content: '';
            position: absolute;
            inset: -5px;
            border-radius: 50%;
            background: linear-gradient(45deg, #f59e0b, #ef4444);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
            filter: blur(15px);
        }
        .pooja-circle:hover::before {
            opacity: 0.6;
        }
        .pooja-circle:hover {
            transform: scale(1.05);
        }
    </style>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/styles/main.css">
    <script type="text/javascript">
        // Google Translate initialization
        function googleTranslateElementInit() {
            console.log('🌐 Initializing Google Translate...');
            try {
                // Desktop translate element
                new google.translate.TranslateElement({
                    pageLanguage: 'en',
                    includedLanguages: 'en,hi,kn,mr,ta,te,gu,ml,pa,bn,or,as,ur,sa',
                    layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                    autoDisplay: false
                }, 'google_translate_element');
                
                // Mobile translate element
                new google.translate.TranslateElement({
                    pageLanguage: 'en',
                    includedLanguages: 'en,hi,kn,mr,ta,te,gu,ml,pa,bn,or,as,ur,sa',
                    layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                    autoDisplay: false
                }, 'google_translate_element_mobile');
                
                console.log('✅ Google Translate initialized for desktop and mobile');
            } catch (error) {
                console.error('Google Translate initialization error:', error);
            }
        }
        // Expose to global scope so Google callback works on all devices
        window.googleTranslateElementInit = googleTranslateElementInit;
        
        // Language change function (same as contact.html)
        function changeLanguage(langCode, langName) {
            console.log('Changing language to:', langCode, langName);
            
            var attempts = 0;
            var maxAttempts = 50;
            
            var waitForGoogleTranslate = setInterval(function() {
                attempts++;
                var translateElement = document.querySelector('.goog-te-combo');
                
                if (translateElement) {
                    console.log('Found translate element, changing to:', langCode);
                    clearInterval(waitForGoogleTranslate);
                    
                    translateElement.value = langCode;
                    var event = new Event('change', { bubbles: true });
                    translateElement.dispatchEvent(event);
                    
                    setTimeout(function() {
                        translateElement.dispatchEvent(new Event('click'));
                    }, 100);
                    
                    // Update UI
                    var currentLangElement = document.getElementById('current-language');
                    if (currentLangElement) {
                        currentLangElement.textContent = langName;
                    }
                    
                    // Close dropdown
                    var dropdown = document.getElementById('lang-dropdown');
                    if (dropdown) {
                        dropdown.classList.add('hidden');
                    }
                    
                    console.log('Language changed successfully!');
                } else if (attempts >= maxAttempts) {
                    clearInterval(waitForGoogleTranslate);
                    console.error('Google Translate element not found');
                    alert('Translation not ready yet. Please wait a moment and try again.');
                }
            }, 100);
        }
    </script>
    
    <!-- Custom Styles for Google Translate and Navbar -->
    <style>
        /* Enhanced Google Translate Styling */
        .goog-te-banner-frame { 
            display: none !important; 
        }
        
        .goog-te-menu-value { 
            padding: 8px !important; 
            margin: 0 !important;
        }
        
        .goog-te-gadget-simple { 
            background-color: transparent !important; 
            border: none !important; 
            font-size: 14px !important;
            padding: 8px !important;
            width: 100% !important;
        }
        
        .goog-te-combo { 
            background-color: rgba(255, 255, 255, 0.95) !important; 
            border: 2px solid rgba(139, 69, 19, 0.2) !important; 
            border-radius: 8px !important; 
            padding: 8px 12px !important;
            font-size: 14px !important;
            color: #6B46C1 !important;
            font-weight: 600 !important;
            backdrop-filter: blur(8px);
            min-width: 140px !important;
            height: auto !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1) !important;
            transition: all 0.3s ease !important;
        }
        .goog-te-combo:hover {
            background-color: white !important;
            border-color: #6B46C1 !important;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15) !important;
            transform: translateY(-1px);
        }
        
        .goog-te-combo:focus {
            outline: none !important;
            border-color: #6B46C1 !important;
            box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.2) !important;
        }
        
        /* Language dropdown overlay below navbar */
        #lang-dropdown {
            scrollbar-width: none !important;
            -ms-overflow-style: none !important;
        }
        #lang-dropdown::-webkit-scrollbar {
            display: none !important;
        }
        
        #lang-dropdown.hidden {
            display: none !important;
        }
        
        /* Translate elements in navbar */
        .translate-element .goog-te-gadget-simple {
            background: transparent !important;
            border: none !important;
        }
        .translate-element-mobile .goog-te-gadget-simple {
            background: transparent !important;
            border: none !important;
        }
        /* Quick action buttons responsiveness */
        .quick-action-btn {
            min-width: 140px;
            justify-content: center;
        }
        @media (max-width: 640px) {
            .quick-action-btn {
                width: 100%;
                font-size: 0.9rem !important;
                padding: 0.55rem 0.75rem !important;
            }
        }
        @media (min-width: 641px) and (max-width: 1024px) {
            .quick-action-btn {
                padding: 0.6rem 1.25rem !important;
                font-size: 0.95rem !important;
            }
        }
        
        /* Remove Google Translate top bar */
        body { top: 0 !important; }
        
        /* Navbar Animation */
        /* Mobile Menu overlay below navbar */
        #mobile-menu { 
            transition: all 0.3s ease;
            scrollbar-width: none !important;
        }
        #mobile-menu::-webkit-scrollbar { 
            display: none !important;
        }
    </style>


    <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    
    <script>
        function convertToLocalUrl(url) {
            if (!url) {
                return '';
            }
            // Already-local or data URI
            if (url.startsWith('/uploads/') || url.startsWith('data:')) {
                return url;
            }
            try {
                const urlObj = new URL(url, window.location.origin);
                let filePath = urlObj.pathname;
                // Handle Supabase public bucket path: /storage/v1/object/public/<bucket>/<folder>/filename
                const storageMarker = '/storage/v1/object/public/';
                const markerIndex = filePath.indexOf(storageMarker);
                if (markerIndex !== -1) {
                    filePath = filePath.substring(markerIndex + storageMarker.length);
                }
                // Take only the last segment (filename) to map into /uploads
                const parts = filePath.split('/').filter(Boolean);
                const filename = (parts.pop() || '').split('?')[0];
                return filename ? `/uploads/${filename}` : '';
            } catch (error) {
                console.error('Invalid URL for convertToLocalUrl:', url);
                // Fallback simple extraction
                try {
                    const parts = url.split('/');
                    const filename = (parts.pop() || '').split('?')[0];
                    return filename ? `/uploads/${filename}` : '';
                } catch (_) {
                    return '';
                }
            }
        }
    </script>
    
    <!-- Global Responsive Styles - Prevent all scroll issues -->
    <style>
        /* Universal overflow control */
        html, body {
            overflow-x: hidden !important;
            max-width: 100vw !important;
            width: 100% !important;
        }
        
        /* Ensure all sections fit within viewport */
        section, .container, main, header, footer, nav {
            overflow-x: hidden !important;
            max-width: 100vw !important;
        }
        
        /* Image responsiveness */
        img, video, iframe {
            max-width: 100% !important;
        }
        
        /* Review card fixed width */
        .review-card {
            width: 280px !important;
            min-width: 280px !important;
            flex-shrink: 0 !important;
        }
        
        @media (min-width: 768px) {
            .review-card {
                width: 300px !important;
                min-width: 300px !important;
            }
        }
    </style>
</head>
<body class="font-sans bg-gray-50">

    <!-- Loading Screen with Higher Z-Index -->
    <div id="loading-screen" class="fixed inset-0 bg-gradient-to-br from-purple-900 via-purple-700 to-indigo-900 flex items-center justify-center" style="z-index: 9999;">
        <div class="text-center px-4">
            <div class="relative mb-8">
                <div class="w-24 h-24 border-8 border-purple-300 border-t-white rounded-full animate-spin mx-auto"></div>
                <i class="fas fa-star absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-white text-3xl animate-pulse"></i>
            </div>
            <h2 id="loading-business-name" class="text-2xl sm:text-3xl font-bold text-white mb-2">Loading...</h2>
            <p class="text-purple-200 text-base sm:text-lg">Preparing your cosmic journey</p>
        </div>
    </div>
    
    <!-- Main Content Wrapper - Hidden until loaded -->
    <div id="main-content" style="opacity: 0; visibility: hidden; transition: opacity 0.5s ease, visibility 0s 0.5s;">
<!-- Clean Header Section (HEIGHT INCREASED) -->
<header class="bg-white border-b-2 border-gray-200 shadow-md" 
        style="min-height: 100px; overflow: visible;">

    <div class="container mx-auto px-2 sm:px-4 h-full flex items-center py-2 sm:py-3">

        <!-- LEFT SIDE (Logo + Name + Subtitle) -->
        <div class="flex items-center space-x-2 sm:space-x-4 md:space-x-6 flex-1 min-w-0">

            <!-- Logo -->
            <div class="flex-shrink-0">
                <img 
                    id="navbar-logo" 
                    src="" 
                    alt="Logo" 
                    class="h-16 sm:h-20 md:h-24 lg:h-28 xl:h-32 w-auto object-contain"
                    style="max-height: 90px;"
                    loading="eager"
                >
            </div>

            <!-- Name + Subtitle -->
            <div class="flex flex-col justify-center min-w-0 flex-1">
                <h1 id="website-name"
                    class="text-sm sm:text-lg md:text-xl lg:text-2xl xl:text-3xl font-bold text-gray-800 leading-tight break-words"
                    style="font-size: clamp(0.875rem, 3vw, 2rem); line-height: 1.2; word-wrap: break-word; overflow-wrap: break-word;">
                    Loading...
                </h1>

                <p id="website-subtitle"
                    class="text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl text-gray-600 font-medium mt-0.5 sm:mt-1 break-words"
                    style="font-size: clamp(0.75rem, 2vw, 1.125rem); line-height: 1.2; word-wrap: break-word; overflow-wrap: break-word;">
                    Loading...
                </p>
            </div>

        </div>

       
</header>


<!-- MAIN NAVIGATION BAR -->
<nav id="main-navbar" class="bg-gradient-to-r from-purple-700 via-purple-600 to-indigo-700 text-white sticky top-0 z-50 shadow-xl">
    <div class="container mx-auto px-2 sm:px-4">
        <div class="flex items-center justify-between h-14 sm:h-16">
            
            <!-- Mobile: Hamburger Menu Button -->
            <button id="mobile-menu-btn" class="lg:hidden flex items-center justify-center w-10 h-10 rounded-lg hover:bg-white/20 transition-all" aria-label="Toggle Menu">
                <i class="fas fa-bars text-xl"></i>
            </button>

            <!-- Desktop Menu - Shows ALL items -->
            <div id="desktop-menu" class="hidden lg:flex items-center justify-center flex-1 space-x-1 xl:space-x-2 overflow-x-auto">
                <!-- Dynamic Items will be loaded here -->
            </div>

            <!-- Language Selector - Visible on ALL devices -->
            <div class="relative flex-shrink-0">
                <button id="lang-dropdown-btn" class="flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg hover:bg-white/20 transition-all text-sm sm:text-base">
                    <i class="fas fa-globe text-base sm:text-lg"></i>
                    <span class="hidden xs:inline text-xs sm:text-sm">EN</span>
                    <i class="fas fa-chevron-down text-xs"></i>
                </button>
            </div>
        </div>

    </div>
</nav>

<!-- Language Dropdown Panel - Floating white card matching screenshot -->
<div id="lang-dropdown" class="hidden fixed bg-white rounded-2xl shadow-xl border border-gray-100" style="top: 65px; right: 15px; z-index: 9999; width: 300px; max-height: 450px; overflow-y: auto; overflow-x: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.15);">
    <div class="px-5 py-4 border-b border-gray-100">
        <h3 class="text-sm font-bold text-gray-800">Select Language</h3>
    </div>
    <div class="p-4">
        <div id="google_translate_element" class="translate-widget"></div>
    </div>
</div>

<!-- Mobile Menu Dropdown Panel - Full-height purple gradient overlay -->
<div id="mobile-menu" class="hidden lg:hidden fixed inset-0 bg-gradient-to-br from-purple-800 to-purple-900 shadow-2xl" style="z-index: 9997; overflow-y: auto; overflow-x: hidden;">
    <div class="flex justify-between items-center p-4 border-b border-white/20">
        <h2 class="text-white text-xl font-bold">Menu</h2>
        <button id="mobile-menu-close-btn" class="text-white hover:bg-white/20 rounded-lg p-2 transition">
            <i class="fas fa-times text-2xl"></i>
        </button>
    </div>
    <div id="mobile-menu-items" class="py-3 px-4 space-y-1">
        <!-- Dynamic Items will be loaded here -->
    </div>
    <!-- Language Footer -->
    <div class="mt-auto p-6 border-t border-white/20">
        <div class="flex items-center gap-2 text-white text-sm">
            <i class="fas fa-globe"></i>
            <span>Language: <span id="mobile-menu-lang">EN</span></span>
        </div>
    </div>
</div>

<style>
    /* Responsive Navbar Styles */
    #desktop-menu {
        overflow-x: visible;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }
    #desktop-menu::-webkit-scrollbar {
        display: none;
    }
    #desktop-menu a {
        white-space: nowrap;
        padding: 0.5rem 0.75rem;
        font-size: 0.875rem;
    }
    @media (min-width: 1280px) {
        #desktop-menu a {
            padding: 0.5rem 1rem;
            font-size: 1rem;
            max-width: 300px !important;
            flex-shrink: 0 !important;
            flex-grow: 0 !important;
        }
    }
    @media (min-width: 1536px) {
        #desktop-menu a {
            padding: 0.75rem 1.25rem;
            font-size: 1.125rem;
        }
    }
    /* Mobile menu - NO SCROLLBARS */
    #mobile-menu {
        transition: all 0.3s ease;
        overflow-y: auto;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }
    #mobile-menu::-webkit-scrollbar {
        display: none;
    }
    #mobile-menu-items {
        text-align: left;
    }
    /* Language dropdown - NO SCROLLBARS */
    #lang-dropdown {
        scrollbar-width: none;
        -ms-overflow-style: none;
    }
    #lang-dropdown::-webkit-scrollbar {
        display: none;
    }
    /* About section - NO SCROLLBARS, show full image */
    #about {
        overflow: visible !important;
    }
    #about .bg-white {
        overflow: visible !important;
    }
    #about .space-y-3 {
        overflow: visible !important;
    }
    #about-details {
        overflow: visible !important;
        max-height: none !important;
    }
    /* Translate widget styling */
    .translate-widget .goog-te-gadget-simple,
    .translate-widget-mobile .goog-te-gadget-simple {
        background: transparent !important;
        border: none !important;
        padding: 0 !important;
    }
    .goog-te-combo {
        padding: 8px 12px !important;
        border-radius: 8px !important;
        border: 2px solid #e5e7eb !important;
        width: 100% !important;
        font-size: 14px !important;
    }
    /* Language dropdown proper positioning */
    #lang-dropdown {
        z-index: 9999;
    }
    /* Gallery Responsive Card Sizing - SINGLE ROW ON ALL DEVICES */
    @media (max-width: 640px) {
        .gallery-item {
            width: 200px !important;
            min-width: 200px !important;
            max-width: 200px !important;
            flex-shrink: 0 !important;
            flex-grow: 0 !important;
            display: inline-block !important;
        }
        .gallery-item > div:first-child {
            height: 150px !important;
        }
    }
    @media (min-width: 641px) and (max-width: 1024px) {
        .gallery-item {
            width: 240px !important;
            min-width: 240px !important;
            max-width: 240px !important;
            flex-shrink: 0 !important;
            flex-grow: 0 !important;
            display: inline-block !important;
        }
        .gallery-item > div:first-child {
            height: 180px !important;
        }
    }
    @media (min-width: 1025px) {
        .gallery-item {
            width: 300px !important;
            min-width: 300px !important;
            max-width: 300px !important;
            flex-shrink: 0 !important;
            flex-grow: 0 !important;
            display: inline-block !important;
        }
        .gallery-item > div:first-child {
            height: 225px !important;
        }
    }
    /* Ensure no wrapping on gallery container */
    #gallery-slides-container {
        display: flex !important;
        flex-wrap: nowrap !important;
        overflow-x: hidden !important;
        overflow-y: hidden !important;
        scrollbar-width: none !important;
        -ms-overflow-style: none !important;
    }
    #gallery-slides-container::-webkit-scrollbar {
        display: none !important;
    }
</style>

    <!-- Announcement Bar -->
    <div id="announcement-bar" class="bg-gradient-to-r from-red-500 via-orange-500 to-red-600 text-white overflow-hidden relative" style="display: none; height: 40px; margin: 0; padding: 0;">
        <div class="absolute inset-0 flex items-center overflow-hidden">
            <div id="announcement-content" class="animate-marquee">
                <!-- Announcements will be dynamically loaded -->
            </div>
        </div>
    </div>
        <style>
            #announcement-bar {
                overflow: hidden !important;
            }
            #announcement-content {
                display: inline-flex;
                align-items: center;
                gap: 2rem;
                white-space: nowrap;
                animation: marquee 30s linear infinite;
                min-width: 100%;
                width: max-content;
                will-change: transform;
                padding-right: 2rem;
            }
            #announcement-content > * {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
            }
            @keyframes marquee {
                0% { transform: translateX(100%); }
                100% { transform: translateX(-100%); }
            }
            @media (max-width: 640px) {
                #announcement-content {
                    animation: marquee 25s linear infinite;
                    font-size: 0.9rem;
                    gap: 1.25rem;
                }
            }
            .animate-marquee {
                animation: marquee 30s linear infinite;
            }
            #announcement-bar:hover .animate-marquee {
                animation-play-state: paused;
            }
        </style>
    </style>
    
    <!-- Hero Slider Section - STATIC, Manual Navigation Only -->
    <section class="relative w-full" id="hero-slider" style="margin: 0; padding: 0;">
        <div class="hero-slides-container relative w-full" style="position: relative; width: 100%; background: #1a1a2e;">
            <!-- Slides will be loaded from API -->
        </div>
        <button id="prev-slide" class="absolute left-2 sm:left-4 md:left-6 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white rounded-full p-2 sm:p-3 md:p-4 shadow-lg z-20">
            <i class="fas fa-chevron-left text-purple-700 text-sm sm:text-base md:text-xl"></i>
        </button>
        <button id="next-slide" class="absolute right-2 sm:right-4 md:right-6 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white rounded-full p-2 sm:p-3 md:p-4 shadow-lg z-20">
            <i class="fas fa-chevron-right text-purple-700 text-sm sm:text-base md:text-xl"></i>
        </button>
    </section>
    
    <style>
        /* Hero Slider - Full width, proper height */
        #hero-slider {
            width: 100% !important;
            max-width: 100vw !important;
            overflow: hidden !important;
        }
        
        /* Mobile slider */
        @media (max-width: 640px) {
            #hero-slider, .hero-slides-container {
                height: 40vh !important;
                min-height: 220px !important;
                max-height: 300px !important;
            }
        }
        
        /* Tablet slider */
        @media (min-width: 641px) and (max-width: 1024px) {
            #hero-slider, .hero-slides-container {
                height: 50vh !important;
                min-height: 320px !important;
                max-height: 450px !important;
            }
        }
        
        /* Desktop slider - INCREASED HEIGHT */
        @media (min-width: 1025px) {
            #hero-slider, .hero-slides-container {
                height: 70vh !important;
                min-height: 550px !important;
                max-height: 750px !important;
            }
        }
        
        /* Large desktop slider - INCREASED HEIGHT */
        @media (min-width: 1440px) {
            #hero-slider, .hero-slides-container {
                height: 75vh !important;
                min-height: 650px !important;
                max-height: 850px !important;
            }
        }
        
        /* Slider image styles - cover entire area without distortion */
        .hero-slides-container {
            width: 100% !important;
            position: relative !important;
            overflow: hidden !important;
        }
        .hero-slide {
            width: 100% !important;
            height: 100% !important;
        }
        .hero-slide img, .hero-slide video {
            width: 100% !important;
            height: 100% !important;
            object-fit: cover !important;
            object-position: center !important;
            display: block !important;
        }
    </style>

    <!-- Section 1: Astrological Services -->
    <section id="services" class="py-10 md:py-14 bg-gradient-to-br from-white to-purple-50">
        <div class="container mx-auto px-4 sm:px-6">
            <!-- Section Header -->
            <div class="text-center mb-10">
                <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-800 mb-2 font-serif">
                    Astrological Services
                </h2>
                <p class="text-sm sm:text-base text-gray-600 max-w-2xl mx-auto">
                    Discover ancient wisdom through our comprehensive astrological services
                </p>
                <div class="w-20 h-1 bg-gradient-to-r from-purple-600 to-pink-600 mx-auto mt-4 rounded-full"></div>
            </div>
            
            <!-- Services Grid -->
            <div id="astrological-services-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 sm:gap-6 max-w-6xl mx-auto">
                <!-- Services will be dynamically loaded -->
            </div>
        </div>
    </section>

     <!-- Gallery Section - SINGLE HORIZONTAL ROW ON ALL DEVICES -->
    <section id="gallery" class="py-10 md:py-14 bg-gradient-to-r from-purple-100 to-pink-100" style="overflow: hidden;">
        <div class="container mx-auto px-4" style="overflow: hidden;">
            <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-center mb-2 font-serif text-purple-800">Our Gallery</h2>
            <p class="text-center text-gray-600 mb-8 text-sm sm:text-base">Glimpses of cosmic connections</p>
            <div class="relative" style="overflow: visible;">
                <!-- Navigation Arrows - Aligned to card height -->
                <button id="gallery-prev" class="absolute top-1/2 -translate-y-1/2 z-10 bg-white text-purple-800 rounded-full p-3 shadow-lg hover:bg-purple-50" style="left: -1.25rem;">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                </button>
                <button id="gallery-next" class="absolute top-1/2 -translate-y-1/2 z-10 bg-white text-purple-800 rounded-full p-3 shadow-lg hover:bg-purple-50" style="right: -1.25rem;">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
                
                <!-- Horizontal Slider Container - NO SCROLLBARS, single row always -->
                <div style="overflow: hidden; padding: 0 1.25rem;">
                    <div id="gallery-slides-container" style="display: flex !important; flex-wrap: nowrap !important; gap: 1rem; overflow: hidden;">
                        <!-- Gallery slides will be loaded from API -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 2: Pooja & Ritual Services -->
    <section id="pooja" class="py-10 md:py-14 bg-gradient-to-br from-amber-50 via-orange-50 to-red-50">
        <div class="container mx-auto px-4">
            <!-- Section Header -->
            <div class="text-center mb-10">
                <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-800 mb-2 font-serif">
                    Pooja & Ritual Services
                </h2>
                <p class="text-sm sm:text-base text-gray-600 max-w-2xl mx-auto">
                    Experience divine blessings through traditional poojas performed with devotion
                </p>
                <div class="w-20 h-1 bg-gradient-to-r from-amber-500 to-red-500 mx-auto mt-4 rounded-full"></div>
            </div>
            
            <!-- Pooja Grid -->
            <div id="pooja-services-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 sm:gap-6 max-w-6xl mx-auto">
                <!-- Poojas will be dynamically loaded -->
            </div>
        </div>
    </section>

    <!-- Section 3: Expert Solutions -->
    <section id="expert-solutions" class="py-10 md:py-14 bg-white">
        <div class="container mx-auto px-4">
            <!-- Section Header -->
            <div class="text-center mb-10">
                <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-800 mb-2 font-serif">
                    Expert Solutions
                </h2>
                <p class="text-sm sm:text-base text-gray-600 max-w-2xl mx-auto">
                    Personalized guidance for life's most challenging situations
                </p>
                <div class="w-20 h-1 bg-gradient-to-r from-purple-600 to-pink-600 mx-auto mt-4 rounded-full"></div>
            </div>
            
            <!-- Solutions Cards -->
            <div id="expert-solutions-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto">
                <!-- Solutions will be dynamically loaded -->
            </div>
        </div>
    </section>

    <!-- Client Reviews Section -->
    <section id="reviews" class="py-10 md:py-14 bg-gradient-to-br from-white to-purple-50" style="overflow: hidden;">
        <div class="container mx-auto px-4">
            <div class="text-center mb-8">
                <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-800 mb-2 font-serif">Client Reviews</h2>
                <p class="text-sm sm:text-base text-gray-600 max-w-2xl mx-auto">What our clients say about us</p>
            </div>

            <!-- Continuous single-row marquee (JS-driven) -->
            <div class="relative" style="overflow: hidden;">
                <div id="reviews-carousel" class="no-scrollbar" style="display: flex; flex-wrap: nowrap; align-items: stretch; gap: 16px; will-change: transform;">
                    <!-- Review cards injected by JS -->
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-10 md:py-14 bg-gradient-to-br from-purple-50 via-pink-50 to-purple-50" style="overflow: visible;">
        </style>
        <!-- Hide scrollbars for About Our Astrologer section -->
        <style>
        #about, #about * {
            overflow: visible !important;
            scrollbar-width: none !important;
        }
        #about::-webkit-scrollbar, #about *::-webkit-scrollbar {
            display: none !important;
        }
        </style>
        <div class="container mx-auto px-4">
            <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-center mb-6 font-serif text-purple-800">About Our Astrologer</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12 items-center max-w-6xl mx-auto">
                <div class="order-2 md:order-1 slide-in-left">
                    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-xl">
                        <h3 id="about-title" class="text-xl md:text-2xl font-bold mb-3 md:mb-4 text-purple-800">Loading...</h3>
                        <p id="about-description" class="text-sm md:text-base text-gray-700 leading-relaxed mb-4 md:mb-6">Loading...</p>
                        <div id="about-details" class="space-y-3">
                            <!-- Details will be loaded from API -->
                        </div>
                    </div>
                </div>
                <div class="order-1 md:order-2 slide-in-right">
                    <div class="relative about-visual">
                        <div class="absolute inset-0 bg-gradient-to-br from-purple-400 to-pink-400 rounded-2xl md:rounded-3xl transform rotate-3"></div>
                        <div class="relative rounded-2xl md:rounded-3xl shadow-2xl overflow-hidden image-zoom" style="height: auto; max-height: none;">
                            <img id="about-image" 
                                 src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='600' height='400'%3E%3Crect fill='%23e5e7eb' width='600' height='400'/%3E%3C/svg%3E" 
                                 alt="Astrologer" 
                                 class="w-full h-auto object-cover"
                                 style="max-height: 600px; height: auto;"
                                 loading="lazy">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Form Section -->
    <section id="contact" class="py-10 md:py-14 bg-gradient-to-br from-white to-purple-50">
        <div class="container mx-auto px-4 sm:px-6">
            <div class="max-w-3xl mx-auto">
                <div class="text-center mb-6">
                    <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-purple-800 font-serif">Contact Us</h2>
                    <p class="text-gray-600 text-sm sm:text-base mt-2">Get in touch with us for consultation</p>
                    
                    <!-- Quick Action Buttons -->
                    <div class="flex flex-wrap justify-center gap-2 sm:gap-3 mt-4">
                        <a href="tel:+919876543210" id="quick-call-btn" class="inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-full font-semibold shadow-lg text-sm">
                            <i class="fas fa-phone-alt"></i>
                            <span>Call Now</span>
                        </a>
                        <a href="https://maps.app.goo.gl/m9xKD8ff5ycmDdc99" target="_blank" class="inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full font-semibold shadow-lg text-sm">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Location</span>
                        </a>
                        <a href="https://wa.me/919876543210" id="quick-whatsapp-btn" target="_blank" class="inline-flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-full font-semibold shadow-lg text-sm">
                            <i class="fab fa-whatsapp"></i>
                            <span>WhatsApp</span>
                        </a>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-5 sm:p-6 md:p-8">
                    <form id="contact-form-home" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="contact-name" class="block text-gray-700 font-semibold mb-1 text-sm">Name *</label>
                                <input type="text" id="contact-name" name="name" required 
                                       class="w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-sm">
                            </div>
                            <div>
                                <label for="contact-phone" class="block text-gray-700 font-semibold mb-1 text-sm">Phone *</label>
                                <input type="tel" id="contact-phone" name="phone" required 
                                       class="w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-sm">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="contact-email" class="block text-gray-700 font-semibold mb-1 text-sm">Email</label>
                                <input type="email" id="contact-email" name="email" 
                                       class="w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-sm">
                            </div>
                            <div>
                                <label for="contact-topic" class="block text-gray-700 font-semibold mb-1 text-sm">Topic</label>
                                <select id="contact-topic" name="topic" 
                                        class="w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-sm">
                                    <option value="">Select a topic</option>
                                    <option value="Horoscope Reading">Horoscope Reading</option>
                                    <option value="Kundali Matching">Kundali Matching</option>
                                    <option value="Pooja Services">Pooja Services</option>
                                    <option value="Career Consultation">Career Consultation</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label for="contact-message" class="block text-gray-700 font-semibold mb-1 text-sm">Message *</label>
                            <textarea id="contact-message" name="message" rows="4" required 
                                      class="w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-sm resize-none"></textarea>
                        </div>
                        
                        <div class="text-center pt-2">
                            <button type="submit" 
                                    class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-full font-bold text-base hover:shadow-xl">
                                <i class="fas fa-paper-plane mr-2"></i>Send Message
                            </button>
                        </div>
                        
                        <div id="contact-form-message" class="hidden mt-3"></div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="py-10 md:py-14 bg-gradient-to-r from-purple-100 to-pink-100">
        <div class="container mx-auto px-4 max-w-4xl">
            <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-center mb-2 font-serif text-purple-800">Frequently Asked Questions</h2>
            <p class="text-center text-gray-600 mb-6 text-sm sm:text-base">Your cosmic queries answered</p>
            
            <!-- Language Toggle -->
            <div class="flex justify-center mb-6">
                <div class="bg-white rounded-full p-1 shadow-md">
                    <button onclick="showFAQLang('english')" id="faq-en-btn" class="px-4 sm:px-6 py-1.5 sm:py-2 rounded-full font-semibold text-sm sm:text-base bg-purple-600 text-white">
                        English
                    </button>
                    <button onclick="showFAQLang('kannada')" id="faq-kn-btn" class="px-4 sm:px-6 py-1.5 sm:py-2 rounded-full font-semibold text-sm sm:text-base text-gray-700 hover:bg-gray-100">
                        ಕನ್ನಡ
                    </button>
                </div>
            </div>
            
            <!-- English FAQs -->
            <div id="faq-english" class="space-y-3">
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-3 sm:p-4 font-bold text-purple-800 flex justify-between items-center text-sm sm:text-base">
                        What is astrology and how does it work?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        Astrology is an ancient science that studies the influence of celestial bodies on human affairs and terrestrial events. It analyzes planetary positions at your birth time to provide insights into your personality, relationships, career, and life path.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        How accurate are astrological predictions?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        Accuracy depends on the astrologer's expertise and the precision of birth data. Our experienced practitioners provide highly accurate readings based on Vedic astrology principles with years of study and practice.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        What information do I need for a kundali reading?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        You need your exact date of birth, time of birth (as accurate as possible), and place of birth for an accurate kundali analysis. If birth time is unknown, we can work with date and location for a basic reading.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        How long does a consultation typically take?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        Most consultations last 45-60 minutes, allowing time for detailed analysis, answering your specific questions, and providing remedies or guidance.
                    </div>
                </div>
            </div>
            
            <!-- Kannada FAQs -->
            <div id="faq-kannada" class="space-y-4 hidden">
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        ಜ್ಯೋತಿಷ್ಯ ಎಂದರೇನು ಮತ್ತು ಅದು ಹೇಗೆ ಕೆಲಸ ಮಾಡುತ್ತದೆ?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        ಜ್ಯೋತಿಷ್ಯವು ಮಾನವ ವ್ಯವಹಾರಗಳು ಮತ್ತು ಭೂಮಿಯ ಘಟನೆಗಳ ಮೇಲೆ ಆಕಾಶ ಕಾಯಗಳ ಪ್ರಭಾವವನ್ನು ಅಧ್ಯಯನ ಮಾಡುವ ಪ್ರಾಚೀನ ವಿಜ್ಞಾನವಾಗಿದೆ. ನಿಮ್ಮ ವ್ಯಕ್ತಿತ್ವ, ಸಂಬಂಧಗಳು, ವೃತ್ತಿ ಮತ್ತು ಜೀವನ ಮಾರ್ಗದ ಬಗ್ಗೆ ಒಳನೋಟಗಳನ್ನು ನೀಡಲು ನಿಮ್ಮ ಜನನ ಸಮಯದಲ್ಲಿ ಗ್ರಹಗಳ ಸ್ಥಾನಗಳನ್ನು ವಿಶ್ಲೇಷಿಸುತ್ತದೆ.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        ಜ್ಯೋತಿಷ್ಯ ಭವಿಷ್ಯ ಎಷ್ಟು ನಿಖರವಾಗಿದೆ?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        ನಿಖರತೆಯು ಜ್ಯೋತಿಷಿಯ ಪರಿಣತಿ ಮತ್ತು ಜನನ ದತ್ತಾಂಶದ ನಿಖರತೆಯ ಮೇಲೆ ಅವಲಂಬಿತವಾಗಿದೆ. ನಮ್ಮ ಅನುಭವಿ ವೃತ್ತಿಪರರು ವೇದ ಜ್ಯೋತಿಷ್ಯ ತತ್ವಗಳ ಆಧಾರದ ಮೇಲೆ ಅತ್ಯಂತ ನಿಖರವಾದ ವಾಚನಗಳನ್ನು ಒದಗಿಸುತ್ತಾರೆ.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        ಕುಂಡಲಿ ಓದುವಿಕೆಗೆ ನನಗೆ ಯಾವ ಮಾಹಿತಿ ಬೇಕು?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        ನಿಖರವಾದ ಕುಂಡಿ ವಿಶ್ಲೇಷಣೆಗಾಗಿ ನಿಮ್ಮ ನಿಖರ ಜನ್ಮ ದಿನಾಂಕ, ಜನನ ಸಮಯ (ಸಾಧ್ಯವಾದಷ್ಟು ನಿಖರ), ಮತ್ತು ಜನನ ಸ್ಥಳ ಬೇಕು. ಜನನ ಸಮಯ ತಿಳಿದಿಲ್ಲದಿದ್ದರೆ, ಮೂಲಭೂತ ಓದುವಿಕೆಗಾಗಿ ನಾವು ದಿನಾಂಕ ಮತ್ತು ಸ್ಥಳದೊಂದಿಗೆ ಕೆಲಸ ಮಾಡಬಹುದು.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        ಸಮಾಲೋಚನೆ ಸಾಮಾನ್ಯವಾಗಿ ಎಷ್ಟು ಸಮಯ ತೆಗೆದುಕೊಳ್ಳುತ್ತದೆ?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        ಹೆಚ್ಚಿನ ಸಮಾಲೋಚನೆಗಳು 45-60 ನಿಮಿಷಗಳ ಕಾಲ ನಡೆಯುತ್ತವೆ, ವಿವರವಾದ ವಿಶ್ಲೇಷಣೆ, ನಿಮ್ಮ ನಿರ್ದಿಷ್ಟ ಪ್ರಶ್ನೆಗಳಿಗೆ ಉತ್ತರಿಸಲು, ಮತ್ತು ಪರಿಹಾರಗಳು ಅಥವಾ ಮಾರ್ಗದರ್ಶನವನ್ನು ನೀಡಲು ಸಮಯ ನೀಡುತ್ತದೆ.
                    </div>
                </div>
            </div>
        </div>
    </section>
    
<script>

    
        // Page initialization - Load all data
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded successfully');
            console.log('Backend ready');
            
            // Load navbar first
            loadNavbar();
            loadAnnouncementBar();
            
            // Load all sections
            loadHeroSlides();
            loadGallerySlides();
            loadAboutSection();
            loadAstrologicalServices();
            loadPoojaServices();
            loadExpertSolutions();
            loadContactInfo();
            
            // Smooth scrolling for navigation links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                    if (href === '#' || href === '') return;
                    
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        // Close mobile menu if open
                        const mobileMenu = document.getElementById('mobile-menu');
                        if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                            mobileMenu.classList.add('hidden');
                        }
                        
                        // Smooth scroll to section
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
            
            // Highlight active nav link on scroll
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link, .mobile-nav-link');
            
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    if (scrollY >= (sectionTop - 100)) {
                        current = section.getAttribute('id');
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('text-yellow-300');
                    if (link.getAttribute('href') === '#' + current) {
                        link.classList.add('text-yellow-300');
                    }
                });
            });
        });

    
    
        // Header, Navbar, Footer, and related functions (toggleMobileLangDropdown, loadAnnouncementBar) are loaded from base.html
        // Declare globals early to avoid ReferenceError/TDZ issues
        let currentSlide = 0;
        let heroSlides = [];
        let totalSlides = 0;
        let globalBusinessInfo = null;
        // Mobile Menu Toggle is now in base.html - removed duplicate code
        // Wait for base.html elements to be available
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', function() {
                const mobileMenu = document.getElementById('mobile-menu');
                if (mobileMenu) {
                    mobileMenu.classList.toggle('hidden');
                }
            });
        }

        // FAQ Language Toggle
        function showFAQLang(lang) {
            const enFAQ = document.getElementById('faq-english');
            const knFAQ = document.getElementById('faq-kannada');
            const enBtn = document.getElementById('faq-en-btn');
            const knBtn = document.getElementById('faq-kn-btn');
            
            if (lang === 'english') {
                enFAQ.classList.remove('hidden');
                knFAQ.classList.add('hidden');
                enBtn.classList.add('bg-purple-600', 'text-white');
                enBtn.classList.remove('text-gray-700', 'hover:bg-gray-100');
                knBtn.classList.remove('bg-purple-600', 'text-white');
                knBtn.classList.add('text-gray-700', 'hover:bg-gray-100');
            } else {
                knFAQ.classList.remove('hidden');
                enFAQ.classList.add('hidden');
                knBtn.classList.add('bg-purple-600', 'text-white');
                knBtn.classList.remove('text-gray-700', 'hover:bg-gray-100');
                enBtn.classList.remove('bg-purple-600', 'text-white');
                enBtn.classList.add('text-gray-700', 'hover:bg-gray-100');
            }
        }
        
        // Make function globally available
        window.showFAQLang = showFAQLang;
        
        // FAQ Accordion
        document.querySelectorAll('.faq-question').forEach(button => {
            button.addEventListener('click', function() {
                const answer = this.nextElementSibling;
                const icon = this.querySelector('i');
                answer.classList.toggle('hidden');
                icon.classList.toggle('fa-chevron-down');
                icon.classList.toggle('fa-chevron-up');
            });
        });




        // ========================================
        // NAVBAR & ANNOUNCEMENT BAR FUNCTIONALITY
        // ========================================
        
        // Load navbar settings - ONLY from navbar_settings table
        async function loadNavbar() {
            try {
                // Load ONLY from navbar_settings table
                const settingsResponse = await fetch('/api/navbar-settings');
                if (settingsResponse.ok) {
                    const settings = await settingsResponse.json();
                    console.log('Loading navbar from navbar_settings:', settings);
                    
                    // Enhanced logo loading with responsive sizing
                    if (settings.logo_url) {
                        console.log('Loading logo from:', settings.logo_url);
                        const logoSrc = convertToLocalUrl(settings.logo_url) || settings.logo_url;
                        
                        const logoEl = document.getElementById('navbar-logo');
                        if (logoEl) {
                            logoEl.src = logoSrc;
                            logoEl.alt = settings.name || 'Astrology Center';
                            logoEl.className = 'h-20 w-auto sm:h-24 md:h-28 lg:h-32 xl:h-36 object-contain transition-transform duration-300 hover:scale-105';
                            logoEl.style.display = 'block';
                            logoEl.style.maxWidth = '250px';
                            logoEl.style.background = 'transparent';
                        }
                        
                        // Also update mobile logo if exists
                        const mobileLogoEl = document.getElementById('mobile-navbar-logo');
                        if (mobileLogoEl) {
                            mobileLogoEl.src = logoSrc;
                            mobileLogoEl.alt = settings.name || 'Astrology Center';
                            mobileLogoEl.className = 'h-16 w-auto object-contain';
                        }
                    }
                    
                    // Update website name and make it responsive
                    if (settings.name) {
                        const nameEl = document.getElementById('website-name');
                        if (nameEl) {
                            nameEl.textContent = settings.name;
                            nameEl.classList.add('animate-fade-in');
                        }
                    }
                    
                    // Update website subtitle and make it responsive - FIX for Website Subtitle 1 (Main)
                    if (settings.subtitle1) {
                        const subtitleEl = document.getElementById('website-subtitle');
                        if (subtitleEl) {
                            subtitleEl.textContent = settings.subtitle1;
                            subtitleEl.classList.add('animate-fade-in-delay');
                            subtitleEl.classList.remove('hidden');
                        }
                    }
                    
                    // Update additional subtitles if they exist
                    if (settings.subtitle2) {
                        const subtitle2El = document.getElementById('website-subtitle2');
                        if (subtitle2El) {
                            subtitle2El.textContent = settings.subtitle2;
                            subtitle2El.classList.remove('hidden');
                        }
                    }
                    
                    if (settings.subtitle3) {
                        const subtitle3El = document.getElementById('website-subtitle3');
                        if (subtitle3El) {
                            subtitle3El.textContent = settings.subtitle3;
                            subtitle3El.classList.remove('hidden');
                        }
                    }
                    
                    // Apply navbar colors and layout from navbar_settings
                    if (settings.primary_color && settings.secondary_color) {
                        updateNavbarColors(settings.primary_color, settings.secondary_color, settings.navbar_style);
                    }
                    
                    // Apply navbar layout settings
                    applyNavbarLayout(settings);
                }}
            catch (error) {
                console.error('Error loading navbar settings:', error);
            }
        }
             // Apply navbar layout settings from navbar_settings
        function applyNavbarLayout(settings) {
            const navbar = document.getElementById('main-navbar');
            const logoEl = document.getElementById('navbar-logo');
            
            // Apply navbar height
            if (settings.navbar_height) {
                const heights = {
                    'small': 'h-14',
                    'medium': 'h-16 md:h-20',
                    'large': 'h-20 md:h-24'
                };
                const currentClasses = navbar.className;
                const newClasses = currentClasses.replace(/h-\d+(?:\s+md:h-\d+)?/g, heights[settings.navbar_height] || 'h-16 md:h-20');
                navbar.className = newClasses;
            }
            
            // Apply logo position
            if (settings.logo_position === 'center') {
                logoEl.parentElement.classList.add('mx-auto');
            } else if (settings.logo_position === 'right') {
                logoEl.parentElement.classList.add('ml-auto');
            }
        }
        
        // Update navbar colors from navbar_settings
        function updateNavbarColors(primaryColor, secondaryColor, navbarStyle) {
            const navbar = document.getElementById('main-navbar');
            
            if (navbarStyle === 'solid') {
                navbar.style.background = primaryColor;
            } else if (navbarStyle === 'transparent') {
                navbar.style.background = 'rgba(255, 255, 255, 0.1)';
                navbar.style.backdropFilter = 'blur(10px)';
            } else {
                // Default gradient
                navbar.style.background = `linear-gradient(to right, ${primaryColor}, ${secondaryColor})`;
            }
        }
        
        // ========================================
        // NAVBAR FUNCTIONALITY
        // ========================================
        
        // Load Navbar
        async function loadNavbar() {
            try {
                // Check session storage first for cached data
                let navbarSettings = null;
                const cachedNavbar = sessionStorage.getItem('navbarSettings');
                
                if (cachedNavbar) {
                    navbarSettings = JSON.parse(cachedNavbar);
                    console.log('✅ Loaded navbar from session storage (cached)');
                } else {
                    // Load navbar settings from database
                    const navbarResponse = await fetch('/api/navbar-settings');
                    if (navbarResponse.ok) {
                        navbarSettings = await navbarResponse.json();
                        // Save to session storage for faster subsequent loads
                        sessionStorage.setItem('navbarSettings', JSON.stringify(navbarSettings));
                        console.log('✅ Navbar settings loaded from database and cached');
                    }
                }
                
                if (navbarSettings) {
                    // Update website name from database (CRITICAL - MUST WORK)
                    const nameEl = document.getElementById('website-name');
                    if (nameEl && navbarSettings.name) {
                        nameEl.textContent = navbarSettings.name;
                        console.log('✅ Website name updated:', navbarSettings.name);
                    }
                    
                    // Update subtitle from database (CRITICAL - MUST WORK)
                    const subtitleEl = document.getElementById('website-subtitle');
                    if (subtitleEl && navbarSettings.subtitle1) {
                        subtitleEl.textContent = navbarSettings.subtitle1;
                        console.log('✅ Website subtitle updated:', navbarSettings.subtitle1);
                    }
                    
                    // Update logo - ALWAYS use local /uploads/ URL for faster loading
                    const logoEl = document.getElementById('navbar-logo');
                    if (logoEl && navbarSettings.logo_url) {
                        // Force local uploads folder path
                        let logoUrl;
                        if (navbarSettings.logo_url.startsWith('/uploads/')) {
                            logoUrl = navbarSettings.logo_url;
                        } else if (navbarSettings.logo_url.includes('supabase')) {
                            const filename = navbarSettings.logo_url.split('/').pop().split('?')[0];
                            logoUrl = `/uploads/${filename}`;
                        } else {
                            const filename = navbarSettings.logo_url.split('/').pop();
                            logoUrl = `/uploads/${filename}`;
                        }
                        
                        console.log('🖼️ Loading logo from uploads folder:', logoUrl);
                        logoEl.src = logoUrl;
                        logoEl.style.display = 'block';
                        logoEl.style.visibility = 'visible';
                        logoEl.style.opacity = '1';
                        logoEl.loading = 'eager'; // Load immediately
                        
                        logoEl.onerror = function() {
                            console.error('❌ Logo failed to load from uploads:', logoUrl);
                            console.log('Trying original URL:', navbarSettings.logo_url);
                            logoEl.src = navbarSettings.logo_url;
                        };
                        logoEl.onload = function() {
                            console.log('✅ Logo loaded successfully from uploads folder');
                        };
                    }
                    
                }
                
                // Load menu items - with fallback to manual menu
                try {
                    const menuResponse = await fetch('/api/menu-items');
                    if (menuResponse.ok) {
                        const menuItems = await menuResponse.json();
                        if (menuItems && menuItems.length > 0) {
                            renderMenuItems(menuItems);
                        } else {
                            renderDefaultMenuItems();
                        }
                    } else {
                        renderDefaultMenuItems();
                    }
                } catch (error) {
                    console.warn('Failed to load menu from database, using default menu');
                    renderDefaultMenuItems();
                }
            } catch (error) {
                console.error('Error loading navbar:', error);
            }
        }
        
        // Default menu items as fallback
        function renderDefaultMenuItems() {
            const defaultItems = [
                { title: 'Home', url: '#hero-slider', target: '_self' },
                { title: 'Services', url: '#services', target: '_self' },
                { title: 'Gallery', url: '#gallery', target: '_self' },
                { title: 'Pooja', url: '#pooja', target: '_self' },
                { title: 'Solutions', url: '#solutions', target: '_self' },
                { title: 'About', url: '#about', target: '_self' },
                { title: 'Reviews', url: '#reviews', target: '_self' },
                { title: 'FAQ', url: '#faq', target: '_self' },
                { title: 'Contact', url: '/contact', target: '_self' }
            ];
            renderMenuItems(defaultItems);
        }

        // Keep menu items ordered the same as admin drag/drop and remove duplicates
        function normalizeMenuItems(items = []) {
            const seen = new Set();
            const sorted = [...items].sort((a, b) => (a.display_order ?? 999) - (b.display_order ?? 999));
            const cleaned = [];
            sorted.forEach(item => {
                if (!item) return;
                const key = `${item.title || ''}-${item.url || ''}`;
                if (seen.has(key)) return;
                seen.add(key);
                cleaned.push(item);
            });
            return cleaned;
        }

        function renderMenuItems(items) {
            console.log('🍔 Rendering menu items:', items.length);
            const desktopMenu = document.getElementById('desktop-menu');
            const mobileMenuItems = document.getElementById('mobile-menu-items');
            
            if (!desktopMenu || !mobileMenuItems) {
                console.error('❌ Menu containers not found');
                return;
            }
            
            desktopMenu.innerHTML = '';
            mobileMenuItems.innerHTML = '';
            console.log('✅ Menu containers cleared');
            
            normalizeMenuItems(items).forEach(item => {
                // Fix: Convert /contact to #contact automatically
                let itemUrl = item.url;
                if (itemUrl === '/contact' || itemUrl === '/contact.html') {
                    itemUrl = '#contact';
                }
                
                // Desktop menu item
                const desktopLink = document.createElement('a');
                desktopLink.href = itemUrl;
                desktopLink.target = item.target || '_self';
                desktopLink.className = 'px-4 lg:px-6 py-2 lg:py-3 text-white hover:bg-white hover:bg-opacity-20 rounded-lg transition-all duration-300 font-semibold text-sm md:text-base lg:text-lg relative group whitespace-nowrap';
                desktopLink.innerHTML = `
                    ${item.title}
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-white group-hover:w-full transition-all duration-300"></span>
                `;
                desktopLink.addEventListener('click', function(e) {
                    if (itemUrl.startsWith('#')) {
                        e.preventDefault();
                        const target = document.querySelector(itemUrl);
                        if (target) {
                            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }
                });
                desktopMenu.appendChild(desktopLink);
                
                // Mobile menu item
                const mobileLink = document.createElement('a');
                mobileLink.href = itemUrl;
                mobileLink.target = item.target || '_self';
                mobileLink.className = 'block px-4 py-3 text-white hover:bg-purple-700 rounded-lg transition-all duration-300 mobile-nav-link text-base font-semibold';
                mobileLink.textContent = item.title;
                mobileLink.addEventListener('click', function(e) {
                    // Always close menu when selecting an item
                    const mobileMenuEl = document.getElementById('mobile-menu');
                    if (mobileMenuEl) mobileMenuEl.classList.add('hidden');
                    const menuIcon = document.querySelector('#mobile-menu-btn i');
                    if (menuIcon) {
                        menuIcon.classList.remove('fa-times');
                        menuIcon.classList.add('fa-bars');
                    }

                    if (itemUrl.startsWith('#')) {
                        e.preventDefault();
                        const target = document.querySelector(itemUrl);
                        if (target) {
                            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }
                });
                mobileMenuItems.appendChild(mobileLink);
            });
        }
        
        // Mobile Menu Toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuCloseBtn = document.getElementById('mobile-menu-close-btn');

            const closeMobileMenu = () => {
                if (!mobileMenu || !mobileMenuBtn) return;
                if (mobileMenu.classList.contains('hidden')) return;
                mobileMenu.classList.add('hidden');
                const icon = mobileMenuBtn.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            };
            
            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const icon = mobileMenuBtn.querySelector('i');
                    if (mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.remove('hidden');
                        if (icon) {
                            icon.classList.remove('fa-bars');
                            icon.classList.add('fa-times');
                        }
                    } else {
                        closeMobileMenu();
                    }
                });

                // Close on outside click
                document.addEventListener('click', function(e) {
                    if (mobileMenu.classList.contains('hidden')) return;
                    if (!mobileMenuBtn.contains(e.target) && !mobileMenu.contains(e.target)) closeMobileMenu();
                });

                // Close on Escape key
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape' && !mobileMenu.classList.contains('hidden')) closeMobileMenu();
                });

                // Close menu when page scrolls (do not block scrolling)
                window.addEventListener('scroll', closeMobileMenu, { passive: true });

                // Close button click
                if (mobileMenuCloseBtn) {
                    mobileMenuCloseBtn.addEventListener('click', function() {
                        closeMobileMenu();
                    });
                }
            }
        });
            
        // ANNOUNCEMENT BAR FUNCTIONALITY
        // ========================================
        async function loadAnnouncementBar() {
            try {
                const response = await fetch('/api/content/announcements?active=true');
                if (response.ok) {
                    const announcements = await response.json();
                    
                    if (announcements && announcements.length > 0) {
                        const announcementBar = document.getElementById('announcement-bar');
                        const announcementContent = document.getElementById('announcement-content');
                        
                        if (announcementBar && announcementContent) {
                            // Create announcement items
                            announcementContent.innerHTML = announcements.map(announcement => 
                                `<span class="text-lg sm:text-xl font-semibold">🔔 ${announcement.text || announcement.message}</span>`
                            ).join('');
                            
                            // Show announcement bar
                            announcementBar.style.display = 'block';
                        }
                    }
                }
            } catch (error) {
                console.error('Error loading announcement bar:', error);
            }
        }
        // ========================================
        
        // ========================================
        // NEW SECTIONS: Services, Pooja, Solutions
        // ========================================
        
        // Load Astrological Services
        async function loadAstrologicalServices() {
            try {
                const response = await fetch('/api/astrological-services');
                if (response.ok) {
                    const services = await response.json();
                    renderAstrologicalServices(services);
                }
            } catch (error) {
                console.error('Error loading astrological services:', error);
            }
        }
        
        // Generate random watercolor backgrounds like in the image
        function getRandomWatercolorBackground() {
            const watercolors = [
                'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
                'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
                'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)',
                'linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)',
                'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)',
                'linear-gradient(135deg, #ff8177 0%, #ff867a 0%, #ff8c7f 21%, #f99185 52%, #cf556c 78%, #b12a5b 100%)',
                'linear-gradient(135deg, #3b41c5 0%, #a981bb 49%, #ffc649 100%)'
            ];
            return watercolors[Math.floor(Math.random() * watercolors.length)];
        }
        
        function renderAstrologicalServices(services) {
            const grid = document.getElementById('astrological-services-grid');
            if (!grid) {
                console.error('Astrological services grid not found!');
                return;
            }
            
            console.log('Rendering astrological services:', services);
            grid.innerHTML = '';
            
            if (!services || services.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500 text-lg">No services available at the moment</div>';
                return;
            }
            
            services.forEach((service, index) => {
                const serviceItem = document.createElement('div');
                serviceItem.className = 'text-center cursor-pointer group transition-all duration-300 hover:scale-105';
                serviceItem.style.animationDelay = `${index * 0.1}s`;
                
                // Use global helper to convert URLs
                let serviceImageUrl = convertToLocalUrl(service.icon_url || service.image_url);
                console.log('Service image URL:', service.title, serviceImageUrl);
                
                serviceItem.innerHTML = `
                    <div class="service-item">
                        <!-- Service Image - Direct Display (No Card, No Background) -->
                        <div class="mb-4">
                            ${serviceImageUrl ? 
                                `<img src="${serviceImageUrl}" alt="${service.title}" 
                                     class="w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 mx-auto object-contain transition-transform duration-300 group-hover:scale-110" 
                                     style="background: transparent !important;">` :
                                `<div class="w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 mx-auto flex items-center justify-center">
                                    <i class="fas fa-star text-purple-600 text-5xl"></i>
                                </div>`
                            }
                        </div>
                        
                        <!-- Service Title Below Image -->
                        <h3 class="text-sm sm:text-base md:text-lg font-semibold text-gray-800 group-hover:text-purple-600 transition-colors duration-300 px-2">
                            ${service.title}
                        </h3>
                    </div>
                `;
                
                grid.appendChild(serviceItem);
            });
            
            console.log(`✅ Successfully rendered ${services.length} astrological services (simple display)`);
        }
        
        // Load Pooja Services with session storage
        async function loadPoojaServices() {
            try {
                // Check session storage first
                const cachedPooja = sessionStorage.getItem('poojaServices');
                if (cachedPooja) {
                    const poojas = JSON.parse(cachedPooja);
                    console.log('✅ Loaded pooja services from session storage (cached):', poojas.length);
                    renderPoojaServices(poojas);
                    return;
                }
                
                const response = await fetch('/api/content/pooja-services');
                if (response.ok) {
                    const poojas = await response.json();
                    // Save to session storage
                    sessionStorage.setItem('poojaServices', JSON.stringify(poojas));
                    console.log('✅ Pooja services loaded from database and cached:', poojas.length);
                    renderPoojaServices(poojas);
                }
            } catch (error) {
                console.error('Error loading pooja services:', error);
            }
        }
        
        function renderPoojaServices(poojas) {
            const grid = document.getElementById('pooja-services-grid');
            grid.innerHTML = '';
            
            poojas.forEach((pooja, index) => {
                const card = document.createElement('div');
                card.className = 'text-center scale-in cursor-pointer';
                card.style.animationDelay = `${index * 0.1}s`;
                card.style.opacity = '0';
                
                // Use global helper to convert URLs
                let poojaImageUrl = convertToLocalUrl(pooja.image_url);
                console.log('Pooja image URL:', pooja.title, poojaImageUrl);
                
                card.innerHTML = `
                    <div class="pooja-circle image-zoom w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 lg:w-40 lg:h-40 mx-auto mb-3 sm:mb-4 rounded-full overflow-hidden border-2 sm:border-4 border-white shadow-xl hover:shadow-2xl transition-shadow duration-300">
                        ${poojaImageUrl ? 
                            `<img src="${poojaImageUrl}" alt="${pooja.title}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\'w-full h-full bg-gradient-to-br from-amber-400 to-red-500 flex items-center justify-center\\'><i class=\\'fas fa-om text-white text-2xl sm:text-3xl md:text-4xl\\'></i></div>'">` :
                            `<div class="w-full h-full bg-gradient-to-br from-amber-400 to-red-500 flex items-center justify-center">
                                <i class="fas fa-om text-white text-2xl sm:text-3xl md:text-4xl"></i>
                            </div>`
                        }
                    </div>
                    <h3 class="text-sm sm:text-base md:text-lg font-bold text-gray-800 px-2 transition-colors hover:text-orange-600">${pooja.title}</h3>
                    ${pooja.description ? `<p class="text-xs text-gray-600 mt-1 px-2 line-clamp-2">${pooja.description}</p>` : ''}
                `;
                
                grid.appendChild(card);
                setTimeout(() => card.style.opacity = '1', 50);
            });
        }
        
        // Load Expert Solutions with session storage
        async function loadExpertSolutions() {
            try {
                // Check session storage first
                const cachedSolutions = sessionStorage.getItem('expertSolutions');
                if (cachedSolutions) {
                    const solutions = JSON.parse(cachedSolutions);
                    console.log('✅ Loaded expert solutions from session storage (cached):', solutions.length);
                    renderExpertSolutions(solutions);
                    return;
                }
                
                const response = await fetch('/api/content/expert-solutions');
                if (response.ok) {
                    const solutions = await response.json();
                    // Save to session storage
                    sessionStorage.setItem('expertSolutions', JSON.stringify(solutions));
                    console.log('✅ Expert solutions loaded from database and cached:', solutions.length);
                    renderExpertSolutions(solutions);
                }
            } catch (error) {
                console.error('Error loading expert solutions:', error);
            }
        }
        
        function renderExpertSolutions(solutions) {
            const grid = document.getElementById('expert-solutions-grid');
            if (!grid) {
                console.error('❌ Expert solutions grid not found');
                return;
            }
            if (!Array.isArray(solutions)) {
                console.error('❌ Expert solutions data invalid:', solutions);
                return;
            }

            console.log('🔧 Rendering expert solutions:', solutions.length);
            grid.innerHTML = '';

            solutions.forEach(item => {
                const original = item.image || item.image_url || '';
                const local = original ? convertToLocalUrl(original) : '';
                const title = item.title || 'Solution';
                const desc = item.description || '';

                const card = document.createElement('div');
                card.className = 'bg-white rounded-xl md:rounded-2xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-2xl hover:-translate-y-2';

                card.innerHTML = `
            <div class="relative overflow-hidden" style="padding-top: 75%;">
                ${local ? `<img src="${local}" alt="${title}" class="absolute inset-0 w-full h-full object-cover object-center" 
                           loading="lazy" crossorigin="anonymous"
                           onload="this.style.opacity=1;"
                           onerror="console.error('Expert image failed from uploads:', '${local}'); this.onerror=null; this.src='${original}'; this.onload=null; this.onerror=function(){ this.style.display='none'; const fb=this.nextElementSibling; if(fb) fb.style.display='flex'; };" style="opacity:0; transition: opacity 0.3s;">`
                         : ''}
                <div class="absolute inset-0 bg-gradient-to-br from-purple-500/10 to-pink-500/10 flex items-center justify-center" style="${local ? 'display:none;' : ''}">
                    <i class="fas fa-image text-purple-500 text-3xl"></i>
                </div>
            </div>
            <div class="p-4 md:p-5">
                <h4 class="text-lg md:text-xl font-bold text-purple-900 mb-1">${title}</h4>
                <p class="text-gray-700 text-sm md:text-base line-clamp-3">${desc}</p>
            </div>
        `;
                grid.appendChild(card);
            });
        }
        
        // Scroll Animation Observer
        function initScrollAnimations() {
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);
            
            // Observe all animated elements
            document.querySelectorAll('.fade-in, .slide-in-left, .slide-in-right').forEach(el => {
                observer.observe(el);
            });
        }
        
        // Load all new sections with error handling
        async function initializeServices() {
            try {
                console.log('🔄 Initializing astrological services...');
                await loadAstrologicalServices();
                console.log('✅ Astrological services initialized successfully');
            } catch (error) {
                console.error('❌ Failed to initialize astrological services:', error);
            }
        }
        
        // Lazy load with intersection observer for better performance
        function initLazyLoading() {
            const observerOptions = {
                root: null,
                rootMargin: '150px',
                threshold: 0.1
            };
            
            const sectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const sectionId = entry.target.id;
                        if (sectionId === 'expert-solutions' && !window.expertSolutionsLoaded) {
                            loadExpertSolutions();
                            window.expertSolutionsLoaded = true;
                        } else if (sectionId === 'pooja' && !window.poojaServicesLoaded) {
                            loadPoojaServices();
                            window.poojaServicesLoaded = true;
                        }
                        sectionObserver.unobserve(entry.target);
                    }
                });
            }, observerOptions);
            
            // Observe sections for lazy loading
            const expertSection = document.getElementById('expert-solutions');
            const poojaSection = document.getElementById('pooja');
            if (expertSection) sectionObserver.observe(expertSection);
            if (poojaSection) sectionObserver.observe(poojaSection);
        }
        
        // Initialize scroll animations after a short delay to ensure DOM is ready
        setTimeout(initScrollAnimations, 500);


        // Load Hero Slides from API (globals declared at top of script)

        async function loadHeroSlides() {
            try {
                // Check session storage first
                const cachedSlides = sessionStorage.getItem('heroSlides');
                if (cachedSlides) {
                    heroSlides = JSON.parse(cachedSlides);
                    console.log('✅ Loaded hero slides from session storage (cached):', heroSlides.length, 'slides');
                    renderHeroSlides();
                    if (heroSlides.length > 0) {
                        startHeroSlider();
                    }
                    return;
                }
                
                console.log('Fetching hero slides from API...');
                const response = await fetch(`/api/content/hero-slides?t=${Date.now()}`);
                console.log('Hero slides response status:', response.status);
                if (!response.ok) throw new Error('Failed to load hero slides');
                const data = await response.json();
                console.log('Hero slides data received:', data);
                
                // Handle API response format
                if (Array.isArray(data)) {
                    heroSlides = data
                        .map(slide => ({
                            ...slide,
                            image_local: slide.image ? convertToLocalUrl(slide.image) : ''
                        }))
                        .filter(slide => (slide.video_url && slide.video_url.trim() !== '') || (slide.image_local && slide.image_local.trim() !== ''));
                    // Save to session storage
                    sessionStorage.setItem('heroSlides', JSON.stringify(heroSlides));
                    console.log('✅ Loaded', heroSlides.length, 'hero slides and cached');
                    if (heroSlides.length > 0) {
                        console.log('First hero slide image URL:', heroSlides[0].image_local || heroSlides[0].image);
                        console.log('First hero slide video URL:', heroSlides[0].video_url);
                    }
                } else {
                    console.error('Invalid hero slides data format:', data);
                    heroSlides = [];
                }
                
                renderHeroSlides();
                if (heroSlides.length > 0) {
                    startHeroSlider();
                    console.log('Hero slider started');
                } else {
                    console.warn('No hero slides to display');
                }
            } catch (error) {
                console.error('Error loading hero slides:', error);
                heroSlides = [];
                renderHeroSlides();
            }
        }

        function renderHeroSlides() {
            console.log('renderHeroSlides called with', heroSlides ? heroSlides.length : 0, 'slides');
            const container = document.querySelector('.hero-slides-container');
            if (!container) {
                console.error('Hero slides container not found');
                return;
            }

            container.innerHTML = '';

            if (!Array.isArray(heroSlides) || heroSlides.length === 0) {
                console.warn('No hero slides to render, showing default content');
                container.innerHTML = '<div class="absolute inset-0 bg-gradient-to-r from-purple-900 to-pink-900 flex items-center justify-center"><div class="text-center text-white px-4"><h1 class="text-5xl font-bold mb-4 font-serif">Welcome to Cosmic Astrology</h1><p class="text-xl mb-8">Your journey to cosmic wisdom begins here</p></div></div>';
                return;
            }

            // Preload images for faster display
            const head = document.head || document.getElementsByTagName('head')[0];

            console.log('Starting to render', heroSlides.length, 'slides');
            heroSlides.forEach((slide, index) => {
                const slideDiv = document.createElement('div');
                // No animations or transitions; static slides with explicit display
                slideDiv.className = 'hero-slide absolute inset-0';
                slideDiv.style.display = index === 0 ? 'block' : 'none';
                slideDiv.style.opacity = index === 0 ? '1' : '0';

                // Normalize image URL to local uploads with fallback
                const original = slide.image || slide.image_url || '';
                const local = convertToLocalUrl(original);

                // Preload image
                if (local) {
                    const link = document.createElement('link');
                    link.rel = 'preload';
                    link.as = 'image';
                    link.href = local;
                    head.appendChild(link);
                }

                slideDiv.innerHTML = `
                    <img src="${local}" alt="${slide.title || 'Hero'}" class="w-full h-full object-cover object-center"
                         loading="eager" crossorigin="anonymous"
                         onload="console.log('Hero slide loaded:', this.src)"
                         onerror="console.error('Hero slide failed from uploads:', '${local}'); this.onerror=null; this.src='${original}'; this.onload=null; this.onerror=function(){ this.style.display='none'; const fb=this.nextElementSibling; if(fb) fb.style.display='flex'; };">
                    <div class="w-full h-full bg-gradient-to-br from-purple-600/50 to-indigo-700/50 flex items-center justify-center" style="display: none;">
                        <div class="text-white text-center px-4">
                            <h1 class="text-3xl md:text-4xl font-bold mb-2">${slide.title || ''}</h1>
                            <p class="text-sm md:text-base">${slide.description || ''}</p>
                        </div>
                    </div>
                `;
                container.appendChild(slideDiv);
            });
        }

        function showSlide(index) {
            const slides = document.querySelectorAll('.hero-slide');
            if (slides.length === 0) return;
            
            slides.forEach((slide, i) => {
                const isActive = i === index;
                if (isActive) {
                    slide.style.display = 'block';
                    slide.style.opacity = '1';
                    slide.style.visibility = 'visible';
                    slide.style.zIndex = '2';
                    slide.classList.add('active');
                } else {
                    slide.style.display = 'none';
                    slide.style.opacity = '0';
                    slide.style.visibility = 'hidden';
                    slide.style.zIndex = '1';
                    slide.classList.remove('active');
                }
                // Pause any video on inactive slides
                const video = slide.querySelector('video');
                if (video) {
                    if (isActive) {
                        video.currentTime = 0;
                        // Keep manual play only; do not auto-play
                    } else {
                        video.pause();
                    }
                }
            });
        }

        function nextSlide() {
            if (!heroSlides || heroSlides.length === 0) return;
            currentSlide = (currentSlide + 1) % heroSlides.length;
            showSlide(currentSlide);
        }

        function prevSlide() {
            if (!heroSlides || heroSlides.length === 0) return;
            currentSlide = (currentSlide - 1 + heroSlides.length) % heroSlides.length;
            showSlide(currentSlide);
        }

        let sliderInterval = null;
        
        // AUTO-PLAY ENABLED - Slides auto-move every 5 seconds
        function startHeroSlider() {
            if (!heroSlides || heroSlides.length === 0) {
                console.warn('Hero slider: no slides available for auto-play');
                return;
            }
            // Clear any existing interval
            if (sliderInterval) clearInterval(sliderInterval);
            currentSlide = currentSlide % heroSlides.length;
            showSlide(currentSlide);
            
            // Auto-advance slides every 5 seconds
            sliderInterval = setInterval(() => {
                nextSlide();
            }, 5000);
            
            console.log('Hero slider auto-play enabled (5s interval)');
        }

        const nextSlideBtn = document.getElementById('next-slide');
        const prevSlideBtn = document.getElementById('prev-slide');
        if (nextSlideBtn) nextSlideBtn.addEventListener('click', nextSlide);
        if (prevSlideBtn) prevSlideBtn.addEventListener('click', prevSlide);
        
        // Add touch/swipe support for mobile devices
        let touchStartX = 0;
        let touchEndX = 0;
        const heroSlider = document.getElementById('hero-slider');
        
        if (heroSlider) {
            heroSlider.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            }, { passive: true });
            
            heroSlider.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, { passive: true });
            
            // Mouse drag support for desktop
            let mouseDown = false;
            let startX;
            
            heroSlider.addEventListener('mousedown', (e) => {
                mouseDown = true;
                startX = e.pageX;
                heroSlider.style.cursor = 'grabbing';
            });
            
            heroSlider.addEventListener('mouseup', (e) => {
                if (mouseDown) {
                    mouseDown = false;
                    heroSlider.style.cursor = 'grab';
                    const endX = e.pageX;
                    const diff = startX - endX;
                    if (Math.abs(diff) > 50) {
                        if (diff > 0) {
                            nextSlide();
                        } else {
                            prevSlide();
                        }
                    }
                }
            });
            
            heroSlider.addEventListener('mouseleave', () => {
                if (mouseDown) {
                    mouseDown = false;
                    heroSlider.style.cursor = 'grab';
                }
            });
            
            heroSlider.style.cursor = 'grab';
        }
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swiped left - next slide
                    nextSlide();
                } else {
                    // Swiped right - previous slide
                    prevSlide();
                }
            }
        }
        
        // Load About Section from API
        async function loadAboutSection() {
            try {
                const response = await fetch(`/api/content/about-section?t=${Date.now()}`);
                if (!response.ok) throw new Error('Failed to load about section');
                const data = await response.json();
                
                if (data && Object.keys(data).length > 0) {
                    document.getElementById('about-title').textContent = data.name || 'Our Expert Astrologer';
                    document.getElementById('about-description').textContent = data.description || '';
                    const aboutImage = document.getElementById('about-image');
                    const fallback = aboutImage ? aboutImage.nextElementSibling : null;
                    
                    if (data.img && data.img.trim() !== '') {
                        // Convert to local URL for faster loading
                        let imgUrl = convertToLocalUrl(data.img);
                        console.log('✅ About section using local image:', imgUrl);
                        
                        if (aboutImage) {
                            aboutImage.src = imgUrl;
                            aboutImage.className = 'w-full h-full object-cover rounded-2xl shadow-2xl';
                            aboutImage.loading = 'lazy';
                            aboutImage.style.display = 'block';
                            aboutImage.onload = function() {
                                console.log('✅ About image loaded successfully from uploads:', imgUrl);
                                this.style.opacity = '1';
                                if (fallback) fallback.style.display = 'none';
                            };
                            aboutImage.onerror = function() {
                                console.error('❌ About image failed, showing fallback:', imgUrl);
                                this.style.display = 'none';
                                if (fallback) {
                                    fallback.style.display = 'flex';
                                    fallback.innerHTML = '<div class="w-full h-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center rounded-2xl"><i class="fas fa-user-astronaut text-white text-6xl md:text-8xl"></i></div>';
                                }
                            };
                            if (fallback) fallback.style.display = 'none';
                        }
                    } else {
                        console.log('ℹ️ No about image URL provided');
                        if (aboutImage) aboutImage.style.display = 'none';
                        if (fallback) fallback.style.display = 'block';
                    }
                    
                    // Render additional details with new fields
                    const detailsContainer = document.getElementById('about-details');
                    const details = [];
                    
                    if (data.years_of_experience) {
                        details.push(`<div class="flex items-start"><i class="fas fa-calendar-alt text-purple-600 mt-1 mr-3"></i><p><strong>Experience:</strong> ${data.years_of_experience}</p></div>`);
                    }
                    if (data.expertise_areas) {
                        details.push(`<div class="flex items-start"><i class="fas fa-star text-purple-600 mt-1 mr-3"></i><p><strong>Expertise:</strong> ${data.expertise_areas}</p></div>`);
                    }
                    if (data.location) {
                        details.push(`<div class="flex items-start"><i class="fas fa-map-marker-alt text-purple-600 mt-1 mr-3"></i><p><strong>Location:</strong> ${data.location}</p></div>`);
                    }
                    if (data.accurate_predictions) {
                        details.push(`<div class="flex items-start"><i class="fas fa-check-circle text-purple-600 mt-1 mr-3"></i><p><strong>Predictions:</strong> ${data.accurate_predictions}</p></div>`);
                    }
                    
                    detailsContainer.innerHTML = details.join('');
                } else {
                    // Default content if no data
                    document.getElementById('about-title').textContent = 'Our Expert Astrologer';
                    document.getElementById('about-description').textContent = 'Welcome to our astrology consultation service. Our expert astrologer brings years of experience in Vedic astrology, tarot reading, and spiritual guidance.';
                    document.getElementById('about-details').innerHTML = `
                        <div class="flex items-start"><i class="fas fa-calendar-alt text-purple-600 mt-1 mr-3"></i><p><strong>Experience:</strong> 15+ Years</p></div>
                        <div class="flex items-start"><i class="fas fa-star text-purple-600 mt-1 mr-3"></i><p><strong>Expertise:</strong> Vedic Astrology, Tarot, Vastu</p></div>
                        <div class="flex items-start"><i class="fas fa-map-marker-alt text-purple-600 mt-1 mr-3"></i><p><strong>Location:</strong> Mumbai, India</p></div>
                        <div class="flex items-start"><i class="fas fa-check-circle text-purple-600 mt-1 mr-3"></i><p><strong>Predictions:</strong> 10,000+ Accurate Predictions</p></div>
                    `;
                }
            } catch (error) {
                console.error('Error loading about section:', error);
            }
        }
        
        // Load Gallery Slides from API
        async function loadGallerySlides() {
            try {
                // Check session storage first
                const cachedGallery = sessionStorage.getItem('gallerySlides');
                if (cachedGallery) {
                    const gallerySlides = JSON.parse(cachedGallery);
                    console.log('✅ Loaded gallery slides from session storage (cached):', gallerySlides.length, 'slides');
                    renderGallerySlides(gallerySlides);
                    return;
                }
                
                console.log('Fetching gallery slides from API...');
                const response = await fetch(`/api/content/gallery-slides?t=${Date.now()}`);
                console.log('Gallery slides response status:', response.status);
                if (!response.ok) throw new Error('Failed to load gallery slides');
                const data = await response.json();
                console.log('Gallery slides data received:', data);
                
                // Handle API response format and convert to local URLs
                let gallerySlides = [];
                if (Array.isArray(data)) {
                    // Convert all image URLs to local for faster loading
                    gallerySlides = data.map(slide => ({
                        ...slide,
                        image: convertToLocalUrl(slide.image)
                    }));
                    // Save to session storage
                    sessionStorage.setItem('gallerySlides', JSON.stringify(gallerySlides));
                    console.log('✅ Loaded', gallerySlides.length, 'gallery slides (using local URLs) and cached');
                    // Debug: Check first slide's image URL
                    if (gallerySlides.length > 0) {
                        console.log('First gallery slide local URL:', gallerySlides[0].image);
                    }
                } else {
                    console.error('Invalid gallery slides data format:', data);
                }
                
                renderGallerySlides(gallerySlides);
            } catch (error) {
                console.error('Error loading gallery slides:', error);
                renderGallerySlides([]);
            }
        }

        function renderGallerySlides(slides) {
            const container = document.getElementById('gallery-slides-container');
            container.innerHTML = '';
            
            if (slides.length === 0) {
                container.innerHTML = '<div class="w-full text-center py-12 text-gray-500"><p class="text-xl">No gallery images available yet.</p></div>';
                return;
            }
            
            slides.forEach(slide => {
                const slideDiv = document.createElement('div');
                slideDiv.className = 'flex-shrink-0 gallery-item bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl';
                const localImageUrl = convertToLocalUrl(slide.image);
                slideDiv.innerHTML = `
                    <div class="relative overflow-hidden gallery-img-container\">\n                        <img src=\"${localImageUrl}\" 
                                                     alt="${slide.title}" 
                                                     style="width: 100%; height: 100%; object-fit: cover; display: block;"
                                                     loading="eager"
                                                     fetchpriority="high"
                                                     crossorigin="anonymous"
                                                     onload="console.log('✅ Gallery image loaded from uploads:', '${localImageUrl}')" onerror="console.error('❌ Gallery image failed:', '${localImageUrl}'); this.onerror=null; this.style.display='none'; const fallback = this.nextElementSibling; if(fallback) fallback.style.display='flex';">                        <div class="w-full h-full bg-gradient-to-br from-amber-400 to-red-500 flex items-center justify-center" style="display: none;">
                            <div class="text-white text-center p-4">
                                <i class="fas fa-image text-3xl mb-2"></i>
                                <p class="text-sm">Image Not Available</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-4">
                        <h4 class="font-bold text-purple-800 text-center text-lg">${slide.title}</h4>
                    </div>
                `;
                container.appendChild(slideDiv);
            });
            
            // Initialize gallery slider
            initGallerySlider();
        }
        
        // Gallery Slider Logic
        let galleryCurrentIndex = 0;
        let galleryAutoSlideInterval;
        let galleryRafId = null;
        let galleryTransform = 0;
        
        function initGallerySlider() {
            const container = document.getElementById('gallery-slides-container');
            const prevBtn = document.getElementById('gallery-prev');
            const nextBtn = document.getElementById('gallery-next');
            const slides = Array.from(container.querySelectorAll('.gallery-item'));
            if (slides.length === 0) return;

            // Single-line continuous sliding: disable CSS transitions for smooth RAF control
            container.style.transition = 'none';

            // Compute responsive slide width (including gap)
            const getSlideWidth = () => {
                const first = slides[0];
                const gap = parseInt(window.getComputedStyle(container).gap || '24', 10);
                return first.offsetWidth + gap;
            };
            let slideWidth = getSlideWidth();

            // Hover pause/resume support
            let galleryPaused = false;

            // Continuous movement to the left (common UX) - MEDIUM SPEED
            const step = () => {
                if (!galleryPaused) {
                    galleryTransform -= 0.4; // Medium speed (reduced from 0.6)
                    if (Math.abs(galleryTransform) >= slideWidth) {
                        galleryTransform += slideWidth; // keep continuity
                        const first = container.firstElementChild;
                        if (first) container.appendChild(first); // rotate without duplicating
                    }
                    container.style.transform = `translateX(${galleryTransform}px)`;
                }
                galleryRafId = requestAnimationFrame(step);
            };
            cancelAnimationFrame(galleryRafId);
            galleryRafId = requestAnimationFrame(step);

            // Pause/resume on hover
            const pause = () => {
                if (!galleryPaused) {
                    galleryPaused = true;
                    cancelAnimationFrame(galleryRafId);
                }
            };
            const resume = () => {
                if (galleryPaused) {
                    galleryPaused = false;
                    cancelAnimationFrame(galleryRafId);
                    galleryRafId = requestAnimationFrame(step);
                }
            };
            container.addEventListener('mouseenter', pause);
            container.addEventListener('mouseleave', resume);
            slides.forEach(s => {
                s.addEventListener('mouseenter', pause);
                s.addEventListener('mouseleave', resume);
            });

            // Arrows move exactly one card
            nextBtn.addEventListener('click', () => {
                // Simulate one-card shift
                galleryTransform = 0;
                container.style.transform = `translateX(0px)`;
                const first = container.firstElementChild;
                if (first) container.appendChild(first);
            });

            prevBtn.addEventListener('click', () => {
                const last = container.lastElementChild;
                if (last) container.prepend(last);
                galleryTransform = 0;
                container.style.transform = `translateX(0px)`;
            });

            // Responsive adjustments
            window.addEventListener('resize', () => {
                slideWidth = getSlideWidth();
                container.style.transform = `translateX(${galleryTransform}px)`;
            });
        }
        
        // Setup Contact Form Handler
        function setupContactFormHandler() {
            const contactForm = document.getElementById('contact-form-home');
            if (!contactForm) return;
            
            contactForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = {
                    name: document.getElementById('contact-name').value,
                    phone: document.getElementById('contact-phone').value,
                    email: document.getElementById('contact-email').value || '',
                    topic: document.getElementById('contact-topic').value || 'General Inquiry',
                    message: document.getElementById('contact-message').value
                };
                
                const messageDiv = document.getElementById('contact-form-message');
                
                try {
                    messageDiv.className = 'mt-4 p-4 bg-blue-100 text-blue-700 rounded-lg block';
                    messageDiv.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>Sending your message...';
                    
                    const response = await fetch('/api/contact-messages', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(formData)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok && result.success) {
                        messageDiv.className = 'mt-4 p-4 bg-green-100 text-green-700 rounded-lg block';
                        messageDiv.innerHTML = `
                            <i class=\"fas fa-check-circle mr-2\"></i>
                            Thank you ${formData.name}! We've received your message and will contact you soon.
                        `;
                        contactForm.reset();
                        
                        setTimeout(() => {
                            messageDiv.classList.add('hidden');
                        }, 5000);
                    } else {
                        throw new Error(result.error || 'Submission failed');
                    }
                } catch (error) {
                    console.error('Error submitting contact form:', error);
                    messageDiv.className = 'mt-4 p-4 bg-red-100 text-red-700 rounded-lg block';
                    messageDiv.innerHTML = '<i class=\"fas fa-exclamation-circle mr-2\"></i>Failed to send message. Please try again.';
                }
            });
        }
        
        // Load Footer Contact Info from API
        async function loadContactInfo() {
            try {
                const response = await fetch('/api/business-info');
                const config = await response.json();
                globalBusinessInfo = config; // Store globally for use in other functions
                
                if (config) {
                    document.getElementById('footer-phone').textContent = config.phone || '+91 8431729319';
                    document.getElementById('footer-email').textContent = config.email || 'info@example.com';
                    
                    // Update contact form quick action buttons
                    const callBtn = document.getElementById('quick-call-btn');
                    const whatsappBtn = document.getElementById('quick-whatsapp-btn');
                    if (callBtn && config.phone) callBtn.href = `tel:${config.phone}`;
                    if (whatsappBtn && config.phone) whatsappBtn.href = `https://wa.me/${config.phone.replace(/[^0-9]/g, '')}`;
                    
                    const socialsDiv = document.getElementById('footer-socials');
                    socialsDiv.innerHTML = '';
                    
                    // Social media links from business_info table (social_media JSON field)
                    // Fetch Follow Us section data properly from database
                    if (config.social_media && typeof config.social_media === 'object') {
                        const socials = config.social_media;
                        if (socials.facebook) {
                            socialsDiv.innerHTML += `<a href="${socials.facebook}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition" aria-label="Facebook"><i class="fab fa-facebook"></i></a>`;
                        }
                        if (socials.instagram) {
                            socialsDiv.innerHTML += `<a href="${socials.instagram}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition" aria-label="Instagram"><i class="fab fa-instagram"></i></a>`;
                        }
                        if (socials.youtube) {
                            socialsDiv.innerHTML += `<a href="${socials.youtube}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition" aria-label="YouTube"><i class="fab fa-youtube"></i></a>`;
                        }
                        if (socials.twitter) {
                            socialsDiv.innerHTML += `<a href="${socials.twitter}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition" aria-label="Twitter"><i class="fab fa-twitter"></i></a>`;
                        }
                        if (socials.linkedin) {
                            socialsDiv.innerHTML += `<a href="${socials.linkedin}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>`;
                        }
                    }
                    
                    // Fallback to individual fields if social_media object doesn't exist
                    if (!config.social_media || (typeof config.social_media === 'object' && Object.keys(config.social_media).length === 0)) {
                        if (config.facebook) {
                            socialsDiv.innerHTML += `<a href="${config.facebook}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition"><i class="fab fa-facebook"></i></a>`;
                        }
                        if (config.instagram) {
                            socialsDiv.innerHTML += `<a href="${config.instagram}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition"><i class="fab fa-instagram"></i></a>`;
                        }
                        if (config.youtube) {
                            socialsDiv.innerHTML += `<a href="${config.youtube}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition"><i class="fab fa-youtube"></i></a>`;
                        }
                        if (config.twitter) {
                            socialsDiv.innerHTML += `<a href="${config.twitter}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition"><i class="fab fa-twitter"></i></a>`;
                        }
                    }
                    
                    // Add WhatsApp with auto-greeting message
                    const whatsappNumber = config.whatsapp_number || config.whatsapp || config.phone;
                    if (whatsappNumber) {
                        const whatsappNum = whatsappNumber.replace(/\D/g, '');
                        const greeting = encodeURIComponent('🙏 Namaste! I am interested in your astrology services. Please guide me with consultation details, timings, and pricing. Thank you!');
                        socialsDiv.innerHTML += `<a href="https://wa.me/${whatsappNum}?text=${greeting}" target="_blank" rel="noopener noreferrer" class="text-2xl hover:text-yellow-300 transition"><i class="fab fa-whatsapp"></i></a>`;
                    }

                    // Apply background images to services sections from navbar_settings
                    const navbarResponse = await fetch('/api/navbar-settings');
                    if (navbarResponse.ok) {
                        const navbarSettings = await navbarResponse.json();
                        
                        if (navbarSettings.astrological_services_bg_url) {
                            console.log('🎨 Applying Astrological Services BG:', navbarSettings.astrological_services_bg_url);
                            applyServiceBackground('services', navbarSettings.astrological_services_bg_url);
                        }
                        
                        if (navbarSettings.pooja_services_bg_url) {
                            console.log('🎨 Applying Pooja Services BG:', navbarSettings.pooja_services_bg_url);
                            applyServiceBackground('pooja', navbarSettings.pooja_services_bg_url);
                        }
                    }
                    
                    // Fallback to site_settings if needed
                    if (config.astrological_services_bg_url) {
                        applyServiceBackground('services', config.astrological_services_bg_url);
                    }
                    if (config.pooja_services_bg_url) {
                        applyServiceBackground('pooja', config.pooja_services_bg_url);
                    }
                }
            } catch (error) {
                console.error('Error loading contact info:', error);
                document.getElementById('footer-phone').textContent = 'Error loading';
                document.getElementById('footer-email').textContent = 'Error loading';
            }
        }
        
        // Helper function to apply background to service sections
        function applyServiceBackground(sectionId, bgUrl) {
            const section = document.getElementById(sectionId);
            if (!section) {
                console.warn(`⚠️ Section not found: ${sectionId}`);
                return;
            }
            if (!bgUrl) {
                console.warn(`⚠️ No background URL for section: ${sectionId}`);
                return;
            }
            
            // Keep original URL (don't convert - backgrounds can be from Supabase or local)
            console.log(`🖼️ Applying background to ${sectionId}:`, bgUrl);
            
            // Apply background styles - scroll with section
            section.style.backgroundImage = `url('${bgUrl}')`;
            section.style.backgroundSize = 'cover';
            section.style.backgroundPosition = 'center';
            section.style.backgroundRepeat = 'no-repeat';
            section.style.backgroundAttachment = 'scroll'; // Scroll with section
            section.style.position = 'relative';
            
            // Add subtle overlay for readability (lighter for better visibility)
            let overlay = document.getElementById(`${sectionId}-bg-overlay`);
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = `${sectionId}-bg-overlay`;
                overlay.style.position = 'absolute';
                overlay.style.inset = '0';
                overlay.style.backgroundColor = 'rgba(255,255,255,0.85)'; // Lighter overlay
                overlay.style.pointerEvents = 'none';
                overlay.style.zIndex = '1';
                section.prepend(overlay);
            }
            
            // Ensure container content sits above overlay
            const container = section.querySelector('.container');
            if (container) {
                container.style.position = 'relative';
                container.style.zIndex = '10';
            }
            
            console.log(`✅ Background applied successfully to ${sectionId}`);
        }

        // Global helper to convert ALL URLs to local /uploads/ with bucket fallback
        function convertToLocalUrl(url, skipConversion = false) {
            try {
                if (!url) return '';
                if (skipConversion) return url; // Keep original URL when explicitly asked

                // Already local
                if (url.startsWith('/uploads/')) return url;

                // Extract filename from common patterns (Supabase/storage URLs or path URLs)
                let filename = '';
                try {
                    const u = new URL(url, window.location.origin);
                    const pathParts = u.pathname.split('/');
                    filename = pathParts[pathParts.length - 1];
                } catch (_) {
                    // URL may be a relative path; try string split
                    const parts = url.split('/');
                    filename = parts[parts.length - 1];
                }
                filename = (filename || '').split('?')[0];

                // If we still can't determine, force it into uploads with original path string
                const localUrl = filename ? `/uploads/${filename}` : `/uploads/${url}`;
                return localUrl;
            } catch (e) {
                console.error('convertToLocalUrl error:', e);
                return url;
            }
        }
        
        // Load and Display Reviews from Database
        // Variables declared at top of script section

        // REVIEWS CONTINUOUS SLIDING CAROUSEL - New Implementation
        // reviewsData and currentReviewIndex already declared globally at top
        let reviewsRafId = null;
        let reviewsPaused = false;
        let reviewSlideWidth = 0;
        let reviewOffset = 0;
        
        // Default review image (falls back when no user image is present)
        const defaultReviewImage = '/static/assets/images/slider1-1765343440118-814547787.png';
        // Default avatar placeholder (global)
        const defaultAvatar = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill=%22%23a855f7%22%3E%3Cpath d=%22M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z%22/%3E%3C/svg%3E';

        // Letter avatar fallback (global)
        function getLetterAvatar(name) {
            const safeName = (name || 'A').trim();
            const letter = safeName.charAt(0).toUpperCase() || 'A';
            const palette = ['#7C3AED', '#EC4899', '#2563EB', '#059669', '#F59E0B', '#DC2626', '#0EA5E9', '#8B5CF6'];
            let hash = 0;
            for (let i = 0; i < safeName.length; i++) hash = ((hash << 5) - hash) + safeName.charCodeAt(i);
            const color = palette[Math.abs(hash) % palette.length];
            const svg = `
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48">
                    <rect width="100%" height="100%" rx="24" fill="${color}"/>
                    <text x="50%" y="54%" dominant-baseline="middle" text-anchor="middle" fill="#fff" font-size="24" font-weight="700" font-family="Arial, sans-serif">${letter}</text>
                </svg>`;
            return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
        }

        function computeReviewSlideWidth() {
            const carousel = document.getElementById('reviews-carousel');
            if (!carousel || !carousel.firstElementChild) return 0;
            const gap = parseInt(window.getComputedStyle(carousel).gap || '16', 10);
            const width = carousel.firstElementChild.getBoundingClientRect().width;
            return width + gap;
        }

        // Default review image as data URL (SVG)
        const defaultReviewImageSVG = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100"%3E%3Ccircle fill="%237C3AED" cx="50" cy="50" r="50"/%3E%3Ctext fill="white" font-size="40" font-weight="bold" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3E👤%3C/text%3E%3C/svg%3E';

        function renderReviewsCarousel() {
            console.log('🎯 renderReviewsCarousel called');
            const carousel = document.getElementById('reviews-carousel');
            
            if (!carousel) {
                console.error('❌ Missing carousel container');
                return;
            }
            
            if (!reviewsData || reviewsData.length === 0) {
                carousel.innerHTML = '<p class="text-center text-gray-500 w-full py-8">No reviews to display.</p>';
                return;
            }

            // Remove duplicates
            const uniqueReviews = [];
            const seen = new Set();
            reviewsData.forEach(r => {
                const key = r.id || `${r.name || ''}-${r.review_text || r.text || ''}`;
                if (!seen.has(key)) {
                    seen.add(key);
                    uniqueReviews.push(r);
                }
            });

            uniqueReviews.sort((a, b) => (a.display_order ?? 999) - (b.display_order ?? 999));
            reviewsData = uniqueReviews;

            // Duplicate reviews for seamless infinite scroll
            const reviewsToRender = [...uniqueReviews, ...uniqueReviews];

            // Clear carousel
            carousel.innerHTML = '';

            // Render review cards - Fixed width for horizontal scroll
            reviewsToRender.forEach((review) => {
                const name = review.name || 'Anonymous';
                const text = review.review_text || review.text || 'Great service!';
                const imageSource = (review.photo || review.image_url || review.user_image || review.avatar || '').trim();
                
                // Use letter avatar as fallback
                const letterAvatar = getLetterAvatar(name);
                let reviewImage = letterAvatar;
                
                if (imageSource) {
                    const converted = convertToLocalUrl(imageSource);
                    if (converted) reviewImage = converted;
                }

                const card = document.createElement('div');
                card.className = 'review-card flex-shrink-0';
                
                card.innerHTML = `
                    <div class="h-full bg-white rounded-xl shadow-md p-4 flex flex-col items-center text-center border border-purple-100 review-card-inner\">\n                        <div class=\"w-16 h-16 rounded-full overflow-hidden ring-2 ring-purple-200 bg-purple-100 mb-3\">
                            <img src="${reviewImage}" alt="${name}" class="w-full h-full object-cover" loading="lazy" onerror="this.src='${letterAvatar}';">
                        </div>
                        <h4 class="font-bold text-purple-800 text-base">${name}</h4>
                        <p class="text-gray-600 text-sm leading-relaxed flex-1 overflow-hidden" style="display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical;">${text}</p>
                    </div>
                `;
                carousel.appendChild(card);
            });

            reviewOffset = 0;
            carousel.style.transform = 'translateX(0px)';
            reviewSlideWidth = computeReviewSlideWidth();
        }

        function startReviewsMarquee() {
            const carousel = document.getElementById('reviews-carousel');
            if (!carousel || !carousel.children.length) {
                console.warn('⚠️ Cannot start reviews marquee - missing carousel or slides');
                return;
            }

            reviewSlideWidth = computeReviewSlideWidth();
            reviewOffset = 0;
            carousel.style.transition = 'none';

            const step = () => {
                if (!reviewsPaused) {
                    reviewOffset -= 0.4; // Medium speed (same as gallery)
                    if (Math.abs(reviewOffset) >= reviewSlideWidth) {
                        reviewOffset += reviewSlideWidth;
                        const first = carousel.firstElementChild;
                        if (first) carousel.appendChild(first);
                    }
                    carousel.style.transform = `translateX(${reviewOffset}px)`;
                }
                reviewsRafId = requestAnimationFrame(step);
            };

            cancelAnimationFrame(reviewsRafId);
            reviewsRafId = requestAnimationFrame(step);

            const pause = () => {
                reviewsPaused = true;
                cancelAnimationFrame(reviewsRafId);
            };
            const resume = () => {
                if (reviewsPaused) {
                    reviewsPaused = false;
                    cancelAnimationFrame(reviewsRafId);
                    reviewsRafId = requestAnimationFrame(step);
                }
            };

            carousel.addEventListener('mouseenter', pause);
            carousel.addEventListener('mouseleave', resume);
            carousel.addEventListener('touchstart', pause, { passive: true });
            carousel.addEventListener('touchend', () => setTimeout(resume, 600), { passive: true });

            // Also pause when hovering/touching a specific card
            Array.from(carousel.querySelectorAll('.review-card')).forEach(card => {
                card.addEventListener('mouseenter', pause);
                card.addEventListener('mouseleave', resume);
                card.addEventListener('touchstart', pause, { passive: true });
                card.addEventListener('touchend', () => setTimeout(resume, 600), { passive: true });
            });

            const prevBtn = document.getElementById('reviews-prev');
            const nextBtn = document.getElementById('reviews-next');
            if (prevBtn) {
                prevBtn.onclick = () => {
                    const last = carousel.lastElementChild;
                    if (last) carousel.prepend(last);
                    reviewOffset = 0;
                    carousel.style.transform = 'translateX(0px)';
                };
            }
            if (nextBtn) {
                nextBtn.onclick = () => {
                    const first = carousel.firstElementChild;
                    if (first) carousel.appendChild(first);
                    reviewOffset = 0;
                    carousel.style.transform = 'translateX(0px)';
                };
            }

            window.addEventListener('resize', () => {
                reviewSlideWidth = computeReviewSlideWidth();
                reviewOffset = 0;
                carousel.style.transform = 'translateX(0px)';
            });
        }

        // Boot reviews
        async function loadReviews() {
            console.log('🔄 Loading reviews from API...');
            try {
                const cached = sessionStorage.getItem('reviewsData');
                if (cached) {
                    console.log('📦 Found cached reviews');
                    reviewsData = JSON.parse(cached);
                    if (reviewsData.length > 0) {
                        console.log('✅ Using cached reviews:', reviewsData.length);
                        renderReviewsCarousel();
                        startReviewsMarquee();
                        return;
                    }
                }
                // Fetch ALL reviews (no active filter), then render immediately
                console.log('🌐 Fetching reviews from API...');
                const response = await fetch('/api/reviews');
                console.log('✅ API response status:', response.status);
                reviewsData = await response.json();
                console.log('📊 Reviews received:', reviewsData?.length || 0, reviewsData);
                sessionStorage.setItem('reviewsData', JSON.stringify(reviewsData));
                if (reviewsData && reviewsData.length > 0) {
                    console.log('✅ Rendering', reviewsData.length, 'reviews');
                    renderReviewsCarousel();
                    startReviewsMarquee();
                } else {
                    console.warn('⚠️ No reviews to display');
                    const carousel = document.getElementById('reviews-carousel');
                    if (carousel) {
                        carousel.innerHTML = '<div class="text-center p-8 text-gray-500 w-full"><i class="fas fa-info-circle text-4xl mb-4"></i><p>No reviews available yet</p></div>';
                    }
                }
            } catch (error) {
                console.error('💥 Error loading reviews:', error);
                const carousel = document.getElementById('reviews-carousel');
                if (carousel) {
                    carousel.innerHTML = '<div class="text-center p-8 text-red-500 w-full"><i class="fas fa-exclamation-circle text-4xl mb-4"></i><p>Failed to load reviews</p></div>';
                }
            }
        }

        // LANGUAGE DROPDOWN OVERLAY BEHAVIOR
        // ========================================
        document.addEventListener('DOMContentLoaded', () => {
            const langBtn = document.getElementById('lang-dropdown-btn');
            const langDropdown = document.getElementById('lang-dropdown');

            if (!langBtn || !langDropdown) return;

            // Toggle dropdown overlay
            langBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                langDropdown.classList.toggle('hidden');
            });

            // Close when selecting an option inside dropdown
            langDropdown.addEventListener('click', (e) => {
                const option = e.target.closest('button, a, [data-lang-code]');
                if (!option) return;
                langDropdown.classList.add('hidden');
            });

            // Close when selecting a language in Google Translate <select>
            langDropdown.addEventListener('change', (e) => {
                const target = e.target;
                if (target && target.matches && target.matches('select.goog-te-combo')) {
                    langDropdown.classList.add('hidden');
                }
            });

            // Close on outside click
            document.addEventListener('click', (e) => {
                if (langDropdown.classList.contains('hidden')) return;
                if (!langBtn.contains(e.target) && !langDropdown.contains(e.target)) {
                    langDropdown.classList.add('hidden');
                }
            });

            // Close on Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key !== 'Escape') return;
                if (!langDropdown.classList.contains('hidden')) {
                    langDropdown.classList.add('hidden');
                }
            });
        });

        // Fast loading - ensure loading screen is hidden quickly
        // Fallback: Force hide loading screen after 2 seconds max
        setTimeout(() => {
            const loadingScreen = document.getElementById('loading-screen');
            const mainContent = document.getElementById('main-content');
            if (loadingScreen && loadingScreen.style.display !== 'none') {
                console.log('⚡ Force hiding loading screen (2s timeout)');
                loadingScreen.style.display = 'none';
                if (mainContent) {
                    mainContent.style.opacity = '1';
                    mainContent.style.visibility = 'visible';
                }
            }
        }, 2000);

        // Page initialization - Optimized for FAST Loading
        document.addEventListener('DOMContentLoaded', () => {
            console.log('✅ Page ready');
            
            // Hide loading screen immediately after DOM ready
            setTimeout(() => {
                const loadingScreen = document.getElementById('loading-screen');
                const mainContent = document.getElementById('main-content');
                if (loadingScreen) loadingScreen.style.display = 'none';
                if (mainContent) {
                    mainContent.style.opacity = '1';
                    mainContent.style.visibility = 'visible';
                }
            }, 100);
            
            // Priority 0: Critical UI elements (immediate)
            loadNavbar();
            loadAnnouncementBar();
            loadHeroSlides();
            
            // Initialize chatbot
            setTimeout(() => {
                if (typeof createChatbot === 'function') {
                    createChatbot();
                }
            }, 1000);
            
            // Priority 1: Above-the-fold content (immediate)
            setTimeout(() => {
                loadAstrologicalServices();
                loadGallerySlides();
            }, 50);
            
            // Priority 2: Below-the-fold content (delayed)
            setTimeout(() => {
                loadAboutSection();
                loadContactInfo();
                loadReviews();
                
                // Initialize lazy loading for services
                initLazyLoading();
                
                // Setup contact form handler
                setupContactFormHandler();
            }, 150);
            
            // Smooth scrolling for navigation links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                    if (href === '#' || href === '') return;
                    
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        // Close mobile menu if open
                        const mobileMenu = document.getElementById('mobile-menu');
                        if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                            mobileMenu.classList.add('hidden');
                        }
                        
                        // Smooth scroll to section
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
            
            // Highlight active nav link on scroll
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link, .mobile-nav-link');
            
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    if (scrollY >= (sectionTop - 100)) {
                        current = section.getAttribute('id');
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('text-yellow-300');
                    if (link.getAttribute('href') === '#' + current) {
                        link.classList.add('text-yellow-300');
                    }
                });
            });

            // Solutions menu link fix: route '#solutions' to '#expert-solutions'
            document.addEventListener('click', function(e) {
                const a = e.target.closest('a[href="#solutions"]');
                if (a) {
                    e.preventDefault();
                    const target = document.getElementById('expert-solutions');
                    if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>

    <!-- Footer -->
    <footer class="bg-gradient-to-br from-gray-900 via-purple-900 to-black text-white py-12 md:py-16">
        <div class="container mx-auto px-4 sm:px-6 md:px-8">
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 md:gap-12">
                <div>
                    <h3 class="text-xl md:text-2xl font-bold mb-4 font-serif text-yellow-300">Sri Mahakali Bhairavi Astrology Center</h3>
                    <p class="text-gray-300 text-sm md:text-base">Your trusted guide to cosmic wisdom and spiritual enlightenment.</p>
                </div>
                <div>
                    <h4 class="text-lg md:text-xl font-bold mb-4 text-yellow-300">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="/" class="hover:text-yellow-300 transition text-sm md:text-base"><i class="fas fa-home mr-2"></i>Home</a></li>
                        <li><a href="#services" class="hover:text-yellow-300 transition text-sm md:text-base"><i class="fas fa-star mr-2"></i>Services</a></li>
                        <li><a href="#contact" class="hover:text-yellow-300 transition text-sm md:text-base"><i class="fas fa-envelope mr-2"></i>Contact</a></li>
                        <li><a href="#reviews" class="hover:text-yellow-300 transition text-sm md:text-base"><i class="fas fa-comments mr-2"></i>Reviews</a></li>
                        <li><a href="/privacy" class="hover:text-yellow-300 transition text-sm md:text-base"><i class="fas fa-shield-alt mr-2"></i>Privacy Policy</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg md:text-xl font-bold mb-4 text-yellow-300">Contact Us</h4>
                    <div id="footer-contact-info" class="space-y-3">
                        <p class="text-sm md:text-base"><i class="fas fa-phone mr-2 text-yellow-300"></i><span id="footer-phone">Loading...</span></p>
                        <p class="text-sm md:text-base"><i class="fas fa-envelope mr-2 text-yellow-300"></i><span id="footer-email">Loading...</span></p>
                        <div id="footer-socials" class="flex space-x-4 mt-4">
                            <!-- Social links loaded from API -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="border-t border-purple-600 mt-8 pt-8 text-center text-purple-200">
                <p class="text-sm md:text-base">&copy; 2025 Sri Mahakali Bhairavi Astrology Center. All rights reserved.</p>
                <p class="mt-2 text-xs md:text-sm">
                    Developed by <a href="https://omkargouda.netlify.app/" target="_blank" class="text-yellow-300 hover:text-yellow-400 transition inline-flex items-center gap-1">
                        <i class="fas fa-briefcase"></i>
                        Omkar Gouda
                    </a>
                </p>
            </div>
        </div>
    </footer>
<script>
        // Simple Chatbot Implementation
        let isChatbotOpen = false;
        
        function createChatbot() {
            // Prevent duplicate chatbot injection
            if (document.getElementById('chatbot-widget')) return;
            const chatbotHTML = ` <div id="chatbot-widget" class="fixed bottom-4 right-4 sm:bottom-6 sm:right-6 z-50">
                    <!-- Chatbot Button -->
                    <button id="chatbot-toggle" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-full w-14 h-14 sm:w-16 sm:h-16 flex items-center justify-center shadow-2xl hover:shadow-purple-500/50 transition-all duration-300 hover:scale-110">
                        <i class="fas fa-comments text-xl sm:text-2xl"></i>
                    </button>
                    
                    <!-- Chatbot Window -->
                    <div id="chatbot-window" class="hidden fixed sm:absolute bottom-0 left-0 right-0 sm:bottom-20 sm:right-0 sm:left-auto w-full sm:w-96 h-[80vh] sm:h-[500px] bg-white sm:rounded-2xl shadow-2xl flex flex-col overflow-hidden" style="max-height: 600px;">
                        <!-- Header -->
                        <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-4 flex justify-between items-center">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-robot text-2xl"></i>
                                <div>
                                    <h3 class="font-bold">Astrology Assistant</h3>
                                    <p class="text-xs opacity-90">Ask me anything!</p>
                                </div>
                            </div>
                            <button id="chatbot-close" class="hover:bg-white/20 rounded-lg p-2 transition">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <!-- Messages -->
                        <div id="chatbot-messages" class="flex-1 overflow-y-auto p-4 bg-gray-50 space-y-3"></div>
                        
                        <!-- Menu Options (Scrollable) -->
                        <div class="bg-white border-t border-gray-200 px-3 py-2">
                            <div class="flex gap-2 overflow-x-auto" style="scrollbar-width: none; -ms-overflow-style: none;">
                                <style>
                                    .chatbot-menu::-webkit-scrollbar { display: none; }
                                </style>
                                <button onclick="sendMenuOption('services')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    🌟 Services
                                </button>
                                <button onclick="sendMenuOption('book')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-pink-500 to-rose-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📅 Book
                                </button>
                                <button onclick="sendMenuOption('hours')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    ⏰ Hours
                                </button>
                                <button onclick="sendMenuOption('location')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📍 Location
                                </button>
                                <button onclick="sendMenuOption('contact')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📞 Contact
                                </button>
                                <button onclick="sendMenuOption('social')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📱 Social
                                </button>
                                <button onclick="sendMenuOption('qa')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-teal-500 to-cyan-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    ❓ FAQ
                                </button>
                                <button onclick="contactViaWhatsApp()" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    💬 WhatsApp
                                </button>
                                <button onclick="contactViaCall()" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📞 Call Now
                                </button>
                            </div>
                        </div>
                        
                        <!-- Input -->
                        <div class="p-4 bg-white border-t">
                            <div class="flex gap-2">
                                <input type="text" id="chatbot-input" placeholder="Type your message..." class="flex-1 px-4 py-2 border-2 border-gray-300 rounded-full focus:border-purple-500 focus:outline-none">
                                <button id="chatbot-send" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-2 rounded-full hover:shadow-lg transition">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
               
            `;
            document.body.insertAdjacentHTML('beforeend', chatbotHTML);

            // Ensure chatbot stays visible above page sections
            const widget = document.getElementById('chatbot-widget');
            if (widget) widget.style.zIndex = '9997';
            
            // Event listeners
            let lastActivityTime = Date.now();
            let reviewTimerSet = false;
            let inactivityTimer = null;
            
            document.getElementById('chatbot-toggle').addEventListener('click', () => {
                const wasClosed = !isChatbotOpen;
                toggleChatbot();
                // Send greeting when opening chatbot for the first time
                if (wasClosed && isChatbotOpen) {
                    const messagesDiv = document.getElementById('chatbot-messages');
                    if (messagesDiv && messagesDiv.children.length === 0) {
                    setTimeout(() => {
                            const businessName = globalBusinessInfo?.business_name || 'Sri Mahakali Bhairavi Astrology Center';
                            const welcomeMsg = globalChatbotConfig?.welcome_message || `🙏 <strong>Namaste! Welcome to ${businessName}</strong><br><br>I'm here to help you explore the mysteries of the universe! ✨<br><br>How can I assist you today?<br>• Learn about our services 🌟<br>• Book a consultation 📅<br>• Get our contact info 📞<br><br><em>Type "menu" to see all options or ask me anything!</em>`;
                        addBotMessage(welcomeMsg);
                        startInactivityTimer();
                    }, 300);
                    }
                }
            });
            document.getElementById('chatbot-close').addEventListener('click', () => toggleChatbot(false));
            document.getElementById('chatbot-send').addEventListener('click', () => {
                sendMessage();
                lastActivityTime = Date.now();
                resetInactivityTimer();
            });
            document.getElementById('chatbot-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                    lastActivityTime = Date.now();
                    resetInactivityTimer();
                }
            });
            
            // Start inactivity timer
            function startInactivityTimer() {
                resetInactivityTimer();
            }
            
            function resetInactivityTimer() {
                if (inactivityTimer) clearTimeout(inactivityTimer);
                // Inactivity timer removed - no auto-prompts
            }

            // Close chatbot when tapping outside the panel
            if (!document.body.hasAttribute('data-chatbot-outside-close')) {
                document.body.setAttribute('data-chatbot-outside-close', 'true');
                document.addEventListener('click', (e) => {
                    if (!isChatbotOpen) return;
                    const win = document.getElementById('chatbot-window');
                    const toggle = document.getElementById('chatbot-toggle');
                    if (!win || !toggle) return;
                    if (!win.contains(e.target) && !toggle.contains(e.target)) {
                        toggleChatbot(false);
                    }
                });
            }
        }
        
        function toggleChatbot(forceOpen) {
            const chatWindow = document.getElementById('chatbot-window');
            const chatToggle = document.getElementById('chatbot-toggle');
            if (!chatWindow) return;
            isChatbotOpen = (typeof forceOpen === 'boolean') ? forceOpen : !isChatbotOpen;
            if (isChatbotOpen) {
                chatWindow.classList.remove('hidden');
                chatWindow.style.setProperty('display', 'flex', 'important');
                if (chatToggle) chatToggle.style.display = 'none';
            } else {
                chatWindow.classList.add('hidden');
                chatWindow.style.setProperty('display', 'none', 'important');
                if (chatToggle) chatToggle.style.display = 'flex';
            }
        }
        
        function addUserMessage(text) {
            const messagesDiv = document.getElementById('chatbot-messages');
            messagesDiv.innerHTML += `
                <div class="flex justify-end">
                    <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-2 rounded-2xl rounded-tr-none max-w-[80%]">
                        ${text}
                    </div>
                </div>
            `;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        function addBotMessage(text) {
            const messagesDiv = document.getElementById('chatbot-messages');
            messagesDiv.innerHTML += `
                <div class="flex justify-start">
                    <div class="bg-white border-2 border-gray-200 px-4 py-2 rounded-2xl rounded-tl-none max-w-[85%]" style="line-height: 1.6;">
                        ${text}
                    </div>
                </div>
            `;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        async function sendMessage(bookingData = null) {
            const input = document.getElementById('chatbot-input');
            const message = bookingData ? '' : input.value.trim();
            if (!message && !bookingData) return;
            
            if (!bookingData) {
                addUserMessage(message);
                input.value = '';
                
                // Check if user wants menu
                if (message.toLowerCase().includes('menu') || message.toLowerCase().includes('help') || message.toLowerCase().includes('options')) {
                    showWelcomeMenu();
                    return;
                }
                
                // Booking is now handled by backend response
            }
            
            try {
                const response = await fetch('/api/chatbot', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(bookingData ? { booking: bookingData } : { message: message })
                });
                const data = await response.json();
                console.log('Chatbot response:', data);
                if (data.response === 'SHOW_BOOKING_FORM') {
                    console.log('Showing booking form');
                    addBotMessage('📅 <strong>Great! Let me help you book a consultation.</strong><br><br>Please fill in the details below:');
                    showBookingForm();
                } else {
                    console.log('Showing normal response:', data.response);
                    addBotMessage(data.response || 'Sorry, I couldn\'t understand that.');
                }
            } catch (error) {
                addBotMessage('Sorry, I\'m having trouble connecting. Please try again.');
            }
        }
        
        function showBookingForm() {
            console.log('showBookingForm function called');
            const today = new Date().toISOString().split('T')[0];
            console.log('Max date for DOB:', today);
            addBotMessage(`
                <div class="booking-form-container">
                    <strong>📅 Book Your Consultation</strong><br><br>
                    <form id="chatbot-booking-form" class="space-y-3">
                        <input type="text" id="booking-name" placeholder="Your Name *" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                        <input type="email" id="booking-email" placeholder="Email (Optional)" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                        <input type="tel" id="booking-phone" placeholder="Phone Number (10 digits) *" required pattern="[6-9][0-9]{9}" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                        <div>
                            <label style="display: block; font-size: 14px; color: #333; margin-bottom: 4px; font-weight: 500;">Date of Birth *</label>
                            <input type="date" id="booking-dob" required max="${today}" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; color: #333; margin-bottom: 4px; font-weight: 500;">Select Service *</label>
                            <select id="booking-service" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                                <option value="">Choose a service...</option>
                                <option value="Kundali Analysis">🔮 Kundali Analysis</option>
                                <option value="Tarot Reading">🎴 Tarot Reading</option>
                                <option value="Career Guidance">💼 Career Guidance</option>
                                <option value="Love & Relationships">💑 Love & Relationships</option>
                                <option value="Financial Consultation">💰 Financial Consultation</option>
                                <option value="Vastu Consultation">🏠 Vastu Consultation</option>
                                <option value="Gemstone Recommendation">💎 Gemstone Recommendation</option>
                                <option value="Muhurat Selection">📅 Muhurat Selection</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; color: #333; margin-bottom: 4px; font-weight: 500;">Message (Optional)</label>
                            <textarea id="booking-message" placeholder="Tell us about your concerns or questions..." class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" rows="3" style="color: #333; font-size: 14px;"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-2 rounded-lg font-bold hover:shadow-lg transition">
                            📤 Submit Booking
                        </button>
                    </form>
                </div>
            `);
            
            // Add form submit handler
            setTimeout(() => {
                const form = document.getElementById('chatbot-booking-form');
                form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    // Validation
                    const name = document.getElementById('booking-name').value.trim();
                    const email = document.getElementById('booking-email').value.trim();
                    const phone = document.getElementById('booking-phone').value.trim();
                    const dob = document.getElementById('booking-dob').value;
                    const service = document.getElementById('booking-service').value;
                    
                    // Name validation - at least 2 letters, only letters and spaces
                    if (!/^[A-Za-z\s]{2,}$/.test(name)) {
                        addBotMessage('❌ Please enter a valid name (at least 2 letters, only alphabets)');
                        return;
                    }
                    
                    // Email validation (if provided)
                    if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                        addBotMessage('❌ Please enter a valid email address');
                        return;
                    }
                    
                    // Phone validation - 10 digits starting with 6/7/8/9
                    if (!/^[6-9]\d{9}$/.test(phone)) {
                        addBotMessage('❌ Please enter a valid 10-digit phone number starting with 6, 7, 8, or 9');
                        return;
                    }
                    
                    // DOB validation
                    const dobDate = new Date(dob);
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    if (dobDate >= today) {
                        addBotMessage('❌ Date of birth cannot be today or in the future');
                        return;
                    }
                    
                    const age = Math.floor((today - dobDate) / (365.25 * 24 * 60 * 60 * 1000));
                    if (age < 5 || age > 120) {
                        addBotMessage('❌ Please enter a valid date of birth (age between 5 and 120 years)');
                        return;
                    }
                    
                    const bookingData = {
                        name: name,
                        email: email || null,
                        phone: phone,
                        dob: dob,
                        service: service,
                        subject: service,
                        message: document.getElementById('booking-message').value.trim() || null
                    };
                    
                    // Show loading message
                    addBotMessage('⏳ <strong>Processing your booking...</strong>');
                    
                    try {
                        // Submit booking to API
                        const response = await fetch('/api/bookings', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(bookingData)
                        });
                        
                        const result = await response.json();
                        
                        if (response.ok && result) {
                            // Remove the entire booking form message from chat
                            const messages = document.getElementById('chatbot-messages');
                            const formMessages = messages.querySelectorAll('.booking-form-container');
                            formMessages.forEach(msg => {
                                const parentDiv = msg.closest('.flex');
                                if (parentDiv) parentDiv.remove();
                            });
                            
                            // Show success message with contact options
                            addBotMessage(`✅ <strong>Booking Confirmed!</strong><br><br>
Thank you <strong>${name}</strong> for booking <strong>${service}</strong>!<br><br>
📋 <strong>Booking Details:</strong><br>
• Name: ${name}<br>
• Phone: ${phone}<br>
• Service: ${service}<br>
• DOB: ${dob}<br>
${bookingData.message ? '• Question: ' + bookingData.message + '<br>' : ''}
<br><em>Booking ID: #${result.id}</em><br><br>
📱 <strong>Contact Us Directly:</strong><br>
<div style="display: flex; gap: 10px; flex-wrap: wrap; margin: 15px 0;">
    <a href="https://wa.me/${(globalBusinessInfo?.whatsapp_number || globalBusinessInfo?.phone || '918431729319').replace(/\\D/g, '')}?text=Hi!%20I%20just%20booked%20(ID:%20${result.id})%20for%20${encodeURIComponent(service)}" target="_blank" style="background: #25D366; color: white; padding: 10px 15px; border-radius: 20px; text-decoration: none; display: inline-flex; align-items: center; font-weight: bold; gap: 5px;">
        <i class="fab fa-whatsapp"></i> WhatsApp
    </a>
    <a href="mailto:${globalBusinessInfo?.email || 'omkargouda1204@gmail.com'}?subject=Booking%20Confirmation%20${result.id}&body=Hi,%20I%20booked%20${encodeURIComponent(service)}%20consultation." style="background: #EA4335; color: white; padding: 10px 15px; border-radius: 20px; text-decoration: none; display: inline-flex; align-items: center; font-weight: bold; gap: 5px;">
        <i class="fas fa-envelope"></i> Email
    </a>
</div>
<br>🙏 <strong>What's next?</strong><br>
• We'll contact you within 2 hours<br>
• Or use buttons above to reach us now!<br>
• Prepare your birth details<br><br>
💬 <strong>Need anything else?</strong> Just ask!`);
                            
                            // Reset review flag
                            reviewTimerSet = false;
                        } else {
                            const waNum = (globalBusinessInfo?.whatsapp_number || globalBusinessInfo?.phone || '918431729319').replace(/\D/g, '');
                            const greeting = encodeURIComponent('Hello! I tried booking but encountered an issue. Can you help?');
                            addBotMessage(`❌ <strong>Booking failed</strong><br><br>${result.error || 'Please try again or contact us directly.'}<br><br>
<a href="https://wa.me/${waNum}?text=${greeting}" target="_blank" style="color: #7C3AED; font-weight: bold;">
💬 Contact us on WhatsApp instead
</a>`);
                        }
                    } catch (error) {
                        console.error('Booking error:', error);
                        const waNum = (globalBusinessInfo?.whatsapp_number || globalBusinessInfo?.phone || '918431729319').replace(/\D/g, '');
                        const greeting = encodeURIComponent('Hello! I encountered an error while booking. Please assist me.');
                        addBotMessage(`❌ <strong>Booking failed. Please try again or contact us directly.</strong><br><br><a href="https://wa.me/${waNum}?text=${greeting}" target="_blank" style="color: #7C3AED; font-weight: bold;">💬 WhatsApp Us</a>`);
                    }
                });
            }, 100);
        }
        
        function showWelcomeMenu() {
            addBotMessage(`
                <div class="welcome-menu">
                    <strong style="font-size: 18px;">🙏 Namaste! Welcome to Cosmic Astrology</strong><br><br>
                    <p style="color: #666; margin-bottom: 15px;">I'm here to assist you. Click any option below:</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px;">
                        <button onclick="sendMenuOption('services')" class="menu-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            🌟 Services
                        </button>
                        <button onclick="sendMenuOption('book')" class="menu-btn" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            📅 Book Now
                        </button>
                        <button onclick="sendMenuOption('hours')" class="menu-btn" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            ⏰ Hours
                        </button>
                        <button onclick="sendMenuOption('location')" class="menu-btn" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            📍 Location
                        </button>
                        <button onclick="sendMenuOption('contact')" class="menu-btn" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            📞 Contact
                        </button>
                        <button onclick="sendMenuOption('social')" class="menu-btn" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            📱 Social
                        </button>
                        <button onclick="sendMenuOption('qa')" class="menu-btn" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #333; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            ❓ FAQ
                        </button>
                    </div>
                    
                    <p style="margin-top: 15px; color: #888; font-size: 12px;"><em>Or type your question directly!</em></p>
                </div>
            `);
        }
        
        function sendMenuOption(option) {
            const displayText = option.charAt(0).toUpperCase() + option.slice(1);
            addUserMessage(displayText);
            
            // Send to backend without triggering sendMessage() again
            fetch('/api/chatbot', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message: option })
            })
            .then(response => response.json())
            .then(data => {
                if (data.response === 'SHOW_BOOKING_FORM') {
                    console.log('Showing booking form from menu');
                    addBotMessage('📅 <strong>Great! Let me help you book a consultation.</strong><br><br>Please fill in the details below:');
                    showBookingForm();
                } else if (data.response) {
                    addBotMessage(data.response);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                addBotMessage('Sorry, I encountered an error. Please try again.');
            });
            
            // Clear input
            document.getElementById('chatbot-input').value = '';
        }
        
        function contactViaWhatsApp() {
            // Use global business info for WhatsApp number
            const whatsappNumber = globalBusinessInfo?.whatsapp_number || globalBusinessInfo?.phone || '918431729319';
            const whatsappNum = whatsappNumber.replace(/\D/g, '');
            const message = encodeURIComponent('Hello! 👋 I\'m interested in astrology consultation. Can you please guide me?');
            window.open(`https://wa.me/${whatsappNum}?text=${message}`, '_blank');
        }
        
        function contactViaCall() {
            const phoneNumber = globalBusinessInfo?.phone || '+918431729319';
            window.location.href = `tel:${phoneNumber}`;
        }
    </script>
    
       
    <!-- Image Lazy Loading and Performance Optimization -->
    <script>
        // Enhanced lazy loading and optimization for all images
        document.addEventListener('DOMContentLoaded', function() {
            // Optimize all images for fast loading
            document.querySelectorAll('img').forEach(img => {
                // Don't apply lazy loading to hero slider images
                const isHeroImage = img.closest('#hero-slider, .hero-slide, .hero-slides-container');
                const isLogoImage = img.id === 'navbar-logo' || img.closest('header');
                
                if (!isHeroImage && !isLogoImage) {
                    if (!img.hasAttribute('loading')) {
                        img.setAttribute('loading', 'lazy');
                    }
                } else {
                    // Critical images load eagerly
                    img.setAttribute('loading', 'eager');
                }
                
                // Always set async decoding for better performance
                if (!img.hasAttribute('decoding')) {
                    img.setAttribute('decoding', 'async');
                }
                
                // Add loaded class when image loads
                if (img.complete) {
                    img.classList.add('loaded');
                } else {
                    img.addEventListener('load', function() {
                        this.classList.add('loaded');
                    });
                }
            });
            
            // Intersection Observer for lazy loading fallback
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            if (img.dataset.src) {
                                img.src = img.dataset.src;
                                img.removeAttribute('data-src');
                            }
                            img.classList.add('loaded');
                            observer.unobserve(img);
                        }
                    });
                }, {
                    rootMargin: '50px 0px',
                    threshold: 0.01
                });
                
                document.querySelectorAll('img[loading="lazy"]').forEach(img => {
                    imageObserver.observe(img);
                });
            }
        });

        // Preload critical images
        function preloadCriticalImage(src) {
            if (!src) return;
            const link = document.createElement('link');
            link.rel = 'preload';
            link.as = 'image';
            link.href = src;
            link.fetchpriority = 'high';
            document.head.appendChild(link);
        }

          </script>

    
    
    
</body>
</html>
