<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Astrology | Your Path to Clarity</title>
    
    <!-- Fonts - Load First for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.15.4/css/all.css">
    
    <!-- Critical Base Styles -->
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            background: #f9fafb;
            overflow-x: hidden;
        }
        img { max-width: 100%; height: auto; display: block; }
        .goog-te-banner-frame { display: none !important; }
        body { top: 0 !important; }
        .hero-slide { 
            opacity: 0; 
            visibility: hidden; 
            transition: opacity 0.8s ease-in-out;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .hero-slide.active { 
            opacity: 1 !important; 
            visibility: visible !important; 
            z-index: 2 !important; 
        }
        
        /* Enhanced animations and responsive design */
        .animate-bounce-in {
            animation: bounceIn 0.8s ease-out;
        }
        @keyframes bounceIn {
            0% { transform: scale(0.3) translateY(50px); opacity: 0; }
            50% { transform: scale(1.05) translateY(-10px); opacity: 0.8; }
            70% { transform: scale(0.9) translateY(5px); opacity: 0.9; }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }
        
        /* Enhanced service cards with better hover effects */
        .service-card {
            transform: translateY(30px) scale(0.9);
            transition: all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
            backdrop-filter: blur(15px);
            background: rgba(255, 255, 255, 0.95);
        }
        
        .service-card:hover {
            transform: translateY(-20px) scale(1.08);
            box-shadow: 0 35px 70px rgba(124, 58, 237, 0.25), 0 15px 35px rgba(236, 72, 153, 0.15);
        }
        
        .shadow-3xl {
            box-shadow: 0 35px 70px rgba(0, 0, 0, 0.2);
        }
        
        /* Line clamp utility for descriptions */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Responsive Hero Slider */
        @media (max-width: 768px) {
            #hero-slider { height: 60vh !important; min-height: 400px !important; }
            .hero-slide h1 { font-size: 2rem !important; }
            .hero-slide p { font-size: 1rem !important; }
            
            /* Mobile service cards */
            .service-card {
                padding: 1rem !important;
                transform: translateY(10px) scale(0.95);
            }
            
            .service-card h3 {
                font-size: 0.875rem !important;
                line-height: 1.3 !important;
            }
            
            #astrological-services-grid {
                gap: 0.75rem !important;
                padding: 0 0.5rem;
            }
        }
        
        /* Tablet responsive design */
        @media (min-width: 768px) and (max-width: 1023px) {
            #astrological-services-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 1.5rem;
            }
            
            .service-card h3 {
                font-size: 1.125rem !important;
            }
        }
        
        /* Desktop responsive design */
        @media (min-width: 1024px) {
            .service-card {
                padding: 2rem !important;
            }
            
            .service-card:hover {
                transform: translateY(-20px) scale(1.1);
            }
            
            #astrological-services-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 2rem;
                max-width: 1400px;
            }
        }
        
        /* Large desktop */
        @media (min-width: 1440px) {
            #astrological-services-grid {
                grid-template-columns: repeat(5, 1fr);
                gap: 2.5rem;
            }
        }
        
        /* Extra large screens */
        @media (min-width: 1920px) {
            #astrological-services-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 3rem;
            }
        }
        
        /* Logo styles - Display directly without round shape */
        .logo-container img, .navbar-logo {
            border-radius: 0 !important;
            object-fit: contain !important;
            border: none !important;
            transition: all 0.3s ease !important;
        }
        
        .logo-container img:hover, .navbar-logo:hover {
            transform: scale(1.05) !important;
            box-shadow: none !important;
        }

        /* ============================================
           COMPREHENSIVE RESPONSIVE DESIGN STYLES
           ============================================ */

        /* Extra Small Devices (Mobile - 320px to 480px) */
        @media (max-width: 480px) {
            .navbar-logo {
                max-width: 120px !important;
                height: auto !important;
            }
            
            .website-name {
                font-size: 16px !important;
            }
            
            .website-tagline {
                font-size: 11px !important;
            }
            
            h1 {
                font-size: 20px !important;
            }
            
            h2 {
                font-size: 18px !important;
            }
            
            h3 {
                font-size: 16px !important;
            }
            
            .text-base {
                font-size: 12px !important;
            }
            
            button {
                padding: 8px 12px !important;
                font-size: 12px !important;
            }
            
            .p-4 {
                padding: 12px !important;
            }
            
            .px-6 {
                padding-left: 12px !important;
                padding-right: 12px !important;
            }
        }

        /* Small Devices (Mobile - 481px to 768px) */
        @media (max-width: 768px) {
            .navbar-logo {
                max-width: 140px !important;
                height: auto !important;
            }
            
            .website-name {
                font-size: 18px !important;
            }
            
            .website-tagline {
                font-size: 12px !important;
            }
            
            h1 {
                font-size: 24px !important;
            }
            
            h2 {
                font-size: 20px !important;
            }
            
            h3 {
                font-size: 18px !important;
            }
            
            .text-lg {
                font-size: 14px !important;
            }
            
            button {
                padding: 10px 14px !important;
                font-size: 13px !important;
            }
            
            .px-8 {
                padding-left: 16px !important;
                padding-right: 16px !important;
            }
        }

        /* Medium Devices (Tablet - 769px to 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .navbar-logo {
                max-width: 180px !important;
                height: auto !important;
            }
            
            h1 {
                font-size: 28px !important;
            }
            
            h2 {
                font-size: 22px !important;
            }
            
            h3 {
                font-size: 19px !important;
            }
        }

        /* Large Devices (Desktop - 1025px+) */
        @media (min-width: 1025px) {
            .navbar-logo {
                max-width: 250px !important;
                height: auto !important;
            }
        }
        
        /* Fade In Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        
        .slide-in-left {
            animation: slideInLeft 0.8s ease-out forwards;
        }
        
        .slide-in-right {
            animation: slideInRight 0.8s ease-out forwards;
        }
        
        .scale-in {
            animation: scaleIn 0.6s ease-out forwards;
        }
        
        /* Hover Effects */
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Image Zoom Effect */
        .image-zoom {
            overflow: hidden;
        }
        
        .image-zoom img {
            transition: transform 0.5s ease;
        }
        
        .image-zoom:hover img {
            transform: scale(1.1);
        }
        
        /* Smooth Transitions */
        * {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Service Card Enhancement */
        .service-card {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(147, 51, 234, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .service-card:hover::before {
            left: 100%;
        }
        
        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(147, 51, 234, 0.2);
        }
        
        /* Button Hover Effects */
        .btn-hover {
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .btn-hover::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
            z-index: -1;
        }
        
        .btn-hover:hover::before {
            width: 300px;
            height: 300px;
        }
        
        /* Responsive Utilities */
        @media (max-width: 640px) {
            .container { padding-left: 1rem; padding-right: 1rem; }
            h1 { font-size: 2rem !important; }
            h2 { font-size: 1.75rem !important; }
            h3 { font-size: 1.25rem !important; }
        }
        
        @media (max-width: 480px) {
            #hero-slider { height: 50vh !important; min-height: 350px !important; }
            .hero-slide h1 { font-size: 1.5rem !important; }
            .hero-slide p { font-size: 0.875rem !important; }
            
            /* Enhanced mobile hero slider buttons */
            #prev-slide, #next-slide {
                min-width: 48px !important;
                min-height: 48px !important;
                padding: 12px !important;
                margin: 8px !important;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
            }
            
            #prev-slide {
                left: 4px !important;
            }
            
            #next-slide {
                right: 4px !important;
            }
        }
        
        /* Touch interaction improvements */
        .touch-manipulation {
            touch-action: manipulation;
            -webkit-tap-highlight-color: rgba(0,0,0,0.1);
        }
        
        /* Hero slider button enhancements */
        #prev-slide:active, #next-slide:active {
            transform: translate(-50%, -50%) scale(0.95);
        }
        
        @media (hover: none) and (pointer: coarse) {
            /* Mobile/touch devices */
            #prev-slide, #next-slide {
                background-opacity: 0.8 !important;
            }
        }
        
        /* Scroll Animation Classes */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .slide-in-left {
            opacity: 0;
            transform: translateX(-50px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .slide-in-left.visible {
            opacity: 1;
            transform: translateX(0);
        }
        .slide-in-right {
            opacity: 0;
            transform: translateX(50px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .slide-in-right.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        /* Service Card Hover Animation */
        .service-card {
            transition: all 0.3s ease;
        }
        .service-card:hover {
            transform: translateY(-10px);
        }
        
        /* Pooja Circle Glow Effect */
        .pooja-circle {
            position: relative;
            transition: all 0.3s ease;
        }
        .pooja-circle::before {
            content: '';
            position: absolute;
            inset: -5px;
            border-radius: 50%;
            background: linear-gradient(45deg, #f59e0b, #ef4444);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
            filter: blur(15px);
        }
        .pooja-circle:hover::before {
            opacity: 0.6;
        }
        .pooja-circle:hover {
            transform: scale(1.05);
        }
    </style>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/styles/main.css">
    <script type="text/javascript">
        function googleTranslateElementInit() {
            try {
                // Wait for the element to be ready
                const initTranslate = () => {
                    // Desktop translate element
                    if (document.getElementById('google_translate_element')) {
                        new google.translate.TranslateElement({
                            pageLanguage: 'en',
                            includedLanguages: 'en,hi,kn,mr,ta,te,gu,ml,pa,bn,or,as,ur,sa',
                            layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                            autoDisplay: false
                        }, 'google_translate_element');
                    }
                    
                    // Mobile translate element (if exists)
                    if (document.getElementById('google_translate_element_mobile')) {
                        new google.translate.TranslateElement({
                            pageLanguage: 'en',
                            includedLanguages: 'en,hi,kn,mr,ta,te,gu,ml,pa,bn,or,as,ur,sa',
                            layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                            autoDisplay: false
                        }, 'google_translate_element_mobile');
                    }
                };

                // Initialize immediately if DOM is ready
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', initTranslate);
                } else {
                    initTranslate();
                }
            } catch (error) {
                console.error('Google Translate initialization error:', error);
                // Retry after a short delay
                setTimeout(() => {
                    try {
                        initTranslate();
                    } catch (retryError) {
                        console.error('Google Translate retry failed:', retryError);
                    }
                }, 1000);
            }
        }
    </script>
    
    <!-- Custom Styles for Google Translate and Navbar -->
    <style>
        /* Enhanced Google Translate Styling */
        .goog-te-banner-frame { 
            display: none !important; 
        }
        
        .goog-te-menu-value { 
            padding: 8px !important; 
            margin: 0 !important;
        }
        
        .goog-te-gadget-simple { 
            background-color: transparent !important; 
            border: none !important; 
            font-size: 14px !important;
            padding: 8px !important;
            width: 100% !important;
        }
        
        .goog-te-combo { 
            background-color: rgba(255, 255, 255, 0.95) !important; 
            border: 2px solid rgba(139, 69, 19, 0.2) !important; 
            border-radius: 8px !important; 
            padding: 8px 12px !important;
            font-size: 14px !important;
            color: #6B46C1 !important;
            font-weight: 600 !important;
            backdrop-filter: blur(8px);
            min-width: 140px !important;
            height: auto !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1) !important;
            transition: all 0.3s ease !important;
        }
        .goog-te-combo:hover {
            background-color: white !important;
            border-color: #6B46C1 !important;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15) !important;
            transform: translateY(-1px);
        }
        
        .goog-te-combo:focus {
            outline: none !important;
            border-color: #6B46C1 !important;
            box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.2) !important;
        }
        
        /* Language dropdown improvements */
        #lang-dropdown {
            z-index: 9999 !important;
            position: absolute !important;
            right: 0 !important;
            top: 100% !important;
            margin-top: 8px !important;
        }
        
        #lang-dropdown.hidden {
            display: none !important;
        }
        
        /* Translate elements in navbar */
        .translate-element .goog-te-gadget-simple {
            background: transparent !important;
            border: none !important;
        }
        .translate-element-mobile .goog-te-gadget-simple {
            background: transparent !important;
            border: none !important;
        }
        
        /* Remove Google Translate top bar */
        body { top: 0 !important; }
        
        /* Navbar Animation */
        .nav-link:hover { transform: translateY(-1px); }
        
        /* Mobile Menu Animation */
        #mobile-menu { 
            transition: all 0.3s ease; 
        }
        
        /* Custom scrollbar for mobile menu */
        #mobile-menu::-webkit-scrollbar { width: 4px; }
        #mobile-menu::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        #mobile-menu::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 2px; }
    </style>


    <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit">
        // Language translation function
        function changeLanguage(langCode, langName) {
            console.log('Changing language to:', langCode, langName);
            
            // Try to find the translate element
            var attempts = 0;
            var maxAttempts = 50;
            
            var waitForGoogleTranslate = setInterval(function() {
                attempts++;
                var translateElement = document.querySelector('.goog-te-combo');
                
                if (translateElement) {
                    console.log('Found translate element, changing to:', langCode);
                    clearInterval(waitForGoogleTranslate);
                    
                    // Set the language value
                    translateElement.value = langCode;
                    
                    // Trigger the change event
                    var event = new Event('change', { bubbles: true });
                    translateElement.dispatchEvent(event);
                    
                    // Also try click event as backup
                    setTimeout(function() {
                        translateElement.dispatchEvent(new Event('click'));
                    }, 100);
                    
                    // Update UI
                    var currentLangElement = document.getElementById('current-language');
                    if (currentLangElement) {
                        currentLangElement.textContent = langName;
                    }
                    
                    // Close dropdown
                    var dropdown = document.getElementById('language-dropdown');
                    if (dropdown) {
                        dropdown.classList.add('hidden');
                    }
                    
                    console.log('Language changed successfully!');
                } else if (attempts >= maxAttempts) {
                    clearInterval(waitForGoogleTranslate);
                    console.error('Google Translate element not found after', maxAttempts, 'attempts');
                    alert('Translation not ready yet. Please wait a moment and try again.');
                }
            }, 100);
        }

        // Mobile menu toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');

            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function() {
                    mobileMenu.classList.toggle('hidden');
                    const icon = this.querySelector('i');
                    if (mobileMenu.classList.contains('hidden')) {
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    } else {
                        icon.classList.remove('fa-bars');
                        icon.classList.add('fa-times');
                    }
                });
            }

            // Close mobile menu when clicking on links
            document.querySelectorAll('.mobile-nav-link').forEach(link => {
                link.addEventListener('click', function() {
                    mobileMenu.classList.add('hidden');
                    const menuBtn = document.getElementById('mobile-menu-btn');
                    const icon = menuBtn.querySelector('i');
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                });
            });
        });</script>
</head>
<body class="font-sans bg-gray-50">

    <!-- Clean Header Section (Yenepoya Style) -->
    <header class="bg-white border-b-2 border-gray-200 shadow-md">
        <div class="container mx-auto px-4 py-5 md:py-6">
            <div class="flex items-center justify-between md:justify-start md:space-x-8">
                <!-- Logo - Direct Display (No Round Shape, No Fallback Icon) -->
                <div class="flex-shrink-0 logo-container">
                    <img id="navbar-logo" src="" alt="Logo" class="h-20 w-auto sm:h-24 md:h-28 lg:h-32 xl:h-36 object-contain transition-transform duration-300 hover:scale-105" style="max-width: 250px;">
                </div>
                
                <!-- Website Name & Tagline - Fully Responsive -->
                <div class="flex-1 min-w-0 px-2 sm:px-4 website-name-container">
                    <h1 id="website-name" class="text-lg sm:text-2xl md:text-3xl lg:text-4xl xl:text-5xl font-bold text-gray-800 tracking-wide leading-tight break-words animate-fade-in">
                        Om Sri Mahakali Bhairavi Jyotishya Shastram
                    </h1>
                    <p id="website-subtitle" class="text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl text-gray-600 mt-1 md:mt-2 font-medium break-words animate-fade-in-delay">
                        Specialized Astrology & Pooja Services
                    </p>
                </div>
                
                <!-- Mobile Menu Toggle -->
                <button id="mobile-menu-btn" class="lg:hidden p-3 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors">
                    <i class="fas fa-bars text-3xl"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Navigation Bar (Blue/Purple Theme) - Increased Height -->
    <nav id="main-navbar" class="bg-gradient-to-r from-purple-700 via-purple-600 to-indigo-700 text-white sticky top-0 z-50 shadow-2xl">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between h-16 md:h-20 lg:h-24">
                
                <!-- Desktop Menu -->
                <div id="desktop-menu" class="hidden lg:flex items-center space-x-4 flex-1">
                    <!-- Menu items will be dynamically loaded -->
                </div>
                
                <!-- Language Selector -->
                <div class="hidden lg:block relative">
                    <button id="lang-dropdown-btn" class="flex items-center space-x-2 px-4 py-3 rounded-lg hover:bg-white hover:bg-opacity-20 transition-all duration-300 text-base md:text-lg font-medium">
                        <i class="fas fa-globe text-xl"></i>
                        <span>EN</span>
                        <i class="fas fa-chevron-down text-sm"></i>
                    </button>
                    <div id="lang-dropdown" class="hidden absolute right-4 mt-2 w-48 bg-white rounded-lg shadow-xl border overflow-hidden">
                        <div id="google_translate_element" class="p-2"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Mobile Navigation Menu -->
        <div id="mobile-menu" class="lg:hidden hidden bg-purple-800">
            <div class="container mx-auto px-4 py-3">
                <!-- Website name in mobile menu -->
                <div class="border-b border-purple-600 pb-3 mb-3">
                    <h2 class="text-lg font-bold">COSMIC ASTROLOGY</h2>
                    <p class="text-xs text-purple-200">Specialized Astrology & Pooja Services</p>
                </div>
                
                <!-- Mobile menu items will be dynamically loaded -->
                <div id="mobile-menu-items" class="space-y-1"></div>
                
                <!-- Language in mobile -->
                <div class="mt-3 pt-3 border-t border-purple-600">
                    <button onclick="document.getElementById('lang-dropdown').classList.toggle('hidden')" class="w-full text-left px-3 py-2 rounded hover:bg-purple-700">
                        <i class="fas fa-globe mr-2"></i>Language: EN
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Announcement Bar (Clean style like Yenepoya) -->
    <div id="announcement-bar" class="bg-gradient-to-r from-red-500 to-orange-500 text-white overflow-hidden" style="display: none;">
        <div class="announcement-ticker py-2">
            <div id="announcement-content" class="flex items-center space-x-8 whitespace-nowrap animate-scroll">
                <!-- Announcements will be dynamically loaded -->
            </div>
        </div>
    </div>

    <style>
        /* Announcement ticker animation */
        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        .animate-scroll {
            animation: scroll 30s linear infinite;
        }
        .announcement-ticker:hover .animate-scroll {
            animation-play-state: paused;
        }
    </style>
    
    <!-- Hero Slider Section -->
    <section class="relative overflow-hidden" id="hero-slider" style="height: calc(100vh - 120px); margin-top: 0; min-height: 400px;">
        <div class="hero-slides-container relative h-full" style="position: relative; width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <!-- Slides will be loaded from API -->
        </div>
        <button id="prev-slide" class="absolute left-1 sm:left-2 md:left-4 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-60 hover:bg-opacity-80 active:bg-opacity-90 rounded-full p-3 sm:p-4 md:p-3 shadow-lg transition-all duration-200 touch-manipulation" style="z-index: 20; min-width: 44px; min-height: 44px;">
            <i class="fas fa-chevron-left text-purple-700 text-sm sm:text-base md:text-lg"></i>
        </button>
        <button id="next-slide" class="absolute right-1 sm:right-2 md:right-4 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-60 hover:bg-opacity-80 active:bg-opacity-90 rounded-full p-3 sm:p-4 md:p-3 shadow-lg transition-all duration-200 touch-manipulation" style="z-index: 20; min-width: 44px; min-height: 44px;">
            <i class="fas fa-chevron-right text-purple-700 text-sm sm:text-base md:text-lg"></i>
        </button>
    </section>

    <!-- Section 1: Astrological Services -->
    <section id="services" class="py-20 bg-gradient-to-br from-white to-purple-50">
        <div class="container mx-auto px-4">
            <!-- Section Header -->
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4 font-serif">
                    Astrological Services
                </h2>
                <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                    Discover ancient wisdom through our comprehensive astrological services
                </p>
                <div class="w-24 h-1 bg-gradient-to-r from-purple-600 to-pink-600 mx-auto mt-6 rounded-full"></div>
            </div>
            
            <!-- Services Grid - 5 Columns in 1 Row (Responsive) -->
            <div id="astrological-services-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 sm:gap-6 md:gap-8 max-w-7xl mx-auto">
                <!-- Services will be dynamically loaded -->
            </div>
        </div>
    </section>

     <!-- Gallery Section -->
    <section id="gallery" class="py-16 bg-gradient-to-r from-purple-100 to-pink-100">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-bold text-center mb-4 font-serif text-purple-800">Our Gallery</h2>
            <p class="text-center text-gray-600 mb-12">Glimpses of cosmic connections</p>
            <div class="relative">
                <!-- Navigation Arrows -->
                <button id="gallery-prev" class="absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white bg-opacity-90 hover:bg-opacity-100 text-purple-800 rounded-full p-3 shadow-lg transition-all duration-300 hover:scale-110" style="margin-left: -20px;">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                </button>
                <button id="gallery-next" class="absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white bg-opacity-90 hover:bg-opacity-100 text-purple-800 rounded-full p-3 shadow-lg transition-all duration-300 hover:scale-110" style="margin-right: -20px;">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
                
                <!-- Horizontal Slider Container -->
                <div class="overflow-hidden">
                    <div id="gallery-slides-container" class="flex transition-transform duration-500 ease-in-out gap-6">
                        <!-- Gallery slides will be loaded from API -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 2: Pooja & Ritual Services -->
    <section id="pooja" class="py-20 bg-gradient-to-br from-amber-50 via-orange-50 to-red-50">
        <div class="container mx-auto px-4">
            <!-- Section Header -->
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4 font-serif">
                    Pooja & Ritual Services
                </h2>
                <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                    Experience divine blessings through traditional poojas performed with devotion
                </p>
                <div class="w-24 h-1 bg-gradient-to-r from-amber-500 to-red-500 mx-auto mt-6 rounded-full"></div>
            </div>
            
            <!-- Pooja Grid (Circular Layout) -->
            <div id="pooja-services-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 sm:gap-6 md:gap-8 lg:gap-10 max-w-6xl mx-auto">
                <!-- Poojas will be dynamically loaded -->
            </div>
        </div>
    </section>

    <!-- Section 3: Expert Solutions -->
    <section id="solutions" class="py-20 bg-white">
        <div class="container mx-auto px-4">
            <!-- Section Header -->
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4 font-serif">
                    Expert Solutions
                </h2>
                <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                    Personalized guidance for life's most challenging situations
                </p>
                <div class="w-24 h-1 bg-gradient-to-r from-purple-600 to-pink-600 mx-auto mt-6 rounded-full"></div>
            </div>
            
            <!-- Solutions Cards -->
            <div id="expert-solutions-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-10 lg:gap-8 xl:gap-10 max-w-7xl mx-auto px-4">
                <!-- Solutions will be dynamically loaded -->
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-12 md:py-16 bg-gradient-to-br from-purple-50 via-pink-50 to-purple-50">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-8 md:mb-12 font-serif text-purple-800">About Our Astrologer</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12 items-center max-w-6xl mx-auto">
                <div class="order-2 md:order-1">
                    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-xl">
                        <h3 id="about-title" class="text-xl md:text-2xl font-bold mb-3 md:mb-4 text-purple-800">Loading...</h3>
                        <p id="about-description" class="text-sm md:text-base text-gray-700 leading-relaxed mb-4 md:mb-6">Loading...</p>
                        <div id="about-details" class="space-y-3">
                            <!-- Details will be loaded from API -->
                        </div>
                    </div>
                </div>
                <div class="order-1 md:order-2">
                    <div class="relative">
                        <div class="absolute inset-0 bg-gradient-to-br from-purple-400 to-pink-400 rounded-2xl md:rounded-3xl transform rotate-3"></div>
                        <img id="about-image" src="" alt="Astrologer" class="relative rounded-2xl md:rounded-3xl shadow-2xl w-full h-auto object-cover" style="min-height: 400px; max-height: 600px;" loading="lazy">
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    
    <!-- Client Reviews Section -->
    <section id="reviews" class="py-16 bg-white scroll-mt-24">
        <div class="container mx-auto px-4">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold font-serif text-purple-800 mb-2">What Our Clients Say</h2>
                <p class="text-gray-600 mb-4">Real testimonials from our satisfied clients</p>
            </div>
            
            <!-- Reviews Carousel Container -->
            <div class="relative overflow-hidden mb-8">
                <div id="reviews-carousel" class="flex transition-transform duration-500 ease-in-out">
                    <!-- Reviews will be loaded dynamically from database -->
                </div>
                
                <!-- Navigation Dots -->
                <div class="flex justify-center mt-6 gap-2" id="review-dots"></div>
            </div>
        </div>
    </section>
    <!-- FAQ Section -->
    <section id="faq" class="py-16 bg-gradient-to-r from-purple-100 to-pink-100">
        <div class="container mx-auto px-4 max-w-6xl">
            <h2 class="text-4xl font-bold text-center mb-4 font-serif text-purple-800">Frequently Asked Questions</h2>
            <p class="text-center text-gray-600 mb-12">Your cosmic queries answered | ನಿಮ್ಮ ಕಾಸ್ಮಿಕ್ ಪ್ರಶ್ನೆಗಳಿಗೆ ಉತ್ತರ</p>
            
            <!-- Language Toggle -->
            <div class="flex justify-center mb-8">
                <div class="bg-white rounded-full p-1 shadow-md">
                    <button onclick="showFAQLang('english')" id="faq-en-btn" class="px-6 py-2 rounded-full font-semibold transition-all bg-purple-600 text-white">
                        English
                    </button>
                    <button onclick="showFAQLang('kannada')" id="faq-kn-btn" class="px-6 py-2 rounded-full font-semibold transition-all text-gray-700 hover:bg-gray-100">
                        ಕನ್ನಡ
                    </button>
                </div>
            </div>
            
            <!-- English FAQs -->
            <div id="faq-english" class="space-y-4">
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        What is astrology and how does it work?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        Astrology is an ancient science that studies the influence of celestial bodies on human affairs and terrestrial events. It analyzes planetary positions at your birth time to provide insights into your personality, relationships, career, and life path.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        How accurate are astrological predictions?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        Accuracy depends on the astrologer's expertise and the precision of birth data. Our experienced practitioners provide highly accurate readings based on Vedic astrology principles with years of study and practice.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        What information do I need for a kundali reading?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        You need your exact date of birth, time of birth (as accurate as possible), and place of birth for an accurate kundali analysis. If birth time is unknown, we can work with date and location for a basic reading.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        How long does a consultation typically take?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        Most consultations last 45-60 minutes, allowing time for detailed analysis, answering your specific questions, and providing remedies or guidance.
                    </div>
                </div>
            </div>
            
            <!-- Kannada FAQs -->
            <div id="faq-kannada" class="space-y-4 hidden">
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        ಜ್ಯೋತಿಷ್ಯ ಎಂದರೇನು ಮತ್ತು ಅದು ಹೇಗೆ ಕೆಲಸ ಮಾಡುತ್ತದೆ?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        ಜ್ಯೋತಿಷ್ಯವು ಮಾನವ ವ್ಯವಹಾರಗಳು ಮತ್ತು ಭೂಮಿಯ ಘಟನೆಗಳ ಮೇಲೆ ಆಕಾಶ ಕಾಯಗಳ ಪ್ರಭಾವವನ್ನು ಅಧ್ಯಯನ ಮಾಡುವ ಪ್ರಾಚೀನ ವಿಜ್ಞಾನವಾಗಿದೆ. ನಿಮ್ಮ ವ್ಯಕ್ತಿತ್ವ, ಸಂಬಂಧಗಳು, ವೃತ್ತಿ ಮತ್ತು ಜೀವನ ಮಾರ್ಗದ ಬಗ್ಗೆ ಒಳನೋಟಗಳನ್ನು ನೀಡಲು ನಿಮ್ಮ ಜನನ ಸಮಯದಲ್ಲಿ ಗ್ರಹಗಳ ಸ್ಥಾನಗಳನ್ನು ವಿಶ್ಲೇಷಿಸುತ್ತದೆ.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        ಜ್ಯೋತಿಷ್ಯ ಭವಿಷ್ಯ ಎಷ್ಟು ನಿಖರವಾಗಿದೆ?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        ನಿಖರತೆಯು ಜ್ಯೋತಿಷಿಯ ಪರಿಣತಿ ಮತ್ತು ಜನನ ದತ್ತಾಂಶದ ನಿಖರತೆಯ ಮೇಲೆ ಅವಲಂಬಿತವಾಗಿದೆ. ನಮ್ಮ ಅನುಭವಿ ವೃತ್ತಿಪರರು ವೇದ ಜ್ಯೋತಿಷ್ಯ ತತ್ವಗಳ ಆಧಾರದ ಮೇಲೆ ಅತ್ಯಂತ ನಿಖರವಾದ ವಾಚನಗಳನ್ನು ಒದಗಿಸುತ್ತಾರೆ.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        ಕುಂಡಲಿ ಓದುವಿಕೆಗೆ ನನಗೆ ಯಾವ ಮಾಹಿತಿ ಬೇಕು?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        ನಿಖರವಾದ ಕುಂಡಲಿ ವಿಶ್ಲೇಷಣೆಗಾಗಿ ನಿಮ್ಮ ನಿಖರ ಜನ್ಮ ದಿನಾಂಕ, ಜನನ ಸಮಯ (ಸಾಧ್ಯವಾದಷ್ಟು ನಿಖರ), ಮತ್ತು ಜನನ ಸ್ಥಳ ಬೇಕು. ಜನನ ಸಮಯ ತಿಳಿದಿಲ್ಲದಿದ್ದರೆ, ಮೂಲಭೂತ ಓದುವಿಕೆಗಾಗಿ ನಾವು ದಿನಾಂಕ ಮತ್ತು ಸ್ಥಳದೊಂದಿಗೆ ಕೆಲಸ ಮಾಡಬಹುದು.
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="faq-question w-full text-left p-4 font-bold text-purple-800 flex justify-between items-center">
                        ಸಮಾಲೋಚನೆ ಸಾಮಾನ್ಯವಾಗಿ ಎಷ್ಟು ಸಮಯ ತೆಗೆದುಕೊಳ್ಳುತ್ತದೆ?
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="faq-answer hidden p-4 text-gray-700">
                        ಹೆಚ್ಚಿನ ಸಮಾಲೋಚನೆಗಳು 45-60 ನಿಮಿಷಗಳ ಕಾಲ ನಡೆಯುತ್ತವೆ, ವಿವರವಾದ ವಿಶ್ಲೇಷಣೆ, ನಿಮ್ಮ ನಿರ್ದಿಷ್ಟ ಪ್ರಶ್ನೆಗಳಿಗೆ ಉತ್ತರಿಸಲು, ಮತ್ತು ಪರಿಹಾರಗಳು ಅಥವಾ ಮಾರ್ಗದರ್ಶನವನ್ನು ನೀಡಲು ಸಮಯ ನೀಡುತ್ತದೆ.
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Footer -->
    <footer class="bg-black text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-2xl font-bold mb-4 font-serif">Cosmic Astrology</h3>
                    <p class="text-gray-300">Your trusted guide to cosmic wisdom and spiritual enlightenment.</p>
                </div>
                <div>
                    <h4 class="text-xl font-bold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="/" class="hover:text-yellow-300 transition">Home</a></li>
                        <li><a href="#services" class="hover:text-yellow-300 transition">Services</a></li>
                        <li><a href="/contact" class="hover:text-yellow-300 transition">Contact</a></li>
                        <li><a href="#reviews" class="hover:text-yellow-300 transition">Reviews</a></li>
                        <li><a href="/privacy" class="hover:text-yellow-300 transition">Privacy Policy</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-xl font-bold mb-4">Contact Us</h4>
                    <div id="footer-contact-info" class="space-y-2">
                        <p><i class="fas fa-phone mr-2"></i><span id="footer-phone">Loading...</span></p>
                        <p><i class="fas fa-envelope mr-2"></i><span id="footer-email">Loading...</span></p>
                        <div id="footer-socials" class="flex space-x-4 mt-4">
                            <!-- Social links loaded from API -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="border-t border-purple-600 mt-8 pt-8 text-center text-purple-200">
                <p>&copy; 2025 Cosmic Astrology. All rights reserved.</p>
                <p class="mt-2 text-sm">
                    Developed by <a href="https://omkargouda.netlify.app/" target="_blank" class="text-yellow-300 hover:text-yellow-400 transition inline-flex items-center gap-1">
                        <i class="fas fa-briefcase"></i>
                        Omkar Gouda
                    </a>
                </p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // Mobile Menu Toggle
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        // FAQ Language Toggle
        function showFAQLang(lang) {
            const enFAQ = document.getElementById('faq-english');
            const knFAQ = document.getElementById('faq-kannada');
            const enBtn = document.getElementById('faq-en-btn');
            const knBtn = document.getElementById('faq-kn-btn');
            
            if (lang === 'english') {
                enFAQ.classList.remove('hidden');
                knFAQ.classList.add('hidden');
                enBtn.classList.add('bg-purple-600', 'text-white');
                enBtn.classList.remove('text-gray-700', 'hover:bg-gray-100');
                knBtn.classList.remove('bg-purple-600', 'text-white');
                knBtn.classList.add('text-gray-700', 'hover:bg-gray-100');
            } else {
                knFAQ.classList.remove('hidden');
                enFAQ.classList.add('hidden');
                knBtn.classList.add('bg-purple-600', 'text-white');
                knBtn.classList.remove('text-gray-700', 'hover:bg-gray-100');
                enBtn.classList.remove('bg-purple-600', 'text-white');
                enBtn.classList.add('text-gray-700', 'hover:bg-gray-100');
            }
        }
        
        // Make function globally available
        window.showFAQLang = showFAQLang;
        
        // FAQ Accordion
        document.querySelectorAll('.faq-question').forEach(button => {
            button.addEventListener('click', function() {
                const answer = this.nextElementSibling;
                const icon = this.querySelector('i');
                answer.classList.toggle('hidden');
                icon.classList.toggle('fa-chevron-down');
                icon.classList.toggle('fa-chevron-up');
            });
        });

        // ========================================
        // NAVBAR & ANNOUNCEMENT BAR FUNCTIONALITY
        // ========================================
        
        // Load navbar settings - ONLY from navbar_settings table
        async function loadNavbar() {
            try {
                // Load ONLY from navbar_settings table
                const settingsResponse = await fetch('/api/navbar-settings');
                if (settingsResponse.ok) {
                    const settings = await settingsResponse.json();
                    console.log('Loading navbar from navbar_settings:', settings);
                    
                    // Enhanced logo loading with responsive sizing
                    if (settings.logo_url) {
                        console.log('Loading logo from:', settings.logo_url);
                        
                        const logoEl = document.getElementById('navbar-logo');
                        if (logoEl) {
                            logoEl.src = settings.logo_url; // Background already removed during upload
                            logoEl.className = 'h-20 w-auto sm:h-24 md:h-28 lg:h-32 xl:h-36 object-contain transition-transform duration-300 hover:scale-105';
                            logoEl.style.display = 'block';
                            logoEl.style.maxWidth = '250px';
                            logoEl.style.background = 'transparent';
                        }
                        
                        // Also update mobile logo if exists
                        const mobileLogoEl = document.getElementById('mobile-navbar-logo');
                        if (mobileLogoEl) {
                            mobileLogoEl.src = settings.logo_url;
                            mobileLogoEl.className = 'h-16 w-auto object-contain';
                        }
                    }
                    
                    // Update website name and make it responsive
                    if (settings.name) {
                        const nameEl = document.getElementById('website-name');
                        if (nameEl) {
                            nameEl.textContent = settings.name;
                            nameEl.classList.add('animate-fade-in');
                        }
                    }
                    
                    // Update website subtitle and make it responsive - FIX for Website Subtitle 1 (Main)
                    if (settings.subtitle1) {
                        const subtitleEl = document.getElementById('website-subtitle');
                        if (subtitleEl) {
                            subtitleEl.textContent = settings.subtitle1;
                            subtitleEl.classList.add('animate-fade-in-delay');
                            subtitleEl.classList.remove('hidden');
                        }
                    }
                    
                    // Update additional subtitles if they exist
                    if (settings.subtitle2) {
                        const subtitle2El = document.getElementById('website-subtitle2');
                        if (subtitle2El) {
                            subtitle2El.textContent = settings.subtitle2;
                            subtitle2El.classList.remove('hidden');
                        }
                    }
                    
                    if (settings.subtitle3) {
                        const subtitle3El = document.getElementById('website-subtitle3');
                        if (subtitle3El) {
                            subtitle3El.textContent = settings.subtitle3;
                            subtitle3El.classList.remove('hidden');
                        }
                    }
                    
                    // Apply navbar colors and layout from navbar_settings
                    if (settings.primary_color && settings.secondary_color) {
                        updateNavbarColors(settings.primary_color, settings.secondary_color, settings.navbar_style);
                    }
                    
                    // Apply navbar layout settings
                    applyNavbarLayout(settings);
                    
                    // Apply service section backgrounds that move with the section
                    if (settings.astrological_services_bg_url) {
                        const astroSection = document.getElementById('services');
                        if (astroSection) {
                            // Remove any existing background classes and set new background
                            astroSection.className = astroSection.className.replace(/bg-gradient-[\w-]+/g, '');
                            astroSection.style.position = 'relative';
                            astroSection.style.backgroundImage = `linear-gradient(rgba(255,255,255,0.85), rgba(255,255,255,0.85)), url('${settings.astrological_services_bg_url}')`;
                            astroSection.style.backgroundSize = 'cover';
                            astroSection.style.backgroundPosition = 'center';
                            astroSection.style.backgroundAttachment = 'scroll'; // Changed to scroll so it moves with section
                            astroSection.style.backgroundRepeat = 'no-repeat';
                            astroSection.style.minHeight = '100vh';
                        }
                    }
                    
                    if (settings.pooja_services_bg_url) {
                        const poojaSection = document.getElementById('pooja');
                        if (poojaSection) {
                            // Remove any existing background classes and set new background
                            poojaSection.className = poojaSection.className.replace(/bg-gradient-[\w-]+/g, '');
                            poojaSection.style.position = 'relative';
                            poojaSection.style.backgroundImage = `linear-gradient(rgba(255,255,255,0.85), rgba(255,255,255,0.85)), url('${settings.pooja_services_bg_url}')`;
                            poojaSection.style.backgroundSize = 'cover';
                            poojaSection.style.backgroundPosition = 'center';
                            poojaSection.style.backgroundAttachment = 'scroll'; // Changed to scroll so it moves with section
                            poojaSection.style.backgroundRepeat = 'no-repeat';
                            poojaSection.style.minHeight = '100vh';
                        }
                    }
                }
                
                // Load menu items - with fallback to manual menu
                try {
                    const menuResponse = await fetch('/api/menu-items');
                    if (menuResponse.ok) {
                        const menuItems = await menuResponse.json();
                        if (menuItems && menuItems.length > 0) {
                            renderMenuItems(menuItems);
                        } else {
                            // Fallback to default menu if database is empty
                            renderDefaultMenuItems();
                        }
                    } else {
                        renderDefaultMenuItems();
                    }
                } catch (error) {
                    console.warn('Failed to load menu from database, using default menu');
                    renderDefaultMenuItems();
                }
            } catch (error) {
                console.error('Error loading navbar:', error);
            }
        }
        
        // Default menu items as fallback
        function renderDefaultMenuItems() {
            const defaultItems = [
                { title: 'Home', url: '#hero-slider', target: '_self' },
                { title: 'Services', url: '#services', target: '_self' },
                { title: 'Gallery', url: '#gallery', target: '_self' },
                { title: 'Pooja', url: '#pooja', target: '_self' },
                { title: 'Solutions', url: '#solutions', target: '_self' },
                { title: 'About', url: '#about', target: '_self' },
                { title: 'Reviews', url: '#reviews', target: '_self' },
                { title: 'FAQ', url: '#faq', target: '_self' },
                { title: 'Contact', url: '/contact', target: '_self' }
            ];
            renderMenuItems(defaultItems);
        }

        function renderMenuItems(items) {
            const desktopMenu = document.getElementById('desktop-menu');
            const mobileMenuItems = document.getElementById('mobile-menu-items');
            
            if (!desktopMenu || !mobileMenuItems) return;
            
            desktopMenu.innerHTML = '';
            mobileMenuItems.innerHTML = '';
            
            items.forEach(item => {
                // Desktop menu item - LARGER SIZE with more padding
                const desktopLink = document.createElement('a');
                desktopLink.href = item.url;
                desktopLink.target = item.target || '_self';
                desktopLink.className = 'px-6 py-3 text-white hover:bg-white hover:bg-opacity-20 rounded-lg transition-all duration-300 font-semibold text-base md:text-lg relative group whitespace-nowrap';
                desktopLink.innerHTML = `
                    ${item.title}
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-white group-hover:w-full transition-all duration-300"></span>
                `;
                desktopLink.addEventListener('click', function(e) {
                    if (item.url.startsWith('#')) {
                        e.preventDefault();
                        const target = document.querySelector(item.url);
                        if (target) {
                            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }
                });
                desktopMenu.appendChild(desktopLink);
                
                // Mobile menu item - LARGER SIZE
                const mobileLink = document.createElement('a');
                mobileLink.href = item.url;
                mobileLink.target = item.target || '_self';
                mobileLink.className = 'block px-4 py-3 text-white hover:bg-purple-700 rounded-lg transition-all duration-300 mobile-nav-link text-base font-semibold';
                mobileLink.textContent = item.title;
                mobileLink.addEventListener('click', function(e) {
                    if (item.url.startsWith('#')) {
                        e.preventDefault();
                        const target = document.querySelector(item.url);
                        if (target) {
                            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                        document.getElementById('mobile-menu').classList.add('hidden');
                        document.querySelector('#mobile-menu-btn i').classList.remove('fa-times');
                        document.querySelector('#mobile-menu-btn i').classList.add('fa-bars');
                    }
                });
                mobileMenuItems.appendChild(mobileLink);
            });
        }
        
        // Apply navbar layout settings from navbar_settings
        function applyNavbarLayout(settings) {
            const navbar = document.getElementById('main-navbar');
            const logoEl = document.getElementById('navbar-logo');
            
            // Apply navbar height
            if (settings.navbar_height) {
                const heights = {
                    'small': 'h-14',
                    'medium': 'h-16 md:h-20',
                    'large': 'h-20 md:h-24'
                };
                const currentClasses = navbar.className;
                const newClasses = currentClasses.replace(/h-\d+(?:\s+md:h-\d+)?/g, heights[settings.navbar_height] || 'h-16 md:h-20');
                navbar.className = newClasses;
            }
            
            // Apply logo position
            if (settings.logo_position === 'center') {
                logoEl.parentElement.classList.add('mx-auto');
            } else if (settings.logo_position === 'right') {
                logoEl.parentElement.classList.add('ml-auto');
            }
        }
        
        // Update navbar colors from navbar_settings
        function updateNavbarColors(primaryColor, secondaryColor, navbarStyle) {
            const navbar = document.getElementById('main-navbar');
            
            if (navbarStyle === 'solid') {
                navbar.style.background = primaryColor;
            } else if (navbarStyle === 'transparent') {
                navbar.style.background = 'rgba(255, 255, 255, 0.1)';
                navbar.style.backdropFilter = 'blur(10px)';
            } else {
                // Default gradient
                navbar.style.background = `linear-gradient(to right, ${primaryColor}, ${secondaryColor})`;
            }
        }
        
        // Load announcement bar
        async function loadAnnouncementBar() {
            try {
                const response = await fetch('/api/content/announcements');
                if (response.ok) {
                    const announcements = await response.json();
                    if (announcements.length > 0) {
                        renderAnnouncements(announcements);
                        document.getElementById('announcement-bar').style.display = 'block';
                    }
                }
            } catch (error) {
                console.error('Error loading announcements:', error);
            }
        }
        
        function renderAnnouncements(announcements) {
            const content = document.getElementById('announcement-content');
            
            // Create announcement items
            let items = '';
            announcements.forEach(announcement => {
                items += `<span class="flex items-center space-x-2">
                    <i class="fas fa-star"></i>
                    <span>${announcement.text}</span>
                </span>`;
            });
            
            // Duplicate for seamless loop
            content.innerHTML = items + items;
        }
        
        // Mobile menu toggle
        document.getElementById('mobile-menu-btn')?.addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            const icon = this.querySelector('i');
            
            mobileMenu.classList.toggle('hidden');
            if (mobileMenu.classList.contains('hidden')) {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            } else {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            }
        });
        
        // Language dropdown toggle
        // Enhanced language dropdown handling
        function initLanguageDropdown() {
            const langBtn = document.getElementById('lang-dropdown-btn');
            const langDropdown = document.getElementById('lang-dropdown');
            
            if (langBtn && langDropdown) {
                langBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    langDropdown.classList.toggle('hidden');
                    
                    // Update button state
                    const chevron = langBtn.querySelector('.fa-chevron-down, .fa-chevron-up');
                    if (chevron) {
                        if (langDropdown.classList.contains('hidden')) {
                            chevron.classList.remove('fa-chevron-up');
                            chevron.classList.add('fa-chevron-down');
                        } else {
                            chevron.classList.remove('fa-chevron-down');
                            chevron.classList.add('fa-chevron-up');
                        }
                    }
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!langBtn.contains(e.target) && !langDropdown.contains(e.target)) {
                        langDropdown.classList.add('hidden');
                        const chevron = langBtn.querySelector('.fa-chevron-up');
                        if (chevron) {
                            chevron.classList.remove('fa-chevron-up');
                            chevron.classList.add('fa-chevron-down');
                        }
                    }
                });
                
                // Close dropdown on Escape key
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape') {
                        langDropdown.classList.add('hidden');
                        const chevron = langBtn.querySelector('.fa-chevron-up');
                        if (chevron) {
                            chevron.classList.remove('fa-chevron-up');
                            chevron.classList.add('fa-chevron-down');
                        }
                    }
                });
            }
        }
        
        // Initialize language dropdown when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initLanguageDropdown);
        } else {
            initLanguageDropdown();
        }
        
        // Add shadow to navbar on scroll
        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('main-navbar');
            if (window.scrollY > 0) {
                navbar.classList.add('navbar-scrolled');
            } else {
                navbar.classList.remove('navbar-scrolled');
            }
        });
        
        // Load navbar and announcements on page load
        loadNavbar();
        loadAnnouncementBar();

        // ========================================
        // NEW SECTIONS: Services, Pooja, Solutions
        // ========================================
        
        // Load Astrological Services
        async function loadAstrologicalServices() {
            try {
                const response = await fetch('/api/astrological-services');
                if (response.ok) {
                    const services = await response.json();
                    renderAstrologicalServices(services);
                }
            } catch (error) {
                console.error('Error loading astrological services:', error);
            }
        }
        
        // Generate random watercolor backgrounds like in the image
        function getRandomWatercolorBackground() {
            const watercolors = [
                'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
                'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
                'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)',
                'linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)',
                'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)',
                'linear-gradient(135deg, #ff8177 0%, #ff867a 0%, #ff8c7f 21%, #f99185 52%, #cf556c 78%, #b12a5b 100%)',
                'linear-gradient(135deg, #3b41c5 0%, #a981bb 49%, #ffc649 100%)'
            ];
            return watercolors[Math.floor(Math.random() * watercolors.length)];
        }
        
        function renderAstrologicalServices(services) {
            const grid = document.getElementById('astrological-services-grid');
            if (!grid) {
                console.error('Astrological services grid not found!');
                return;
            }
            
            console.log('Rendering astrological services:', services);
            grid.innerHTML = '';
            
            if (!services || services.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500 text-lg">No services available at the moment</div>';
                return;
            }
            
            services.forEach((service, index) => {
                const serviceItem = document.createElement('div');
                serviceItem.className = 'text-center cursor-pointer group transition-all duration-300 hover:scale-105';
                serviceItem.style.animationDelay = `${index * 0.1}s`;
                
                serviceItem.innerHTML = `
                    <div class="service-item">
                        <!-- Service Image - Direct Display (No Card, No Background) -->
                        <div class="mb-4">
                            ${(service.icon_url || service.image_url) ? 
                                `<img src="${service.icon_url || service.image_url}" alt="${service.title}" 
                                     class="w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 mx-auto object-contain transition-transform duration-300 group-hover:scale-110" 
                                     style="background: transparent !important;">` :
                                `<div class="w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 mx-auto flex items-center justify-center">
                                    <i class="fas fa-star text-purple-600 text-5xl"></i>
                                </div>`
                            }
                        </div>
                        
                        <!-- Service Title Below Image -->
                        <h3 class="text-sm sm:text-base md:text-lg font-semibold text-gray-800 group-hover:text-purple-600 transition-colors duration-300 px-2">
                            ${service.title}
                        </h3>
                    </div>
                `;
                
                grid.appendChild(serviceItem);
            });
            
            console.log(`✅ Successfully rendered ${services.length} astrological services (simple display)`);
        }
        
        // Load Pooja Services
        async function loadPoojaServices() {
            try {
                const response = await fetch('/api/content/pooja-services');
                if (response.ok) {
                    const poojas = await response.json();
                    renderPoojaServices(poojas);
                }
            } catch (error) {
                console.error('Error loading pooja services:', error);
            }
        }
        
        function renderPoojaServices(poojas) {
            const grid = document.getElementById('pooja-services-grid');
            grid.innerHTML = '';
            
            poojas.forEach((pooja, index) => {
                const card = document.createElement('div');
                card.className = 'text-center scale-in cursor-pointer';
                card.style.animationDelay = `${index * 0.1}s`;
                card.style.opacity = '0';
                
                card.innerHTML = `
                    <div class="pooja-circle image-zoom w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 lg:w-40 lg:h-40 mx-auto mb-3 sm:mb-4 rounded-full overflow-hidden border-2 sm:border-4 border-white shadow-xl hover:shadow-2xl transition-shadow duration-300">
                        ${pooja.image_url ? 
                            `<img src="${pooja.image_url}" alt="${pooja.title}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\'w-full h-full bg-gradient-to-br from-amber-400 to-red-500 flex items-center justify-center\\'><i class=\\'fas fa-om text-white text-2xl sm:text-3xl md:text-4xl\\'></i></div>'">` :
                            `<div class="w-full h-full bg-gradient-to-br from-amber-400 to-red-500 flex items-center justify-center">
                                <i class="fas fa-om text-white text-2xl sm:text-3xl md:text-4xl"></i>
                            </div>`
                        }
                    </div>
                    <h3 class="text-sm sm:text-base md:text-lg font-bold text-gray-800 px-2 transition-colors hover:text-orange-600">${pooja.title}</h3>
                    ${pooja.description ? `<p class="text-xs text-gray-600 mt-1 px-2 line-clamp-2">${pooja.description}</p>` : ''}
                `;
                
                grid.appendChild(card);
                setTimeout(() => card.style.opacity = '1', 50);
            });
        }
        
        // Load Expert Solutions
        async function loadExpertSolutions() {
            try {
                const response = await fetch('/api/content/expert-solutions');
                if (response.ok) {
                    const solutions = await response.json();
                    renderExpertSolutions(solutions);
                }
            } catch (error) {
                console.error('Error loading expert solutions:', error);
            }
        }
        
        function renderExpertSolutions(solutions) {
            const grid = document.getElementById('expert-solutions-grid');
            grid.innerHTML = '';
            
            solutions.forEach((solution, index) => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-xl slide-in-up';
                card.style.transitionDelay = `${index * 0.1}s`;
                
                card.innerHTML = `
                    <!-- Image Above -->
                    <div class="h-48 md:h-56 lg:h-64 overflow-hidden">
                        ${solution.image_url ? 
                            `<img src="${solution.image_url}" 
                                 alt="${solution.title}" 
                                 class="w-full h-full object-cover hover:scale-105 transition-transform duration-300" 
                                 onerror="this.parentElement.innerHTML='<div class=\\'w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\\'><i class=\\'fas fa-hands-helping text-white text-5xl\\'></i></div>'">` :
                            `<div class="w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
                                <i class="fas fa-hands-helping text-white text-5xl"></i>
                            </div>`
                        }
                    </div>
                    
                    <!-- Text Below -->
                    <div class="p-4 md:p-6">
                        <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-2">
                            ${solution.title}
                        </h3>
                        <p class="text-sm md:text-base text-gray-600 leading-relaxed">
                            ${solution.description || 'Discover expert astrological guidance tailored to your unique journey.'}
                        </p>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }
        
        // Scroll Animation Observer
        function initScrollAnimations() {
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);
            
            // Observe all animated elements
            document.querySelectorAll('.fade-in, .slide-in-left, .slide-in-right').forEach(el => {
                observer.observe(el);
            });
        }
        
        // Load all new sections with error handling
        async function initializeServices() {
            try {
                console.log('🔄 Initializing astrological services...');
                await loadAstrologicalServices();
                console.log('✅ Astrological services initialized successfully');
            } catch (error) {
                console.error('❌ Failed to initialize astrological services:', error);
            }
        }
        
        initializeServices();
        loadPoojaServices();
        loadExpertSolutions();
        
        // Initialize scroll animations after a short delay to ensure DOM is ready
        setTimeout(initScrollAnimations, 500);

        // Load Hero Slides from API
        let currentSlide = 0;
        let heroSlides = [];

        async function loadHeroSlides() {
            try {
                console.log('Fetching hero slides from API...');
                const response = await fetch('/api/content/hero-slides');
                console.log('Hero slides response status:', response.status);
                const data = await response.json();
                console.log('Hero slides data received:', data);
                
                // Handle API response format
                if (Array.isArray(data)) {
                    heroSlides = data;
                    console.log('Loaded', heroSlides.length, 'hero slides');
                    // Debug: Check first slide's image URL
                    if (heroSlides.length > 0) {
                        console.log('First hero slide image URL:', heroSlides[0].image);
                        console.log('First hero slide video URL:', heroSlides[0].video_url);
                    }
                } else {
                    console.error('Invalid hero slides data format:', data);
                    heroSlides = [];
                }
                
                renderHeroSlides();
                if (heroSlides.length > 0) {
                    startHeroSlider();
                    console.log('Hero slider started');
                } else {
                    console.warn('No hero slides to display');
                }
            } catch (error) {
                console.error('Error loading hero slides:', error);
                heroSlides = [];
                renderHeroSlides();
            }
        }

        function renderHeroSlides() {
            console.log('renderHeroSlides called with', heroSlides ? heroSlides.length : 0, 'slides');
            const container = document.querySelector('.hero-slides-container');
            if (!container) {
                console.error('Hero slides container not found');
                return;
            }
            
            console.log('Container found, clearing content');
            container.innerHTML = '';
            
            if (!Array.isArray(heroSlides) || heroSlides.length === 0) {
                console.warn('No hero slides to render, showing default content');
                container.innerHTML = '<div class="absolute inset-0 bg-gradient-to-r from-purple-900 to-pink-900 flex items-center justify-center"><div class="text-center text-white px-4"><h1 class="text-5xl font-bold mb-4 font-serif">Welcome to Cosmic Astrology</h1><p class="text-xl mb-8">Your journey to cosmic wisdom begins here</p></div></div>';
                return;
            }
            
            console.log('Starting to render', heroSlides.length, 'slides');
            
            heroSlides.forEach((slide, index) => {
                const slideDiv = document.createElement('div');
                slideDiv.className = 'hero-slide absolute inset-0 transition-opacity duration-1000' + (index === 0 ? ' opacity-100' : ' opacity-0');
                slideDiv.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;';
                slideDiv.setAttribute('data-slide-index', index);
                
                // Check if slide has video
                const isVideo = slide.video_url && slide.video_url.trim() !== '';
                console.log('Slide', index, '- Video:', isVideo, slide.video_url);
                
                if (isVideo) {
                    // Video slide
                    slideDiv.innerHTML = `
                        <div class="relative h-full">
                            <video class="w-full h-full object-cover" autoplay muted playsinline>
                                <source src="${slide.video_url}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <div class="absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center">
                                <div class="text-center text-white px-4 max-w-4xl">
                                    <h1 class="text-3xl md:text-5xl font-bold mb-4 font-serif drop-shadow-2xl">${slide.title}</h1>
                                    <p class="text-lg md:text-xl mb-8 drop-shadow-lg">${slide.description}</p>
                                    <div class="flex flex-wrap gap-4 justify-center">
                                        <button onclick="document.getElementById('chatbot-toggle').click(); setTimeout(() => sendMenuOption('book'), 500);" class="bg-gradient-to-r from-purple-600 to-pink-600 px-6 md:px-8 py-2 md:py-3 rounded-full text-base md:text-lg font-bold hover:shadow-lg transition inline-block">
                                            <i class="fas fa-calendar-check mr-2"></i>Book Consultation
                                        </button>
                                        <a href="/contact.html" class="bg-gradient-to-r from-green-500 to-teal-600 px-6 md:px-8 py-2 md:py-3 rounded-full text-base md:text-lg font-bold hover:shadow-lg transition inline-block">
                                            <i class="fas fa-envelope mr-2"></i>Contact Us
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // Image slide
                    slideDiv.innerHTML = `
                        <div class="relative h-full">
                            <img src="${slide.image}" alt="${slide.title}" class="w-full h-full object-cover object-center" style="object-fit: cover; object-position: center;" loading="lazy" onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22600%22%3E%3Crect fill=%22%23667eea%22 width=%22800%22 height=%22600%22/%3E%3Ctext fill=%22white%22 font-size=%2230%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22%3EImage Not Available%3C/text%3E%3C/svg%3E'">
                            <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center">
                                <div class="text-center text-white px-4 max-w-4xl">
                                    <h1 class="text-3xl md:text-5xl font-bold mb-4 font-serif">${slide.title}</h1>
                                    <p class="text-lg md:text-xl mb-8">${slide.description}</p>
                                    <div class="flex flex-wrap gap-4 justify-center">
                                        <button onclick="document.getElementById('chatbot-toggle').click(); setTimeout(() => sendMenuOption('book'), 500);" class="bg-gradient-to-r from-purple-600 to-pink-600 px-6 md:px-8 py-2 md:py-3 rounded-full text-base md:text-lg font-bold hover:shadow-lg transition inline-block">
                                            <i class="fas fa-calendar-check mr-2"></i>Book Consultation
                                        </button>
                                        <a href="/contact.html" class="bg-gradient-to-r from-green-500 to-teal-600 px-6 md:px-8 py-2 md:py-3 rounded-full text-base md:text-lg font-bold hover:shadow-lg transition inline-block">
                                            <i class="fas fa-envelope mr-2"></i>Contact Us
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }
                container.appendChild(slideDiv);
                console.log('Appended slide', index, '- HTML length:', slideDiv.innerHTML.length);
            });
            
            console.log('Total slides in container:', container.children.length);
            console.log('Container dimensions:', container.offsetWidth, 'x', container.offsetHeight);
        }

        function showSlide(index) {
            const slides = document.querySelectorAll('.hero-slide');
            slides.forEach((slide, i) => {
                const isActive = i === index;
                
                // Remove/add active class for CSS transitions
                if (isActive) {
                    slide.classList.add('active');
                    slide.classList.remove('opacity-0');
                    slide.classList.add('opacity-100');
                    slide.style.zIndex = '2';
                } else {
                    slide.classList.remove('active');
                    slide.classList.remove('opacity-100');
                    slide.classList.add('opacity-0');
                    slide.style.zIndex = '1';
                }
                
                // Handle video autoplay
                const video = slide.querySelector('video');
                if (video) {
                    if (isActive) {
                        video.currentTime = 0;
                        video.play().catch(e => console.log('Video autoplay prevented:', e));
                    } else {
                        video.pause();
                    }
                }
            });
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % heroSlides.length;
            showSlide(currentSlide);
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + heroSlides.length) % heroSlides.length;
            showSlide(currentSlide);
        }

        let sliderInterval = null;
        
        function startHeroSlider() {
            // Clear any existing interval
            if (sliderInterval) {
                clearInterval(sliderInterval);
            }
            
            // Start with initial interval
            sliderInterval = setInterval(() => {
                const currentSlideElement = document.querySelectorAll('.hero-slide')[currentSlide];
                const video = currentSlideElement?.querySelector('video');
                
                // If current slide has a video that's still playing, wait for it to finish
                if (video && !video.paused && !video.ended) {
                    console.log('Video still playing, waiting...');
                    return;
                }
                
                nextSlide();
            }, 5000);
            
            // Add event listener to videos to advance slide when video ends
            document.querySelectorAll('.hero-slide video').forEach(video => {
                video.addEventListener('ended', () => {
                    console.log('Video ended, advancing to next slide');
                    nextSlide();
                });
            });
        }

        document.getElementById('next-slide').addEventListener('click', nextSlide);
        document.getElementById('prev-slide').addEventListener('click', prevSlide);
        
        // Load About Section from API
        async function loadAboutSection() {
            try {
                const response = await fetch('/api/content/about-section');
                const data = await response.json();
                
                if (data && Object.keys(data).length > 0) {
                    document.getElementById('about-title').textContent = data.name || 'Our Expert Astrologer';
                    document.getElementById('about-description').textContent = data.description || '';
                    document.getElementById('about-image').src = data.img || '';
                    
                    // Render additional details with new fields
                    const detailsContainer = document.getElementById('about-details');
                    const details = [];
                    
                    if (data.years_of_experience) {
                        details.push(`<div class="flex items-start"><i class="fas fa-calendar-alt text-purple-600 mt-1 mr-3"></i><p><strong>Experience:</strong> ${data.years_of_experience}</p></div>`);
                    }
                    if (data.expertise_areas) {
                        details.push(`<div class="flex items-start"><i class="fas fa-star text-purple-600 mt-1 mr-3"></i><p><strong>Expertise:</strong> ${data.expertise_areas}</p></div>`);
                    }
                    if (data.location) {
                        details.push(`<div class="flex items-start"><i class="fas fa-map-marker-alt text-purple-600 mt-1 mr-3"></i><p><strong>Location:</strong> ${data.location}</p></div>`);
                    }
                    if (data.accurate_predictions) {
                        details.push(`<div class="flex items-start"><i class="fas fa-check-circle text-purple-600 mt-1 mr-3"></i><p><strong>Predictions:</strong> ${data.accurate_predictions}</p></div>`);
                    }
                    
                    detailsContainer.innerHTML = details.join('');
                } else {
                    // Default content if no data
                    document.getElementById('about-title').textContent = 'Our Expert Astrologer';
                    document.getElementById('about-description').textContent = 'Welcome to our astrology consultation service. Our expert astrologer brings years of experience in Vedic astrology, tarot reading, and spiritual guidance.';
                    document.getElementById('about-details').innerHTML = `
                        <div class="flex items-start"><i class="fas fa-calendar-alt text-purple-600 mt-1 mr-3"></i><p><strong>Experience:</strong> 15+ Years</p></div>
                        <div class="flex items-start"><i class="fas fa-star text-purple-600 mt-1 mr-3"></i><p><strong>Expertise:</strong> Vedic Astrology, Tarot, Vastu</p></div>
                        <div class="flex items-start"><i class="fas fa-map-marker-alt text-purple-600 mt-1 mr-3"></i><p><strong>Location:</strong> Mumbai, India</p></div>
                        <div class="flex items-start"><i class="fas fa-check-circle text-purple-600 mt-1 mr-3"></i><p><strong>Predictions:</strong> 10,000+ Accurate Predictions</p></div>
                    `;
                }
            } catch (error) {
                console.error('Error loading about section:', error);
            }
        }
        
        // Load Gallery Slides from API
        async function loadGallerySlides() {
            try {
                console.log('Fetching gallery slides from API...');
                const response = await fetch('/api/content/gallery-slides');
                console.log('Gallery slides response status:', response.status);
                const data = await response.json();
                console.log('Gallery slides data received:', data);
                
                // Handle API response format
                let gallerySlides = [];
                if (Array.isArray(data)) {
                    gallerySlides = data;
                    console.log('Loaded', gallerySlides.length, 'gallery slides');
                    // Debug: Check first slide's image URL
                    if (gallerySlides.length > 0) {
                        console.log('First gallery slide image URL:', gallerySlides[0].image);
                    }
                } else {
                    console.error('Invalid gallery slides data format:', data);
                }
                
                renderGallerySlides(gallerySlides);
            } catch (error) {
                console.error('Error loading gallery slides:', error);
                renderGallerySlides([]);
            }
        }

        function renderGallerySlides(slides) {
            const container = document.getElementById('gallery-slides-container');
            container.innerHTML = '';
            
            if (slides.length === 0) {
                container.innerHTML = '<div class="w-full text-center py-12 text-gray-500"><p class="text-xl">No gallery images available yet.</p></div>';
                return;
            }
            
            slides.forEach(slide => {
                const slideDiv = document.createElement('div');
                slideDiv.className = 'flex-shrink-0 w-80 gallery-item bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-2xl transition transform hover:-translate-y-2';
                slideDiv.innerHTML = `
                    <div class="relative overflow-hidden h-60">
                        <img src="${slide.image}" 
                             alt="${slide.title}" 
                             class="w-full h-full object-cover"
                             loading="lazy"
                             onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect fill=%22%23ec4899%22 width=%22400%22 height=%22300%22/%3E%3Ctext fill=%22white%22 font-size=%2220%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22%3EImage Not Available%3C/text%3E%3C/svg%3E'">
                    </div>
                    <div class="p-4">
                        <h4 class="font-bold text-purple-800 text-center text-lg">${slide.title}</h4>
                    </div>
                `;
                container.appendChild(slideDiv);
            });
            
            // Initialize gallery slider
            initGallerySlider();
        }
        
        // Gallery Slider Logic
        let galleryCurrentIndex = 0;
        let galleryAutoSlideInterval;
        
        function initGallerySlider() {
            const container = document.getElementById('gallery-slides-container');
            const prevBtn = document.getElementById('gallery-prev');
            const nextBtn = document.getElementById('gallery-next');
            const slides = container.querySelectorAll('.gallery-item');
            
            if (slides.length === 0) return;
            
            // Calculate how many slides to show at once (responsive)
            function getSlidesToShow() {
                if (window.innerWidth >= 1024) return 3; // Desktop: 3 slides
                if (window.innerWidth >= 768) return 2;  // Tablet: 2 slides
                return 1; // Mobile: 1 slide
            }
            
            function updateSlidePosition() {
                const slideWidth = slides[0].offsetWidth;
                const gap = 24; // 1.5rem (gap-6)
                const offset = -(galleryCurrentIndex * (slideWidth + gap));
                container.style.transform = `translateX(${offset}px)`;
            }
            
            function nextSlide() {
                const slidesToShow = getSlidesToShow();
                const maxIndex = Math.max(0, slides.length - slidesToShow);
                galleryCurrentIndex = (galleryCurrentIndex + 1) > maxIndex ? 0 : galleryCurrentIndex + 1;
                updateSlidePosition();
            }
            
            function prevSlide() {
                const slidesToShow = getSlidesToShow();
                const maxIndex = Math.max(0, slides.length - slidesToShow);
                galleryCurrentIndex = (galleryCurrentIndex - 1) < 0 ? maxIndex : galleryCurrentIndex - 1;
                updateSlidePosition();
            }
            
            // Event listeners
            nextBtn.addEventListener('click', () => {
                nextSlide();
                resetAutoSlide();
            });
            
            prevBtn.addEventListener('click', () => {
                prevSlide();
                resetAutoSlide();
            });
            
            // Auto-slide every 3 seconds
            function startAutoSlide() {
                galleryAutoSlideInterval = setInterval(nextSlide, 3000);
            }
            
            function resetAutoSlide() {
                clearInterval(galleryAutoSlideInterval);
                startAutoSlide();
            }
            
            // Pause on hover
            container.addEventListener('mouseenter', () => {
                clearInterval(galleryAutoSlideInterval);
            });
            
            container.addEventListener('mouseleave', () => {
                startAutoSlide();
            });
            
            // Handle window resize
            window.addEventListener('resize', updateSlidePosition);
            
            // Start auto-slide
            startAutoSlide();
            updateSlidePosition();
        }
        // Global business info and chatbot config variables
        let globalBusinessInfo = null;
        let globalChatbotConfig = null;
        
        // Load Chatbot Configuration from Database
        async function loadChatbotConfig() {
            try {
                const response = await fetch('/api/content/chatbot-config');
                const config = await response.json();
                globalChatbotConfig = config;
                console.log('Loaded chatbot config:', config);
            } catch (error) {
                console.error('Error loading chatbot config:', error);
            }
        }
        
        // Load Footer Contact Info from API
        async function loadContactInfo() {
            try {
                const response = await fetch('/api/business-info');
                const config = await response.json();
                globalBusinessInfo = config; // Store globally for use in other functions
                
                if (config) {
                    document.getElementById('footer-phone').textContent = config.phone || '+91 8431729319';
                    document.getElementById('footer-email').textContent = config.email || 'info@example.com';
                    
                    const socialsDiv = document.getElementById('footer-socials');
                    socialsDiv.innerHTML = '';
                    
                    // Social media links from business info
                    if (config.facebook) {
                        socialsDiv.innerHTML += '<a href="' + config.facebook + '" target="_blank" class="text-2xl hover:text-yellow-300"><i class="fab fa-facebook"></i></a>';
                    }
                    if (config.instagram) {
                        socialsDiv.innerHTML += '<a href="' + config.instagram + '" target="_blank" class="text-2xl hover:text-yellow-300"><i class="fab fa-instagram"></i></a>';
                    }
                    if (config.youtube) {
                        socialsDiv.innerHTML += '<a href="' + config.youtube + '" target="_blank" class="text-2xl hover:text-yellow-300"><i class="fab fa-youtube"></i></a>';
                    }
                    if (config.twitter) {
                        socialsDiv.innerHTML += '<a href="' + config.twitter + '" target="_blank" class="text-2xl hover:text-yellow-300"><i class="fab fa-twitter"></i></a>';
                    }
                    
                    // Add WhatsApp with auto-greeting message
                    const whatsappNumber = config.whatsapp_number || config.phone;
                    if (whatsappNumber) {
                        const whatsappNum = whatsappNumber.replace(/\D/g, '');
                        const greeting = encodeURIComponent('🙏 Namaste! I am interested in your astrology services. Please guide me with consultation details, timings, and pricing. Thank you!');
                        socialsDiv.innerHTML += `<a href="https://wa.me/${whatsappNum}?text=${greeting}" target="_blank" class="text-2xl hover:text-yellow-300"><i class="fab fa-whatsapp"></i></a>`;
                    }

                    // Apply background images to services sections
                    try {
                        // Astrological Services background
                        if (config.astrological_services_bg_url) {
                            applyServiceBackground('services', config.astrological_services_bg_url);
                        }
                        
                        // Pooja Services background
                        if (config.pooja_services_bg_url) {
                            applyServiceBackground('pooja', config.pooja_services_bg_url);
                        }
                        
                        // Legacy services section background (for backward compatibility)
                        if (config.services_bg_url) {
                            applyServiceBackground('services', config.services_bg_url);
                        }
                    } catch (bgErr) {
                        console.warn('Failed to apply service backgrounds:', bgErr);
                    }
                }
            } catch (error) {
                console.error('Error loading contact info:', error);
                document.getElementById('footer-phone').textContent = 'Error loading';
                document.getElementById('footer-email').textContent = 'Error loading';
            }
        }
        
        // Helper function to apply background to service sections
        function applyServiceBackground(sectionId, bgUrl) {
            const section = document.getElementById(sectionId);
            if (!section) return;
            
            section.style.backgroundImage = `url('${bgUrl}')`;
            section.style.backgroundSize = 'cover';
            section.style.backgroundPosition = 'center';
            section.style.backgroundRepeat = 'no-repeat';
            section.style.backgroundAttachment = 'scroll';
            
            // Add subtle overlay for readability
            let overlay = document.getElementById(`${sectionId}-bg-overlay`);
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = `${sectionId}-bg-overlay`;
                overlay.style.position = 'absolute';
                overlay.style.inset = '0';
                overlay.style.backgroundColor = 'rgba(255,255,255,0.70)';
                overlay.style.pointerEvents = 'none';
                overlay.style.zIndex = '0';
                section.style.position = section.style.position || 'relative';
                section.prepend(overlay);
            }
            
            // Ensure container content sits above overlay
            const container = section.querySelector('.container');
            if (container) container.style.position = 'relative';
        }

        // Load and Display Reviews from Database
        let currentReviewIndex = 0;
        let reviewsData = [];
        let reviewsPerView = window.innerWidth >= 768 ? 3 : 1;
        let totalSlides = 0;

        async function loadReviews() {
            try {
                const response = await fetch('/api/reviews?active=true');
                reviewsData = await response.json();
                
                if (reviewsData && reviewsData.length > 0) {
                    displayReviews();
                    setupReviewsCarousel();
                }
            } catch (error) {
                console.error('Error loading reviews:', error);
            }
        }

        function displayReviews() {
            const carousel = document.getElementById('reviews-carousel');
            carousel.innerHTML = reviewsData.map(review => {
                const stars = '★'.repeat(review.rating) + '☆'.repeat(5 - review.rating);
                const initial = review.name.charAt(0).toUpperCase();
                const userImage = review.user_image ? 
                    `<img src="${review.user_image}" alt="${review.name}" class="w-12 h-12 rounded-full object-cover">` :
                    `<div class="w-12 h-12 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full flex items-center justify-center text-white font-bold text-xl">${initial}</div>`;
                
                return `
                    <div class="min-w-full md:min-w-[33.333%] px-2">
                        <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-xl shadow-lg h-full">
                            <div class="flex items-center mb-4">
                                ${userImage}
                                <div class="flex-1 ml-3">
                                    <h4 class="font-bold text-purple-800">${review.name}</h4>
                                    <div class="text-yellow-500 text-sm">${stars}</div>
                                </div>
                            </div>
                            <p class="text-gray-700 italic">"${review.review_text}"</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function setupReviewsCarousel() {
            const reviewDots = document.getElementById('review-dots');
            reviewsPerView = window.innerWidth >= 768 ? 3 : 1;
            totalSlides = Math.max(1, reviewsData.length - reviewsPerView + 1);
            
            // Create navigation dots
            reviewDots.innerHTML = '';
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('button');
                dot.className = 'w-3 h-3 rounded-full transition ' + (i === 0 ? 'bg-purple-600' : 'bg-gray-300');
                dot.onclick = () => goToReview(i);
                reviewDots.appendChild(dot);
            }
            
            // Auto-advance every 4 seconds
            setInterval(nextReview, 4000);
            
            // Handle window resize for responsive layout
            window.addEventListener('resize', () => {
                const newReviewsPerView = window.innerWidth >= 768 ? 3 : 1;
                if (newReviewsPerView !== reviewsPerView) {
                    reviewsPerView = newReviewsPerView;
                    totalSlides = Math.max(1, reviewsData.length - reviewsPerView + 1);
                    currentReviewIndex = Math.min(currentReviewIndex, totalSlides - 1);
                    setupReviewsCarousel();
                    goToReview(currentReviewIndex);
                }
            });
        }

        function goToReview(index) {
            const carousel = document.getElementById('reviews-carousel');
            const reviewDots = document.getElementById('review-dots');
            currentReviewIndex = index;
            const offset = -(index * (100 / reviewsPerView));
            carousel.style.transform = `translateX(${offset}%)`;
            
            // Update dots
            Array.from(reviewDots.children).forEach((dot, i) => {
                dot.className = 'w-3 h-3 rounded-full transition ' + (i === index ? 'bg-purple-600' : 'bg-gray-300');
            });
        }

        function nextReview() {
            if (totalSlides > 0) {
                currentReviewIndex = (currentReviewIndex + 1) % totalSlides;
                goToReview(currentReviewIndex);
            }
        }

        // Load reviews on page load
        loadReviews();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
                const icon = this.querySelector('i');
                if (mobileMenu.classList.contains('hidden')) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                } else {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                }
            });
        }

        // Initialize all data on page load
        window.addEventListener('DOMContentLoaded', function() {
            console.log('Loading hero slides...');
            loadHeroSlides();
            console.log('Loading gallery slides...');
            loadGallerySlides();
            console.log('Loading contact info...');
            loadContactInfo();
            console.log('Loading chatbot config...');
            loadChatbotConfig();
        });
        
        // Also try immediate load for faster display
        if (document.readyState === 'loading') {
            console.log('Document still loading, waiting for DOMContentLoaded...');
        } else {
            console.log('Document already loaded, loading data immediately...');
            loadHeroSlides();
            loadGallerySlides();
            loadContactInfo();
            loadChatbotConfig();
        }
    </script>


<script>
        // Simple Chatbot Implementation
        let isChatbotOpen = false;
        
        function createChatbot() {
            const chatbotHTML = ` <div id="chatbot-widget" class="fixed bottom-4 right-4 sm:bottom-6 sm:right-6 z-50">
                    <!-- Chatbot Button -->
                    <button id="chatbot-toggle" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-full w-14 h-14 sm:w-16 sm:h-16 flex items-center justify-center shadow-2xl hover:shadow-purple-500/50 transition-all duration-300 hover:scale-110">
                        <i class="fas fa-comments text-xl sm:text-2xl"></i>
                    </button>
                    
                    <!-- Chatbot Window -->
                    <div id="chatbot-window" class="hidden fixed sm:absolute bottom-0 left-0 right-0 sm:bottom-20 sm:right-0 sm:left-auto w-full sm:w-96 h-[80vh] sm:h-[500px] bg-white sm:rounded-2xl shadow-2xl flex flex-col overflow-hidden" style="max-height: 600px;">
                        <!-- Header -->
                        <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-4 flex justify-between items-center">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-robot text-2xl"></i>
                                <div>
                                    <h3 class="font-bold">Astrology Assistant</h3>
                                    <p class="text-xs opacity-90">Ask me anything!</p>
                                </div>
                            </div>
                            <button id="chatbot-close" class="hover:bg-white/20 rounded-lg p-2 transition">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <!-- Messages -->
                        <div id="chatbot-messages" class="flex-1 overflow-y-auto p-4 bg-gray-50 space-y-3"></div>
                        
                        <!-- Menu Options (Scrollable) -->
                        <div class="bg-white border-t border-gray-200 px-3 py-2">
                            <div class="flex gap-2 overflow-x-auto" style="scrollbar-width: none; -ms-overflow-style: none;">
                                <style>
                                    .chatbot-menu::-webkit-scrollbar { display: none; }
                                </style>
                                <button onclick="sendMenuOption('services')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    🌟 Services
                                </button>
                                <button onclick="sendMenuOption('book')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-pink-500 to-rose-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📅 Book
                                </button>
                                <button onclick="sendMenuOption('hours')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    ⏰ Hours
                                </button>
                                <button onclick="sendMenuOption('location')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📍 Location
                                </button>
                                <button onclick="sendMenuOption('contact')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📞 Contact
                                </button>
                                <button onclick="sendMenuOption('social')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📱 Social
                                </button>
                                <button onclick="sendMenuOption('qa')" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-teal-500 to-cyan-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    ❓ FAQ
                                </button>
                                <button onclick="contactViaWhatsApp()" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    💬 WhatsApp
                                </button>
                                <button onclick="contactViaCall()" class="flex-shrink-0 px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full text-xs font-semibold hover:shadow-lg transition">
                                    📞 Call Now
                                </button>
                            </div>
                        </div>
                        
                        <!-- Input -->
                        <div class="p-4 bg-white border-t">
                            <div class="flex gap-2">
                                <input type="text" id="chatbot-input" placeholder="Type your message..." class="flex-1 px-4 py-2 border-2 border-gray-300 rounded-full focus:border-purple-500 focus:outline-none">
                                <button id="chatbot-send" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-2 rounded-full hover:shadow-lg transition">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
               
            `;
            document.body.insertAdjacentHTML('beforeend', chatbotHTML);
            
            // Event listeners
            let lastActivityTime = Date.now();
            let reviewTimerSet = false;
            let inactivityTimer = null;
            
            document.getElementById('chatbot-toggle').addEventListener('click', () => {
                toggleChatbot();
                // Send greeting with business name from config when opened
                if (isChatbotOpen && document.getElementById('chatbot-messages').children.length === 0) {
                    setTimeout(() => {
                        const businessName = globalBusinessInfo?.business_name || 'Cosmic Astrology';
                        const welcomeMsg = globalChatbotConfig?.welcome_message || `👋 <strong>Namaste! Welcome to ${businessName}</strong><br><br>How can I help you today?<br><br><em>Type your question or say "menu" to see options!</em>`;
                        addBotMessage(welcomeMsg);
                        startInactivityTimer();
                    }, 300);
                }
            });
            document.getElementById('chatbot-close').addEventListener('click', toggleChatbot);
            document.getElementById('chatbot-send').addEventListener('click', () => {
                sendMessage();
                lastActivityTime = Date.now();
                resetInactivityTimer();
            });
            document.getElementById('chatbot-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                    lastActivityTime = Date.now();
                    resetInactivityTimer();
                }
            });
            
            // Start inactivity timer
            function startInactivityTimer() {
                resetInactivityTimer();
            }
            
            function resetInactivityTimer() {
                if (inactivityTimer) clearTimeout(inactivityTimer);
                // Inactivity timer removed - no auto-prompts
            }
        }
        
        function toggleChatbot() {
            isChatbotOpen = !isChatbotOpen;
            const window = document.getElementById('chatbot-window');
            window.classList.toggle('hidden');
        }
        
        function addUserMessage(text) {
            const messagesDiv = document.getElementById('chatbot-messages');
            messagesDiv.innerHTML += `
                <div class="flex justify-end">
                    <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-2 rounded-2xl rounded-tr-none max-w-[80%]">
                        ${text}
                    </div>
                </div>
            `;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        function addBotMessage(text) {
            const messagesDiv = document.getElementById('chatbot-messages');
            messagesDiv.innerHTML += `
                <div class="flex justify-start">
                    <div class="bg-white border-2 border-gray-200 px-4 py-2 rounded-2xl rounded-tl-none max-w-[85%]" style="line-height: 1.6;">
                        ${text}
                    </div>
                </div>
            `;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        async function sendMessage(bookingData = null) {
            const input = document.getElementById('chatbot-input');
            const message = bookingData ? '' : input.value.trim();
            if (!message && !bookingData) return;
            
            if (!bookingData) {
                addUserMessage(message);
                input.value = '';
                
                // Check if user wants menu
                if (message.toLowerCase().includes('menu') || message.toLowerCase().includes('help') || message.toLowerCase().includes('options')) {
                    showWelcomeMenu();
                    return;
                }
                
                // Booking is now handled by backend response
            }
            
            try {
                const response = await fetch('/api/chatbot', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(bookingData ? { booking: bookingData } : { message: message })
                });
                const data = await response.json();
                console.log('Chatbot response:', data);
                if (data.response === 'SHOW_BOOKING_FORM') {
                    console.log('Showing booking form');
                    addBotMessage('📅 <strong>Great! Let me help you book a consultation.</strong><br><br>Please fill in the details below:');
                    showBookingForm();
                } else {
                    console.log('Showing normal response:', data.response);
                    addBotMessage(data.response || 'Sorry, I couldn\'t understand that.');
                }
            } catch (error) {
                addBotMessage('Sorry, I\'m having trouble connecting. Please try again.');
            }
        }
        
        function showBookingForm() {
            console.log('showBookingForm function called');
            const today = new Date().toISOString().split('T')[0];
            console.log('Max date for DOB:', today);
            addBotMessage(`
                <div class="booking-form-container">
                    <strong>📅 Book Your Consultation</strong><br><br>
                    <form id="chatbot-booking-form" class="space-y-3">
                        <input type="text" id="booking-name" placeholder="Your Name *" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                        <input type="email" id="booking-email" placeholder="Email (Optional)" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                        <input type="tel" id="booking-phone" placeholder="Phone Number (10 digits) *" required pattern="[6-9][0-9]{9}" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                        <div>
                            <label style="display: block; font-size: 14px; color: #333; margin-bottom: 4px; font-weight: 500;">Date of Birth *</label>
                            <input type="date" id="booking-dob" required max="${today}" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; color: #333; margin-bottom: 4px; font-weight: 500;">Select Service *</label>
                            <select id="booking-service" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" style="color: #333; font-size: 14px;">
                                <option value="">Choose a service...</option>
                                <option value="Kundali Analysis">🔮 Kundali Analysis</option>
                                <option value="Tarot Reading">🎴 Tarot Reading</option>
                                <option value="Career Guidance">💼 Career Guidance</option>
                                <option value="Love & Relationships">💑 Love & Relationships</option>
                                <option value="Financial Consultation">💰 Financial Consultation</option>
                                <option value="Vastu Consultation">🏠 Vastu Consultation</option>
                                <option value="Gemstone Recommendation">💎 Gemstone Recommendation</option>
                                <option value="Muhurat Selection">📅 Muhurat Selection</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; color: #333; margin-bottom: 4px; font-weight: 500;">Message (Optional)</label>
                            <textarea id="booking-message" placeholder="Tell us about your concerns or questions..." class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" rows="3" style="color: #333; font-size: 14px;"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-2 rounded-lg font-bold hover:shadow-lg transition">
                            📤 Submit Booking
                        </button>
                    </form>
                </div>
            `);
            
            // Add form submit handler
            setTimeout(() => {
                const form = document.getElementById('chatbot-booking-form');
                form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    // Validation
                    const name = document.getElementById('booking-name').value.trim();
                    const email = document.getElementById('booking-email').value.trim();
                    const phone = document.getElementById('booking-phone').value.trim();
                    const dob = document.getElementById('booking-dob').value;
                    const service = document.getElementById('booking-service').value;
                    
                    // Name validation - at least 2 letters, only letters and spaces
                    if (!/^[A-Za-z\s]{2,}$/.test(name)) {
                        addBotMessage('❌ Please enter a valid name (at least 2 letters, only alphabets)');
                        return;
                    }
                    
                    // Email validation (if provided)
                    if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                        addBotMessage('❌ Please enter a valid email address');
                        return;
                    }
                    
                    // Phone validation - 10 digits starting with 6/7/8/9
                    if (!/^[6-9]\d{9}$/.test(phone)) {
                        addBotMessage('❌ Please enter a valid 10-digit phone number starting with 6, 7, 8, or 9');
                        return;
                    }
                    
                    // DOB validation
                    const dobDate = new Date(dob);
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    if (dobDate >= today) {
                        addBotMessage('❌ Date of birth cannot be today or in the future');
                        return;
                    }
                    
                    const age = Math.floor((today - dobDate) / (365.25 * 24 * 60 * 60 * 1000));
                    if (age < 5 || age > 120) {
                        addBotMessage('❌ Please enter a valid date of birth (age between 5 and 120 years)');
                        return;
                    }
                    
                    const bookingData = {
                        name: name,
                        email: email || null,
                        phone: phone,
                        dob: dob,
                        service: service,
                        subject: service,
                        message: document.getElementById('booking-message').value.trim() || null
                    };
                    
                    // Show loading message
                    addBotMessage('⏳ <strong>Processing your booking...</strong>');
                    
                    try {
                        // Submit booking to API
                        const response = await fetch('/api/bookings', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(bookingData)
                        });
                        
                        const result = await response.json();
                        
                        if (response.ok && result) {
                            // Remove the entire booking form message from chat
                            const messages = document.getElementById('chatbot-messages');
                            const formMessages = messages.querySelectorAll('.booking-form-container');
                            formMessages.forEach(msg => {
                                const parentDiv = msg.closest('.flex');
                                if (parentDiv) parentDiv.remove();
                            });
                            
                            // Show success message with contact options
                            addBotMessage(`✅ <strong>Booking Confirmed!</strong><br><br>
Thank you <strong>${name}</strong> for booking <strong>${service}</strong>!<br><br>
📋 <strong>Booking Details:</strong><br>
• Name: ${name}<br>
• Phone: ${phone}<br>
• Service: ${service}<br>
• DOB: ${dob}<br>
${bookingData.message ? '• Question: ' + bookingData.message + '<br>' : ''}
<br><em>Booking ID: #${result.id}</em><br><br>
📱 <strong>Contact Us Directly:</strong><br>
<div style="display: flex; gap: 10px; flex-wrap: wrap; margin: 15px 0;">
    <a href="https://wa.me/${(globalBusinessInfo?.whatsapp_number || globalBusinessInfo?.phone || '918431729319').replace(/\\D/g, '')}?text=Hi!%20I%20just%20booked%20(ID:%20${result.id})%20for%20${encodeURIComponent(service)}" target="_blank" style="background: #25D366; color: white; padding: 10px 15px; border-radius: 20px; text-decoration: none; display: inline-flex; align-items: center; font-weight: bold; gap: 5px;">
        <i class="fab fa-whatsapp"></i> WhatsApp
    </a>
    <a href="tel:${globalBusinessInfo?.phone || '+918431729319'}" style="background: #0088cc; color: white; padding: 10px 15px; border-radius: 20px; text-decoration: none; display: inline-flex; align-items: center; font-weight: bold; gap: 5px;">
        <i class="fas fa-phone"></i> Call Now
    </a>
    <a href="mailto:${globalBusinessInfo?.email || 'omkargouda1204@gmail.com'}?subject=Booking%20Confirmation%20${result.id}&body=Hi,%20I%20booked%20${encodeURIComponent(service)}%20consultation." style="background: #EA4335; color: white; padding: 10px 15px; border-radius: 20px; text-decoration: none; display: inline-flex; align-items: center; font-weight: bold; gap: 5px;">
        <i class="fas fa-envelope"></i> Email
    </a>
</div>
<br>🙏 <strong>What's next?</strong><br>
• We'll contact you within 2 hours<br>
• Or use buttons above to reach us now!<br>
• Prepare your birth details<br><br>
💬 <strong>Need anything else?</strong> Just ask!`);
                            
                            // Reset review flag
                            reviewTimerSet = false;
                        } else {
                            const waNum = (globalBusinessInfo?.whatsapp_number || globalBusinessInfo?.phone || '918431729319').replace(/\D/g, '');
                            const greeting = encodeURIComponent('Hello! I tried booking but encountered an issue. Can you help?');
                            addBotMessage(`❌ <strong>Booking failed</strong><br><br>${result.error || 'Please try again or contact us directly.'}<br><br>
<a href="https://wa.me/${waNum}?text=${greeting}" target="_blank" style="color: #7C3AED; font-weight: bold;">
💬 Contact us on WhatsApp instead
</a>`);
                        }
                    } catch (error) {
                        console.error('Booking error:', error);
                        const waNum = (globalBusinessInfo?.whatsapp_number || globalBusinessInfo?.phone || '918431729319').replace(/\D/g, '');
                        const greeting = encodeURIComponent('Hello! I encountered an error while booking. Please assist me.');
                        addBotMessage(`❌ <strong>Booking failed. Please try again or contact us directly.</strong><br><br><a href="https://wa.me/${waNum}?text=${greeting}" target="_blank" style="color: #7C3AED; font-weight: bold;">💬 WhatsApp Us</a>`);
                    }
                });
            }, 100);
        }
        
        function showWelcomeMenu() {
            addBotMessage(`
                <div class="welcome-menu">
                    <strong style="font-size: 18px;">🙏 Namaste! Welcome to Cosmic Astrology</strong><br><br>
                    <p style="color: #666; margin-bottom: 15px;">I'm here to assist you. Click any option below:</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px;">
                        <button onclick="sendMenuOption('services')" class="menu-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            🌟 Services
                        </button>
                        <button onclick="sendMenuOption('book')" class="menu-btn" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            📅 Book Now
                        </button>
                        <button onclick="sendMenuOption('hours')" class="menu-btn" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            ⏰ Hours
                        </button>
                        <button onclick="sendMenuOption('location')" class="menu-btn" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            📍 Location
                        </button>
                        <button onclick="sendMenuOption('contact')" class="menu-btn" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            📞 Contact
                        </button>
                        <button onclick="sendMenuOption('social')" class="menu-btn" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); color: white; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            📱 Social
                        </button>
                        <button onclick="sendMenuOption('qa')" class="menu-btn" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #333; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 13px;">
                            ❓ FAQ
                        </button>
                    </div>
                    
                    <p style="margin-top: 15px; color: #888; font-size: 12px;"><em>Or type your question directly!</em></p>
                </div>
            `);
        }
        
        function sendMenuOption(option) {
            const displayText = option.charAt(0).toUpperCase() + option.slice(1);
            addUserMessage(displayText);
            
            // Send to backend without triggering sendMessage() again
            fetch('/api/chatbot', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message: option })
            })
            .then(response => response.json())
            .then(data => {
                if (data.response === 'SHOW_BOOKING_FORM') {
                    console.log('Showing booking form from menu');
                    addBotMessage('📅 <strong>Great! Let me help you book a consultation.</strong><br><br>Please fill in the details below:');
                    showBookingForm();
                } else if (data.response) {
                    addBotMessage(data.response);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                addBotMessage('Sorry, I encountered an error. Please try again.');
            });
            
            // Clear input
            document.getElementById('chatbot-input').value = '';
        }
        
        function contactViaWhatsApp() {
            // Use global business info for WhatsApp number
            const whatsappNumber = globalBusinessInfo?.whatsapp_number || globalBusinessInfo?.phone || '918431729319';
            const whatsappNum = whatsappNumber.replace(/\D/g, '');
            const message = encodeURIComponent('Hello! 👋 I\'m interested in astrology consultation. Can you please guide me?');
            window.open(`https://wa.me/${whatsappNum}?text=${message}`, '_blank');
        }
        
        function contactViaCall() {
            const phoneNumber = globalBusinessInfo?.phone || '+918431729319';
            window.location.href = `tel:${phoneNumber}`;
        }
    </script>

    <script>
        // Page initialization
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded successfully');
            console.log('Backend ready');
            
            // Load About section
            loadAboutSection();
            
            // Initialize chatbot
            createChatbot();
            
            // Smooth scrolling for navigation links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                    if (href === '#' || href === '') return;
                    
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        // Close mobile menu if open
                        const mobileMenu = document.getElementById('mobile-menu');
                        if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                            mobileMenu.classList.add('hidden');
                        }
                        
                        // Smooth scroll to section
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
            
            // Highlight active nav link on scroll
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link, .mobile-nav-link');
            
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    if (scrollY >= (sectionTop - 100)) {
                        current = section.getAttribute('id');
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('text-yellow-300');
                    if (link.getAttribute('href') === '#' + current) {
                        link.classList.add('text-yellow-300');
                    }
                });
            });
        });
    </script>
</body>
</html>
