<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Om Sri Mahakali Bhairavi Astrology Center</title>
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="/static/styles/main.css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.15.4/css/all.css">
</head>
<body class="bg-gray-100">

    <!-- ========== LOGIN SCREEN ========== -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center px-4 bg-gradient-to-br from-purple-600 to-pink-600">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-96">
            <div class="text-center mb-6">
                <i class="fas fa-moon text-6xl text-purple-600 mb-4"></i>
                <h1 class="text-3xl font-bold text-gray-800">Admin Login</h1>
                <p class="text-gray-600 mt-2">Cosmic Astrology Dashboard</p>
            </div>
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="admin-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="admin-password" autocomplete="current-password" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none" placeholder="Enter admin password" required>
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 px-4 rounded-lg font-semibold hover:shadow-lg transform hover:-translate-y-0.5 transition">
                    <i class="fas fa-sign-in-alt mr-2"></i>Login
                </button>
                <p id="login-error" class="text-red-500 text-sm text-center hidden">Incorrect password!</p>
            </form>
        </div>
    </div>

    <!-- ========== ADMIN DASHBOARD ========== -->
    <div id="admin-dashboard" class="hidden">
        <!-- Navbar -->
        <nav class="bg-gradient-to-r from-purple-700 to-pink-600 text-white shadow-lg sticky top-0 z-50">
            <div class="container mx-auto px-4 sm:px-6 py-3 sm:py-4">
                <div class="flex justify-between items-center">
                    <h1 class="text-lg sm:text-2xl font-bold">
                        <i class="fas fa-moon mr-1 sm:mr-2"></i>
                        <span class="hidden sm:inline">Admin Dashboard</span>
                        <span class="sm:hidden">Admin</span>
                    </h1>
                    <button onclick="logout()" class="bg-white bg-opacity-20 hover:bg-opacity-30 px-3 sm:px-6 py-2 rounded-lg transition font-semibold text-sm sm:text-base">
                        <i class="fas fa-sign-out-alt mr-0 sm:mr-2"></i>
                        <span class="hidden sm:inline">Logout</span>
                    </button>
                </div>
            </div>
        </nav>

        <div class="container mx-auto px-4 sm:px-6 py-4 sm:py-8">
            <!-- Tab Navigation -->
            <div class="bg-white rounded-2xl shadow-lg p-2 mb-6 overflow-x-auto">
                <div class="flex flex-nowrap sm:flex-wrap gap-2 min-w-max sm:min-w-0">
                    <button class="tab-btn active px-6 py-3 rounded-xl font-semibold text-sm" data-tab="stats">
                        <i class="fas fa-chart-bar mr-2"></i>Stats
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="hero">
                        <i class="fas fa-images mr-2"></i>Hero Slides
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="gallery">
                        <i class="fas fa-photo-video mr-2"></i>Gallery
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="messages">
                        <i class="fas fa-envelope mr-2"></i>Messages
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="bookings">
                        <i class="fas fa-calendar-check mr-2"></i>Bookings
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="business">
                        <i class="fas fa-building mr-2"></i>Business Info
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="chatbot">
                        <i class="fas fa-robot mr-2"></i>Chatbot Config
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="about">
                        <i class="fas fa-user-tie mr-2"></i>About Section
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="brand-settings">
                        <i class="fas fa-palette mr-2"></i>Brand Settings
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="announcements">
                        <i class="fas fa-bullhorn mr-2"></i>Announcements
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="astrological-services">
                        <i class="fas fa-star mr-2"></i>Astrological Services
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="pooja-services">
                        <i class="fas fa-om mr-2"></i>Pooja Services
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="expert-solutions">
                        <i class="fas fa-hands-helping mr-2"></i>Expert Solutions
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="reviews">
                        <i class="fas fa-star mr-2"></i>Client Reviews
                    </button>
                    <button class="tab-btn px-6 py-3 rounded-xl font-semibold text-sm text-gray-600 hover:bg-gray-100" data-tab="settings">
                        <i class="fas fa-cog mr-2"></i>Settings
                    </button>
                </div>
            </div>

            <!-- Tab Content -->
            <div id="stats-section" class="tab-content">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Hero Slides Card -->
                    <div class="card bg-white rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-14 h-14 gradient-purple rounded-xl flex items-center justify-center">
                                <i class="fas fa-images text-white text-2xl"></i>
                            </div>
                            <span class="text-xs font-semibold text-purple-600 bg-purple-50 px-3 py-1 rounded-full">ACTIVE</span>
                        </div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Hero Slides</p>
                        <p class="stat-number text-purple-600" id="stat-hero">0</p>
                    </div>
                    <!-- Gallery Card -->
                    <div class="card bg-white rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-14 h-14 gradient-blue rounded-xl flex items-center justify-center">
                                <i class="fas fa-photo-video text-white text-2xl"></i>
                            </div>
                            <span class="text-xs font-semibold text-blue-600 bg-blue-50 px-3 py-1 rounded-full">MEDIA</span>
                        </div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Gallery Items</p>
                        <p class="stat-number text-blue-600" id="stat-gallery">0</p>
                    </div>
                    <!-- Contacts Card -->
                    <div class="card bg-white rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-14 h-14 gradient-green rounded-xl flex items-center justify-center">
                                <i class="fas fa-envelope text-white text-2xl"></i>
                            </div>
                            <span class="text-xs font-semibold text-green-600 bg-green-50 px-3 py-1 rounded-full">INBOX</span>
                        </div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Messages</p>
                        <p class="stat-number text-green-600" id="stat-messages">0</p>
                    </div>
                    <!-- Bookings Card -->
                    <div class="card bg-white rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-14 h-14 gradient-orange rounded-xl flex items-center justify-center">
                                <i class="fas fa-calendar-check text-white text-2xl"></i>
                            </div>
                            <span class="text-xs font-semibold text-orange-600 bg-orange-50 px-3 py-1 rounded-full">PENDING</span>
                        </div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Bookings</p>
                        <p class="stat-number text-orange-600" id="stat-bookings">0</p>
                    </div>
                    <!-- Astro Services Card -->
                    <div class="card bg-white rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-14 h-14 gradient-pink rounded-xl flex items-center justify-center">
                                <i class="fas fa-star text-white text-2xl"></i>
                            </div>
                            <span class="text-xs font-semibold text-pink-600 bg-pink-50 px-3 py-1 rounded-full">SERVICES</span>
                        </div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Astro Services</p>
                        <p class="stat-number text-pink-600" id="stat-astro-services">0</p>
                    </div>
                    <!-- Pooja Services Card -->
                    <div class="card bg-white rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-14 h-14 gradient-indigo rounded-xl flex items-center justify-center">
                                <i class="fas fa-om text-white text-2xl"></i>
                            </div>
                            <span class="text-xs font-semibold text-indigo-600 bg-indigo-50 px-3 py-1 rounded-full">SPIRITUAL</span>
                        </div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Pooja Services</p>
                        <p class="stat-number text-indigo-600" id="stat-pooja-services">0</p>
                    </div>
                    <!-- Expert Solutions Card -->
                    <div class="card bg-white rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-14 h-14 gradient-teal rounded-xl flex items-center justify-center">
                                <i class="fas fa-hands-helping text-white text-2xl"></i>
                            </div>
                            <span class="text-xs font-semibold text-teal-600 bg-teal-50 px-3 py-1 rounded-full">SOLUTIONS</span>
                        </div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Expert Solutions</p>
                        <p class="stat-number text-teal-600" id="stat-expert-solutions">0</p>
                    </div>
                    <!-- Announcements Card -->
                    <div class="card bg-white rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-14 h-14 gradient-red rounded-xl flex items-center justify-center">
                                <i class="fas fa-bullhorn text-white text-2xl"></i>
                            </div>
                            <span class="text-xs font-semibold text-red-600 bg-red-50 px-3 py-1 rounded-full">UPDATES</span>
                        </div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Announcements</p>
                        <p class="stat-number text-red-600" id="stat-announcements">0</p>
                    </div>
                </div>
            </div>

            <div id="hero-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-images text-purple-600 mr-2"></i>Hero Slides Management
                        </h2>
                        <button id="add-hero-slide-btn" class="admin-btn admin-btn-primary">
                            <i class="fas fa-plus mr-2"></i>Add New Slide
                        </button>
                    </div>
                    
                    <div id="hero-slide-form-container" class="hidden admin-form">
                        <h3 class="text-lg font-bold mb-4">
                            <i class="fas fa-edit text-purple-600 mr-2"></i>Slide Details
                        </h3>
                        <form id="hero-slide-form" class="space-y-4">
                            <input type="hidden" id="hero-slide-id">
                            <div class="form-group">
                                <label for="hero-slide-title" class="form-label">
                                    <i class="fas fa-heading text-gray-500 mr-2"></i>Slide Title
                                </label>
                                <input type="text" id="hero-slide-title" class="admin-input" placeholder="Enter slide title..." required>
                            </div>
                            <div class="form-group">
                                <label for="hero-slide-description" class="form-label">
                                    <i class="fas fa-align-left text-gray-500 mr-2"></i>Description
                                </label>
                                <textarea id="hero-slide-description" rows="3" class="admin-input" placeholder="Enter slide description..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="hero-slide-image" class="form-label">
                                    <i class="fas fa-image text-gray-500 mr-2"></i>Slide Image
                                </label>
                                <input type="file" id="hero-slide-image" accept="image/*" class="admin-input">
                                <p class="text-sm text-gray-500 mt-1">Upload image (recommended: 1920x1080px)</p>
                            </div>
                            <div class="flex gap-4">
                                <button type="submit" class="admin-btn admin-btn-success">
                                    <i class="fas fa-save mr-2"></i>Save Slide
                                </button>
                                <button type="button" id="cancel-hero-slide-edit" class="admin-btn admin-btn-secondary">
                                    <i class="fas fa-times mr-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                    <div id="hero-slides-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Hero slides will be loaded here -->
                    </div>
                </div>
            </div>
            <div id="gallery-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-photo-video text-blue-600 mr-2"></i>Gallery Management
                        </h2>
                        <button id="add-gallery-image-btn" class="admin-btn admin-btn-primary">
                            <i class="fas fa-plus mr-2"></i>Add New Image
                        </button>
                    </div>
                    
                    <div id="gallery-image-form-container" class="hidden admin-form">
                        <h3 class="text-lg font-bold mb-4">
                            <i class="fas fa-image text-blue-600 mr-2"></i>Image Details
                        </h3>
                        <form id="gallery-image-form" class="space-y-4">
                            <input type="hidden" id="gallery-image-id">
                            <div class="form-group">
                                <label for="gallery-image-title" class="form-label">
                                    <i class="fas fa-tag text-gray-500 mr-2"></i>Image Title
                                </label>
                                <input type="text" id="gallery-image-title" class="admin-input" placeholder="Enter image title..." required>
                            </div>
                            <div class="form-group">
                                <label for="gallery-image-description" class="form-label">
                                    <i class="fas fa-align-left text-gray-500 mr-2"></i>Description
                                </label>
                                <textarea id="gallery-image-description" class="admin-input" rows="3" placeholder="Enter image description..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="gallery-image-file" class="form-label">
                                    <i class="fas fa-upload text-gray-500 mr-2"></i>Image File
                                </label>
                                <input type="file" id="gallery-image-file" accept="image/*" class="admin-input">
                                <p class="text-sm text-gray-500 mt-1">Supported formats: JPG, PNG, WebP</p>
                            </div>
                            <div class="flex gap-4">
                                <button type="submit" class="admin-btn admin-btn-success">
                                    <i class="fas fa-save mr-2"></i>Save Image
                                </button>
                                <button type="button" id="cancel-gallery-image-edit" class="admin-btn admin-btn-secondary">
                                    <i class="fas fa-times mr-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                    <div id="gallery-images-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Gallery images will be loaded here -->
                    </div>
                </div>
            </div>
            <div id="messages-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-envelope text-green-600 mr-2"></i>Contact Messages
                        </h2>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-gray-500">Total Messages:</span>
                            <span class="font-bold text-green-600" id="total-messages">0</span>
                        </div>
                    </div>
                    <div id="messages-list" class="space-y-4">
                        <!-- Messages will be loaded here -->
                    </div>
                </div>
            </div>
            <div id="bookings-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-calendar-check text-orange-600 mr-2"></i>Booking Requests
                        </h2>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-gray-500">Pending Bookings:</span>
                            <span class="font-bold text-orange-600" id="total-bookings">0</span>
                        </div>
                    </div>
                    <div id="bookings-list" class="space-y-4">
                        <!-- Bookings will be loaded here -->
                    </div>
                </div>
            </div>
            <div id="business-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-building text-indigo-600 mr-2"></i>Business Information
                    </h2>
                    <form id="business-info-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="form-group">
                                <label for="business-address" class="form-label">
                                    <i class="fas fa-map-marker-alt text-gray-500 mr-2"></i>Business Address
                                </label>
                                <textarea id="business-address" class="admin-input" rows="3" placeholder="Enter complete business address..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="business-email" class="form-label">
                                    <i class="fas fa-envelope text-gray-500 mr-2"></i>Contact Email
                                </label>
                                <input type="email" id="business-email" class="admin-input" placeholder="contact@example.com" required>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="form-group">
                                <label for="business-phone" class="form-label">
                                    <i class="fas fa-phone text-gray-500 mr-2"></i>Phone Number
                                </label>
                                <input type="tel" id="business-phone" class="admin-input" placeholder="+1 (555) 123-4567" required>
                            </div>
                            <div class="form-group">
                                <label for="business-whatsapp" class="form-label">
                                    <i class="fab fa-whatsapp text-green-500 mr-2"></i>WhatsApp Number
                                </label>
                                <input type="tel" id="business-whatsapp" class="admin-input" placeholder="+1 (555) 123-4567" required>
                                <p class="text-xs text-gray-500 mt-1">Include country code (e.g., 918431729319)</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="form-group">
                                <label for="business-website" class="form-label">
                                    <i class="fas fa-globe text-gray-500 mr-2"></i>Website URL
                                </label>
                                <input type="url" id="business-website" class="admin-input" placeholder="https://www.example.com">
                            </div>
                            <div class="form-group">
                                <label for="business-location" class="form-label">
                                    <i class="fas fa-map-marked-alt text-red-500 mr-2"></i>Google Maps Location URL
                                </label>
                                <input type="url" id="business-location" class="admin-input" placeholder="https://maps.app.goo.gl/...">
                                <p class="text-xs text-gray-500 mt-1">Share link from Google Maps for your business location</p>
                            </div>
                        </div>
                        
                        <!-- Business Hours Section -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="form-group">
                                <label for="business-hours-weekday" class="form-label">
                                    <i class="fas fa-clock text-gray-500 mr-2"></i>Weekday Hours (Mon-Sat)
                                </label>
                                <input type="text" id="business-hours-weekday" class="admin-input" placeholder="9:00 AM - 8:00 PM" required>
                            </div>
                            <div class="form-group">
                                <label for="business-hours-sunday" class="form-label">
                                    <i class="fas fa-calendar-day text-gray-500 mr-2"></i>Sunday Hours
                                </label>
                                <input type="text" id="business-hours-sunday" class="admin-input" placeholder="10:00 AM - 6:00 PM" required>
                            </div>
                        </div>
                        
                        <!-- Social Media Section -->
                        <div class="mt-8 pt-6 border-t border-gray-200">
                            <h3 class="text-lg font-bold mb-4 text-gray-800">
                                <i class="fas fa-share-alt text-blue-600 mr-2"></i>Social Media Links
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="form-group">
                                    <label for="facebook-url" class="form-label">
                                        <i class="fab fa-facebook text-blue-600 mr-2"></i>Facebook
                                    </label>
                                    <input type="url" id="facebook-url" class="admin-input" placeholder="https://facebook.com/yourpage">
                                </div>
                                <div class="form-group">
                                    <label for="instagram-url" class="form-label">
                                        <i class="fab fa-instagram text-pink-600 mr-2"></i>Instagram
                                    </label>
                                    <input type="url" id="instagram-url" class="admin-input" placeholder="https://instagram.com/yourpage">
                                </div>
                                <div class="form-group">
                                    <label for="youtube-url" class="form-label">
                                        <i class="fab fa-youtube text-red-600 mr-2"></i>YouTube
                                    </label>
                                    <input type="url" id="youtube-url" class="admin-input" placeholder="https://youtube.com/@yourchannel">
                                </div>
                                <div class="form-group">
                                    <label for="twitter-url" class="form-label">
                                        <i class="fab fa-twitter text-sky-500 mr-2"></i>Twitter
                                    </label>
                                    <input type="url" id="twitter-url" class="admin-input" placeholder="https://twitter.com/yourpage">
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center mt-6">
                            <button type="button" id="edit-business-btn" class="admin-btn admin-btn-primary px-8">
                                <i class="fas fa-edit mr-2"></i>Edit Business Information
                            </button>
                            <button type="submit" id="save-business-btn" class="admin-btn admin-btn-success px-8 hidden">
                                <i class="fas fa-save mr-2"></i>Save Business Information
                            </button>
                            <button type="button" id="cancel-business-btn" class="admin-btn admin-btn-secondary px-8 hidden">
                                <i class="fas fa-times mr-2"></i>Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="chatbot-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-robot text-purple-600 mr-2"></i>Chatbot Configuration
                        </h2>
                        <button type="button" id="edit-chatbot-btn" onclick="toggleChatbotEdit()" class="admin-btn admin-btn-secondary">
                            <i class="fas fa-edit mr-2"></i>Edit
                        </button>
                    </div>
                    
                    <form id="chatbot-config-form" class="space-y-6">
                        <!-- Google Maps URL -->
                        <div class="admin-form p-4">
                            <div class="form-group">
                                <label for="chatbot-google-maps" class="form-label">
                                    <i class="fas fa-map-marker-alt text-red-500 mr-2"></i>Google Maps Location URL
                                </label>
                                <input type="url" id="chatbot-google-maps" class="admin-input" placeholder="https://maps.app.goo.gl/...">
                                <p class="text-sm text-gray-500 mt-1">Share link from Google Maps</p>
                            </div>
                        </div>

                        <!-- Google Review URL -->
                        <div class="admin-form p-4">
                            <div class="form-group">
                                <label for="chatbot-google-review" class="form-label">
                                    <i class="fas fa-star text-yellow-500 mr-2"></i>Google Review URL
                                </label>
                                <input type="url" id="chatbot-google-review" class="admin-input" placeholder="https://maps.app.goo.gl/...">
                                <p class="text-sm text-gray-500 mt-1">Link where customers can leave reviews</p>
                            </div>
                        </div>

                        <!-- Services List -->
                        <div class="admin-form p-4">
                            <label class="form-label">
                                <i class="fas fa-list text-blue-500 mr-2"></i>Services Offered (One per line)
                            </label>
                            <textarea id="chatbot-services" class="admin-input" rows="8" placeholder="Kundali Reading&#10;Tarot Reading&#10;Career Guidance&#10;..."></textarea>
                            <p class="text-sm text-gray-500 mt-1">Each line is one service</p>
                        </div>

                        <!-- Social Media URLs -->
                        <div class="admin-form p-4">
                            <h3 class="text-lg font-bold mb-4 text-gray-700">
                                <i class="fas fa-share-alt text-green-500 mr-2"></i>Social Media Links
                            </h3>
                            <div class="space-y-3">
                                <div class="form-group">
                                    <label for="chatbot-facebook" class="form-label">Facebook</label>
                                    <input type="url" id="chatbot-facebook" class="admin-input" placeholder="https://facebook.com/...">
                                </div>
                                <div class="form-group">
                                    <label for="chatbot-instagram" class="form-label">Instagram</label>
                                    <input type="url" id="chatbot-instagram" class="admin-input" placeholder="https://instagram.com/...">
                                </div>
                                <div class="form-group">
                                    <label for="chatbot-twitter" class="form-label">Twitter</label>
                                    <input type="url" id="chatbot-twitter" class="admin-input" placeholder="https://twitter.com/...">
                                </div>
                                <div class="form-group">
                                    <label for="chatbot-youtube" class="form-label">YouTube</label>
                                    <input type="url" id="chatbot-youtube" class="admin-input" placeholder="https://youtube.com/...">
                                </div>
                                <div class="form-group">
                                    <label for="chatbot-linkedin" class="form-label">LinkedIn</label>
                                    <input type="url" id="chatbot-linkedin" class="admin-input" placeholder="https://linkedin.com/...">
                                </div>
                            </div>
                        </div>

                        <!-- Working Hours -->
                        <div class="admin-form p-4">
                            <h3 class="text-lg font-bold mb-4 text-gray-700">
                                <i class="fas fa-clock text-orange-500 mr-2"></i>Working Hours
                            </h3>
                            <div class="space-y-3">
                                <div class="form-group">
                                    <label for="chatbot-hours-weekday" class="form-label">Weekday Hours</label>
                                    <input type="text" id="chatbot-hours-weekday" class="admin-input" placeholder="9:00 AM - 8:00 PM">
                                </div>
                                <div class="form-group">
                                    <label for="chatbot-hours-sunday" class="form-label">Sunday Hours</label>
                                    <input type="text" id="chatbot-hours-sunday" class="admin-input" placeholder="9:00 AM - 2:00 PM">
                                </div>
                            </div>
                        </div>

                        <div id="chatbot-form-actions" class="flex gap-4" style="display: none;">
                            <button type="submit" class="admin-btn admin-btn-success flex-1">
                                <i class="fas fa-save mr-2"></i>Save Changes
                            </button>
                            <button type="button" onclick="cancelChatbotEdit()" class="admin-btn admin-btn-danger">
                                <i class="fas fa-times mr-2"></i>Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- About Section -->
            <div id="about-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-user-tie text-purple-600 mr-2"></i>About Section Configuration
                        </h2>
                        <button id="edit-about-btn" onclick="enableAboutEdit()" class="admin-btn admin-btn-primary">
                            <i class="fas fa-edit mr-2"></i>Edit
                        </button>
                    </div>
                    <form id="about-form" class="space-y-4">
                        <div class="form-group">
                            <label for="about-name" class="form-label">
                                <i class="fas fa-user text-gray-500 mr-2"></i>Name
                            </label>
                            <input type="text" id="about-name" class="admin-input" readonly placeholder="e.g., Pandit Rajesh Sharma">
                        </div>
                        
                        <div class="form-group">
                            <label for="about-description" class="form-label">
                                <i class="fas fa-align-left text-gray-500 mr-2"></i>Description
                            </label>
                            <textarea id="about-description" class="admin-input" rows="4" readonly placeholder="Enter a detailed description..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="about-experience" class="form-label">
                                <i class="fas fa-calendar-alt text-gray-500 mr-2"></i>Years of Experience
                            </label>
                            <input type="text" id="about-experience" class="admin-input" readonly placeholder="e.g., 15+ Years">
                        </div>
                        
                        <div class="form-group">
                            <label for="about-expertise" class="form-label">
                                <i class="fas fa-star text-gray-500 mr-2"></i>Expertise Areas
                            </label>
                            <input type="text" id="about-expertise" class="admin-input" readonly placeholder="e.g., Vedic Astrology, Tarot Reading, Vastu Shastra">
                        </div>
                        
                        <div class="form-group">
                            <label for="about-location" class="form-label">
                                <i class="fas fa-map-marker-alt text-gray-500 mr-2"></i>Location
                            </label>
                            <input type="text" id="about-location" class="admin-input" readonly placeholder="e.g., Mumbai, Maharashtra">
                        </div>
                        
                        <div class="form-group">
                            <label for="about-predictions" class="form-label">
                                <i class="fas fa-check-circle text-gray-500 mr-2"></i>Accurate Predictions
                            </label>
                            <input type="text" id="about-predictions" class="admin-input" readonly placeholder="e.g., 10,000+ Accurate Predictions">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-image text-gray-500 mr-2"></i>Astrologer Image
                            </label>
                            <div class="space-y-3">
                                <input type="file" id="about-image-file" accept="image/*" class="admin-input" disabled>
                                <input type="text" id="about-image-url" class="admin-input" readonly placeholder="Image URL will appear here">
                                <button type="button" id="about-upload-btn" onclick="uploadAboutImage()" class="admin-btn admin-btn-secondary" disabled>
                                    <i class="fas fa-upload mr-2"></i>Upload Image
                                </button>
                                <div id="about-image-preview" class="mt-4"></div>
                            </div>
                        </div>
                        
                        <div id="about-form-actions" class="flex gap-3" style="display: none;">
                            <button type="submit" class="flex-1 admin-btn admin-btn-success">
                                <i class="fas fa-save mr-2"></i>Save Changes
                            </button>
                            <button type="button" onclick="cancelAboutEdit()" class="admin-btn admin-btn-danger">
                                <i class="fas fa-times mr-2"></i>Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Brand Settings Section (replaces Navbar & Website Settings) -->
            <div id="brand-settings-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-palette text-purple-600 mr-2"></i>Brand & Navigation Settings
                        </h2>
                        <button id="brand-edit-btn" type="button" class="admin-btn admin-btn-secondary">
                            <i class="fas fa-edit mr-2"></i>Edit
                        </button>
                    </div>
                    
                    <form id="brand-settings-form" class="space-y-6">
                        <!-- Logo & Branding -->
                        <div class="border-b pb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <i class="fas fa-image mr-2"></i>Logo & Branding
                            </h3>
                            <div class="form-group max-w-md">
                                <label class="form-label">
                                    <i class="fas fa-image mr-2"></i>Website Logo
                                </label>
                                <input type="file" id="brand-logo" accept="image/*" class="admin-input brand-input" onchange="previewBrandLogo(event)" disabled>
                                <p class="text-sm text-gray-500 mt-1">Recommended: 200x200px, PNG with transparent background</p>
                                <div id="brand-logo-preview" class="mt-3 hidden">
                                    <img src="" alt="Logo preview" class="h-24 object-contain border rounded-lg p-3 bg-gray-50">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Website Identity -->
                        <div class="border-b pb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <i class="fas fa-heading mr-2"></i>Website Identity
                            </h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-heading mr-2"></i>Website Name
                                    </label>
                                    <input type="text" id="brand-website-name" class="admin-input brand-input" placeholder="Cosmic Astrology" required readonly>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-text-height mr-2"></i>Website Subtitle 1 (Main)
                                    </label>
                                    <input type="text" id="brand-website-subtitle1" class="admin-input brand-input" placeholder="Your Cosmic Guide to Life" readonly>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-text-height mr-2"></i>Website Subtitle 2
                                    </label>
                                    <input type="text" id="brand-website-subtitle2" class="admin-input brand-input" placeholder="Discover Your Destiny" readonly>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-text-height mr-2"></i>Website Subtitle 3
                                    </label>
                                    <input type="text" id="brand-website-subtitle3" class="admin-input brand-input" placeholder="Unlock the Secrets of the Stars" readonly>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Brand Colors -->
                        <div class="border-b pb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <i class="fas fa-palette mr-2"></i>Brand Colors
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-paint-brush mr-2"></i>Primary Color
                                    </label>
                                    <input type="color" id="brand-primary-color" class="admin-input brand-input w-full h-12" value="#667eea" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-fill-drip mr-2"></i>Secondary Color
                                    </label>
                                    <input type="color" id="brand-secondary-color" class="admin-input brand-input w-full h-12" value="#764ba2" readonly>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Navbar Layout Settings -->
                        <div class="border-b pb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <i class="fas fa-sliders-h mr-2"></i>Navbar Layout Control
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-arrows-alt-h mr-2"></i>Logo Position
                                    </label>
                                    <select id="brand-logo-position" class="admin-input brand-input" disabled>
                                        <option value="left">Left</option>
                                        <option value="center">Center</option>
                                        <option value="right">Right</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-text-width mr-2"></i>Website Name Position
                                    </label>
                                    <select id="brand-name-position" class="admin-input brand-input" disabled>
                                        <option value="left">Left (Next to Logo)</option>
                                        <option value="center">Center</option>
                                        <option value="hidden">Hidden</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-ruler-vertical mr-2"></i>Navbar Height
                                    </label>
                                    <select id="brand-navbar-height" class="admin-input brand-input" disabled>
                                        <option value="small">Small (60px)</option>
                                        <option value="medium">Medium (80px)</option>
                                        <option value="large">Large (100px)</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-palette mr-2"></i>Navbar Style
                                    </label>
                                    <select id="brand-navbar-style" class="admin-input brand-input" disabled>
                                        <option value="gradient">Gradient (Purple to Pink)</option>
                                        <option value="solid">Solid Color</option>
                                        <option value="transparent">Transparent</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-language mr-2"></i>Language Dropdown
                                    </label>
                                    <div class="flex items-center space-x-3">
                                        <input type="checkbox" id="brand-show-language" class="brand-input" disabled>
                                        <span class="text-sm text-gray-600">Show language selection dropdown in navbar</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Services Section Backgrounds -->
                        <div class="border-b pb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <i class="fas fa-image text-purple-600 mr-2"></i>Services Section Backgrounds
                            </h3>
                            <p class="text-gray-600 text-sm mb-4">
                                <i class="fas fa-info-circle mr-1"></i>Add optional background images for service sections on the website
                            </p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-star mr-2"></i>Astrological Services Background
                                    </label>
                                    <input type="file" id="brand-astro-bg" accept="image/*" class="admin-input brand-input" onchange="previewServiceBg(event, 'astro')" disabled>
                                    <p class="text-xs text-gray-500 mt-1">Recommended: 1920x600px JPG or PNG</p>
                                    <div id="brand-astro-bg-preview" class="mt-3 hidden">
                                        <img src="" alt="Preview" class="h-20 object-cover border rounded-lg bg-gray-50">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-hands-praying mr-2"></i>Pooja Services Background
                                    </label>
                                    <input type="file" id="brand-pooja-bg" accept="image/*" class="admin-input brand-input" onchange="previewServiceBg(event, 'pooja')" disabled>
                                    <p class="text-xs text-gray-500 mt-1">Recommended: 1920x600px JPG or PNG</p>
                                    <div id="brand-pooja-bg-preview" class="mt-3 hidden">
                                        <img src="" alt="Preview" class="h-20 object-cover border rounded-lg bg-gray-50">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="brand-btn-group" class="hidden">
                            <button type="submit" class="admin-btn admin-btn-success mr-3">
                                <i class="fas fa-save mr-2"></i>Save Changes
                            </button>
                            <button type="button" id="brand-cancel-btn" class="admin-btn admin-btn-secondary">
                                <i class="fas fa-times mr-2"></i>Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Announcements Management Section -->
            <div id="announcements-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-bullhorn text-orange-600 mr-2"></i>Announcement Bar Management
                        </h2>
                        <button onclick="showAnnouncementForm()" class="admin-btn admin-btn-success">
                            <i class="fas fa-plus mr-2"></i>Add Announcement
                        </button>
                    </div>
                    
                    <!-- Announcement Form -->
                    <div id="announcement-form-container" class="hidden mb-6 p-4 bg-orange-50 rounded-xl">
                        <form id="announcement-form">
                            <input type="hidden" id="announcement-id">
                            <div class="space-y-4 mb-4">
                                <input type="text" id="announcement-text" class="admin-input" placeholder="Announcement Text" required>
                                <div class="flex items-center space-x-4">
                                    <label class="flex items-center space-x-2">
                                        <input type="checkbox" id="announcement-active" checked class="w-5 h-5 text-purple-600">
                                        <span class="font-medium">Active</span>
                                    </label>
                                    <input type="number" id="announcement-order" class="admin-input w-32" placeholder="Order" value="0">
                                </div>
                            </div>
                            <div class="flex gap-3">
                                <button type="submit" class="admin-btn admin-btn-success">
                                    <i class="fas fa-save mr-2"></i>Save Announcement
                                </button>
                                <button type="button" onclick="cancelAnnouncementEdit()" class="admin-btn admin-btn-secondary">
                                    <i class="fas fa-times mr-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="announcements-list" class="space-y-3">
                        <!-- Announcements will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Astrological Services Management Section -->
            <div id="astrological-services-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-star text-purple-600 mr-2"></i>Astrological Services
                        </h2>
                        <button onclick="showAstroServiceForm()" class="admin-btn admin-btn-success">
                            <i class="fas fa-plus mr-2"></i>Add Service
                        </button>
                    </div>
                    
                    <p class="text-gray-600 mb-4 text-sm">
                        <i class="fas fa-info-circle mr-1"></i>Services will display as icon cards with watercolor splash backgrounds on the website
                    </p>
                    
                    <!-- Service Form with Background Removal -->
                    <div id="astro-service-form-container" class="hidden mb-6 p-4 bg-purple-50 rounded-xl">
                        <form id="astro-service-form">
                            <input type="hidden" id="astro-service-id">
                            
                            <div class="form-group mb-4">
                                <label class="form-label">
                                    <i class="fas fa-heading mr-2"></i>Service Title *
                                </label>
                                <input type="text" id="astro-service-title" class="admin-input" placeholder="e.g., Palmistry, Numerology, Kundli" required>
                            </div>
                            
                            <div class="form-group mb-4">
                                <label class="form-label">
                                    <i class="fas fa-image mr-2"></i>Service Icon/Image
                                    <span class="text-xs text-gray-500">(Auto Background Removal)</span>
                                </label>
                                <input type="file" id="astro-service-icon" accept="image/*" class="admin-input" onchange="previewAstroServiceIcon(event)">
                                <div class="text-xs text-gray-500 mt-1">
                                    <i class="fas fa-magic mr-1"></i>Background will be automatically removed for clean transparent icons
                                </div>
                                <div id="astro-service-icon-preview" class="mt-3 hidden">
                                    <div class="relative inline-block">
                                        <img src="" alt="Icon preview" class="w-20 h-20 object-contain border-2 border-purple-200 rounded-lg p-2 bg-white shadow-sm">
                                        <div class="absolute -top-2 -right-2 bg-purple-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">
                                            <i class="fas fa-magic"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-6 mb-4">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" id="astro-service-active" checked class="w-5 h-5 text-purple-600 rounded">
                                    <span class="font-medium text-gray-700">Active</span>
                                </label>
                                <div class="flex items-center space-x-2">
                                    <label class="font-medium text-gray-700">Display Order:</label>
                                    <input type="number" id="astro-service-order" class="admin-input w-20" placeholder="0" value="0" min="0">
                                </div>
                            </div>
                            
                            <div class="flex gap-3">
                                <button type="submit" class="admin-btn admin-btn-success">
                                    <i class="fas fa-save mr-2"></i>Save Service
                                </button>
                                <button type="button" onclick="cancelAstroServiceEdit()" class="admin-btn admin-btn-secondary">
                                    <i class="fas fa-times mr-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="astro-services-list" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                        <!-- Services will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Pooja Services Management Section -->
            <div id="pooja-services-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-om text-orange-600 mr-2"></i>Pooja & Ritual Services
                        </h2>
                        <button onclick="showPoojaServiceForm()" class="admin-btn admin-btn-success">
                            <i class="fas fa-plus mr-2"></i>Add Pooja
                        </button>
                    </div>
                    
                    <!-- Pooja Form -->
                    <div id="pooja-service-form-container" class="hidden mb-6 p-4 bg-orange-50 rounded-xl">
                        <form id="pooja-service-form">
                            <input type="hidden" id="pooja-service-id">
                            <div class="grid md:grid-cols-2 gap-4 mb-4">
                                <input type="text" id="pooja-service-title" class="admin-input" placeholder="Pooja Title" required>
                                <div>
                                    <input type="file" id="pooja-service-image" accept="image/*" class="admin-input" onchange="previewPoojaServiceImage(event)">
                                    <div id="pooja-service-image-preview" class="mt-2 hidden">
                                        <img src="" alt="Image preview" class="w-20 h-20 rounded-full object-cover border">
                                    </div>
                                </div>
                            </div>
                            <textarea id="pooja-service-description" rows="3" class="admin-input mb-4" placeholder="Pooja Description"></textarea>
                            <div class="flex items-center space-x-4 mb-4">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" id="pooja-service-active" checked class="w-5 h-5 text-orange-600">
                                    <span class="font-medium">Active</span>
                                </label>
                                <input type="number" id="pooja-service-order" class="admin-input w-32" placeholder="Order" value="0">
                            </div>
                            <div class="flex gap-3">
                                <button type="submit" class="admin-btn admin-btn-success">
                                    <i class="fas fa-save mr-2"></i>Save Pooja
                                </button>
                                <button type="button" onclick="cancelPoojaServiceEdit()" class="admin-btn admin-btn-secondary">
                                    <i class="fas fa-times mr-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="pooja-services-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Poojas will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Expert Solutions Management Section -->
            <div id="expert-solutions-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-hands-helping text-purple-600 mr-2"></i>Expert Solutions
                        </h2>
                        <button onclick="showExpertSolutionForm()" class="admin-btn admin-btn-success">
                            <i class="fas fa-plus mr-2"></i>Add Solution
                        </button>
                    </div>
                    
                    <!-- Solution Form -->
                    <div id="expert-solution-form-container" class="hidden mb-6 p-4 bg-purple-50 rounded-xl">
                        <form id="expert-solution-form">
                            <input type="hidden" id="expert-solution-id">
                            <div class="grid md:grid-cols-2 gap-4 mb-4">
                                <input type="text" id="expert-solution-title" class="admin-input" placeholder="Solution Title" required>
                                <div>
                                    <input type="file" id="expert-solution-image" accept="image/*" class="admin-input" onchange="previewExpertSolutionImage(event)">
                                    <div id="expert-solution-image-preview" class="mt-2 hidden">
                                        <img src="" alt="Image preview" class="w-24 h-16 object-cover border rounded">
                                    </div>
                                </div>
                            </div>
                            <textarea id="expert-solution-description" rows="4" class="admin-input mb-4" placeholder="Solution Description" required></textarea>
                            <div class="flex items-center space-x-4 mb-4">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" id="expert-solution-active" checked class="w-5 h-5 text-purple-600">
                                    <span class="font-medium">Active</span>
                                </label>
                                <input type="number" id="expert-solution-order" class="admin-input w-32" placeholder="Order" value="0">
                            </div>
                            <div class="flex gap-3">
                                <button type="submit" class="admin-btn admin-btn-success">
                                    <i class="fas fa-save mr-2"></i>Save Solution
                                </button>
                                <button type="button" onclick="cancelExpertSolutionEdit()" class="admin-btn admin-btn-secondary">
                                    <i class="fas fa-times mr-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="expert-solutions-list" class="space-y-4">
                        <!-- Solutions will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Client Reviews Management Section -->
            <div id="reviews-section" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-star text-purple-600 mr-2"></i>Client Reviews
                        </h2>
                        <button onclick="showReviewForm()" class="admin-btn admin-btn-success">
                            <i class="fas fa-plus mr-2"></i>Add Review
                        </button>
                    </div>
                    
                    <!-- Review Form -->
                    <div id="review-form-container" class="hidden mb-6 p-4 bg-purple-50 rounded-xl">
                        <form id="review-form">
                            <input type="hidden" id="review-id">
                            <div class="grid md:grid-cols-2 gap-4 mb-4">
                                <input type="text" id="review-name" class="admin-input" placeholder="Client Name *" required>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Rating *</label>
                                    <select id="review-rating" class="admin-input" required>
                                        <option value="">Select Rating</option>
                                        <option value="5"> (5 Stars)</option>
                                        <option value="4"> (4 Stars)</option>
                                        <option value="3"> (3 Stars)</option>
                                        <option value="2"> (2 Stars)</option>
                                        <option value="1"> (1 Star)</option>
                                    </select>
                                </div>
                            </div>
                            <textarea id="review-text" rows="4" class="admin-input mb-4" placeholder="Review Text *" required></textarea>
                            <div class="grid md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Client Photo (Optional)</label>
                                    <input type="file" id="review-image" accept="image/*" class="admin-input" onchange="previewReviewImage(event)">
                                    <div id="review-image-preview" class="mt-2 hidden">
                                        <img src="" alt="Image preview" class="w-16 h-16 object-cover rounded-full border">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Display Order</label>
                                    <input type="number" id="review-order" class="admin-input" placeholder="Order" value="0">
                                </div>
                            </div>
                            <div class="flex items-center space-x-4 mb-4">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" id="review-active" checked class="w-5 h-5 text-purple-600">
                                    <span class="font-medium">Active (Display on Website)</span>
                                </label>
                            </div>
                            <div class="flex gap-3">
                                <button type="submit" class="admin-btn admin-btn-success">
                                    <i class="fas fa-save mr-2"></i>Save Review
                                </button>
                                <button type="button" onclick="cancelReviewEdit()" class="admin-btn admin-btn-secondary">
                                    <i class="fas fa-times mr-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="reviews-list" class="space-y-4">
                        <!-- Reviews will be loaded here -->
                    </div>
                </div>
            </div>



            <div id="settings-section" class="tab-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Password Change Section -->
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <h2 class="text-xl font-bold mb-6 text-gray-800">
                            <i class="fas fa-lock text-red-600 mr-2"></i>Change Password
                        </h2>
                        <form id="change-password-form" class="space-y-4">
                            <div class="form-group">
                                <label for="current-password" class="form-label">
                                    <i class="fas fa-key text-gray-500 mr-2"></i>Current Password
                                </label>
                                <input type="password" id="current-password" autocomplete="current-password" class="admin-input" placeholder="Enter current password..." required>
                            </div>
                            <div class="form-group">
                                <label for="new-password" class="form-label">
                                    <i class="fas fa-lock text-gray-500 mr-2"></i>New Password
                                </label>
                                <input type="password" id="new-password" autocomplete="new-password" class="admin-input" placeholder="Enter new password..." required>
                                <p class="text-sm text-gray-500 mt-1">Password must be at least 6 characters long</p>
                            </div>
                            <div class="form-group">
                                <label for="confirm-password" class="form-label">
                                    <i class="fas fa-check-circle text-gray-500 mr-2"></i>Confirm New Password
                                </label>
                                <input type="password" id="confirm-password" autocomplete="new-password" class="admin-input" placeholder="Confirm new password..." required>
                            </div>
                            <button type="submit" class="admin-btn admin-btn-success w-full">
                                <i class="fas fa-shield-alt mr-2"></i>Update Password
                            </button>
                        </form>
                    </div>

                    <!-- System Information Section -->
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <h2 class="text-xl font-bold mb-6 text-gray-800">
                            <i class="fas fa-info-circle text-blue-600 mr-2"></i>System Information
                        </h2>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-medium text-gray-600">Admin Version</span>
                                <span class="font-bold text-gray-800">v2.1.0</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-medium text-gray-600">Last Login</span>
                                <span class="font-bold text-gray-800" id="last-login-time">Just now</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-medium text-gray-600">System Status</span>
                                <span class="font-bold text-green-600">
                                    <i class="fas fa-circle text-xs mr-1"></i>Active
                                </span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-medium text-gray-600">Database</span>
                                <span class="font-bold text-green-600">
                                    <i class="fas fa-database mr-1"></i>Connected
                                </span>
                            </div>
                        </div>
                        <div class="mt-6 text-center">
                            <button onclick="logout()" class="admin-btn admin-btn-danger px-8">
                                <i class="fas fa-sign-out-alt mr-2"></i>Logout Securely
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Testimonial Modal -->
    <div id="testimonial-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-yellow-500 to-orange-500 text-white p-6 rounded-t-2xl">
                <h3 class="text-2xl font-bold" id="testimonial-modal-title">
                    <i class="fas fa-star mr-2"></i>Add Testimonial
                </h3>
            </div>
            <form id="testimonial-form" class="p-6 space-y-4">
                <input type="hidden" id="testimonial-id">
                
                <div class="form-group">
                    <label for="testimonial-client-name" class="form-label">
                        <i class="fas fa-user text-gray-500 mr-2"></i>Client Name
                    </label>
                    <input type="text" id="testimonial-client-name" class="admin-input" placeholder="John Doe" required>
                </div>
                
                <div class="form-group">
                    <label for="testimonial-rating" class="form-label">
                        <i class="fas fa-star text-yellow-500 mr-2"></i>Rating (1-5)
                    </label>
                    <select id="testimonial-rating" class="admin-input" required>
                        <option value="">Select Rating</option>
                        <option value="5"> (5 Stars)</option>
                        <option value="4"> (4 Stars)</option>
                        <option value="3"> (3 Stars)</option>
                        <option value="2"> (2 Stars)</option>
                        <option value="1"> (1 Star)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="testimonial-review" class="form-label">
                        <i class="fas fa-comment text-gray-500 mr-2"></i>Review Text
                    </label>
                    <textarea id="testimonial-review" class="admin-input" rows="4" placeholder="Enter the client's review..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="testimonial-google-url" class="form-label">
                        <i class="fab fa-google text-red-500 mr-2"></i>Google Review URL (Optional)
                    </label>
                    <input type="url" id="testimonial-google-url" class="admin-input" placeholder="https://maps.app.goo.gl/...">
                    <p class="text-sm text-gray-500 mt-1">Link to the original Google review</p>
                </div>
                
                <div class="form-group">
                    <label for="testimonial-image-url" class="form-label">
                        <i class="fas fa-image text-gray-500 mr-2"></i>Client Image URL (Optional)
                    </label>
                    <input type="url" id="testimonial-image-url" class="admin-input" placeholder="https://example.com/image.jpg">
                    <p class="text-sm text-gray-500 mt-1">Link to client's profile image</p>
                </div>
                
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="flex-1 admin-btn admin-btn-success">
                        <i class="fas fa-save mr-2"></i>Save Testimonial
                    </button>
                    <button type="button" onclick="closeTestimonialModal()" class="flex-1 admin-btn admin-btn-secondary">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Admin Login
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const password = document.getElementById('admin-password').value;
            
            try {
                const response = await fetch('/api/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('login-screen').classList.add('hidden');
                    document.getElementById('admin-dashboard').classList.remove('hidden');
                    loadDashboardData();
                    initializeBusinessForm();
                    initializeChatbotForm();
                } else {
                    document.getElementById('login-error').classList.remove('hidden');
                }
            } catch (error) {
                console.error('Login error:', error);
                document.getElementById('login-error').classList.remove('hidden');
            }
        });

        function logout() {
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('admin-dashboard').classList.add('hidden');
            document.getElementById('admin-password').value = '';
            document.getElementById('login-error').classList.add('hidden');
        }
        
        // Password Change Form Handler
        document.getElementById('change-password-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (newPassword !== confirmPassword) {
                showNotification('Passwords do not match!', 'error');
                return;
            }
            
            if (newPassword.length < 6) {
                showNotification('Password must be at least 6 characters long!', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/admin/change-password', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        currentPassword: currentPassword,
                        newPassword: newPassword
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('Password changed successfully!', 'success');
                    document.getElementById('change-password-form').reset();
                } else {
                    showNotification(data.message || 'Failed to change password', 'error');
                }
            } catch (error) {
                console.error('Password change error:', error);
                showNotification('Failed to change password', 'error');
            }
        });

        // Tab Switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabName = btn.dataset.tab;
                
                // Update buttons
                document.querySelectorAll('.tab-btn').forEach(b => {
                    b.classList.remove('active', 'gradient-purple', 'text-white');
                    b.classList.add('text-gray-600', 'hover:bg-gray-100');
                });
                btn.classList.add('active', 'gradient-purple', 'text-white');
                btn.classList.remove('text-gray-600', 'hover:bg-gray-100');
                
                // Update content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                document.getElementById(tabName + '-section').classList.remove('hidden');
                
                // Load data for the tab
                if (tabName === 'hero') loadHeroSlides();
                if (tabName === 'gallery') loadGallerySlides();
                if (tabName === 'bookings') loadBookings();
                if (tabName === 'messages') loadMessages();
                if (tabName === 'business') {
                    loadBusinessInfo();
                    loadBrandSettings();
                }
                if (tabName === 'chatbot') loadChatbotConfig();
                if (tabName === 'about') loadAboutSection();
                if (tabName === 'announcements') loadAnnouncements();
                if (tabName === 'astrological-services') loadAstrologicalServices();
                if (tabName === 'pooja-services') loadPoojaServices();
                if (tabName === 'expert-solutions') loadExpertSolutions();
                if (tabName === 'reviews') loadReviewsAdmin();
                if (tabName === 'brand-settings') {
                    loadBrandSettings();
                }
            });
        });

        // Load Dashboard Data
        async function loadDashboardData() {
            try {
                const [hero, gallery, bookings, messages] = await Promise.all([
                    fetch('/api/hero-slides').then(r => r.json()),
                    fetch('/api/gallery-slides').then(r => r.json()),
                    fetch('/api/bookings').then(r => r.json()),
                    fetch('/api/contact-messages').then(r => r.json())
                ]);
                
                // Handle both array and {success, slides/leads} formats
                const heroData = Array.isArray(hero) ? hero : (hero.slides || []);
                const galleryData = Array.isArray(gallery) ? gallery : (gallery.slides || []);
                const bookingsData = Array.isArray(bookings) ? bookings : (bookings.leads || []);
                const messagesData = Array.isArray(messages) ? messages : (messages.messages || []);
                
                document.getElementById('stat-hero').textContent = heroData.length || 0;
                document.getElementById('stat-gallery').textContent = galleryData.length || 0;
                document.getElementById('stat-bookings').textContent = bookingsData.length || 0;
                document.getElementById('stat-messages').textContent = messagesData.length || 0;
                
                // Load stats for new cards
                const [astroServices, poojaServices, expertSolutions, announcements] = await Promise.all([
                    fetch('/api/astrological-services').then(r => r.json()).catch(() => []),
                    fetch('/api/pooja-services').then(r => r.json()).catch(() => []),
                    fetch('/api/expert-solutions').then(r => r.json()).catch(() => []),
                    fetch('/api/announcements').then(r => r.json()).catch(() => [])
                ]);
                
                document.getElementById('stat-astro-services').textContent = (Array.isArray(astroServices) ? astroServices : (astroServices.services || [])).length || 0;
                document.getElementById('stat-pooja-services').textContent = (Array.isArray(poojaServices) ? poojaServices : (poojaServices.services || [])).length || 0;
                document.getElementById('stat-expert-solutions').textContent = (Array.isArray(expertSolutions) ? expertSolutions : (expertSolutions.solutions || [])).length || 0;
                document.getElementById('stat-announcements').textContent = (Array.isArray(announcements) ? announcements : (announcements.announcements || [])).length || 0;
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
            }
        }

        // Load Hero Slides
        async function loadHeroSlides() {
            try {
                const response = await fetch('/api/hero-slides');
                const data = await response.json();
                const slides = Array.isArray(data) ? data : (data.slides || []);
                
                const container = document.getElementById('hero-slides-list');
                container.innerHTML = slides.map(slide => `
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <div class="w-full h-48 mb-4 rounded-lg overflow-hidden bg-gray-100">
                            <img src="${slide.image}" alt="${slide.title}" class="w-full h-full object-cover object-center" style="object-fit: cover;" onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect fill=%22%23667eea%22 width=%22400%22 height=%22300%22/%3E%3Ctext fill=%22white%22 font-size=%2220%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22%3EImage Not Available%3C/text%3E%3C/svg%3E'" loading="lazy">
                        </div>
                        <h3 class="font-bold text-lg mb-2">${slide.title}</h3>
                        <p class="text-gray-600 mb-4">${slide.description || ''}</p>
                        <div class="flex gap-2">
                            <button onclick="editHeroSlide(${slide.id})" class="btn btn-primary flex-1">
                                <i class="fas fa-edit mr-2"></i>Edit
                            </button>
                            <button onclick="deleteHeroSlide(${slide.id})" class="btn btn-danger flex-1">
                                <i class="fas fa-trash mr-2"></i>Delete
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading hero slides:', error);
            }
        }

        // Load Gallery Slides
        async function loadGallerySlides() {
            try {
                const response = await fetch('/api/gallery-slides');
                const data = await response.json();
                const slides = Array.isArray(data) ? data : (data.slides || []);
                
                const container = document.getElementById('gallery-images-list');
                if (!container) {
                    console.error('Gallery container not found');
                    return;
                }
                container.innerHTML = slides.map(slide => `
                    <div class="bg-white rounded-xl overflow-hidden shadow-lg">
                        <div class="w-full h-48 overflow-hidden bg-gray-100">
                            <img src="${slide.image}" alt="${slide.title}" class="w-full h-full object-cover object-center" style="object-fit: cover;" onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect fill=%22%2364748b%22 width=%22400%22 height=%22300%22/%3E%3Ctext fill=%22white%22 font-size=%2220%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22%3EImage Not Available%3C/text%3E%3C/svg%3E'" loading="lazy">
                        </div>
                        <div class="p-4">
                            <h4 class="font-semibold mb-2">${slide.title}</h4>
                            <p class="text-sm text-gray-600 mb-3">${slide.description || ''}</p>
                            <div class="flex gap-2">
                                <button onclick="editGallerySlide(${slide.id})" class="btn btn-secondary flex-1">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </button>
                                <button onclick="deleteGallerySlide(${slide.id})" class="btn btn-danger flex-1">
                                    <i class="fas fa-trash mr-1"></i>Delete
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading gallery slides:', error);
            }
        }

        // Load Bookings
        async function loadBookings() {
            try {
                const response = await fetch('/api/bookings');
                const data = await response.json();
                const bookings = Array.isArray(data) ? data : (data.leads || []);
                
                const container = document.getElementById('bookings-list');
                container.innerHTML = bookings.map(booking => `
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-bold text-lg">${booking.name}</h3>
                                <p class="text-gray-600">${booking.phone}</p>
                                <p class="text-gray-600">${booking.email || ''}</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-sm font-semibold ${booking.status === 'confirmed' ? 'bg-green-100 text-green-600' : 'bg-yellow-100 text-yellow-600'}">
                                ${booking.status}
                            </span>
                        </div>
                        <p class="text-sm text-gray-600 mb-2"><strong>Service:</strong> ${booking.service || 'N/A'}</p>
                        <p class="text-sm text-gray-600 mb-2"><strong>Date:</strong> ${booking.booking_date || 'N/A'}</p>
                        <p class="text-sm text-gray-600 mb-4"><strong>Message:</strong> ${booking.message || 'None'}</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 mb-3">
                            <a href="javascript:void(0)" onclick="openWhatsAppBooking('${booking.phone.replace(/[^0-9]/g, '')}', '${booking.name}', '${booking.service || 'consultation'}', '${booking.booking_date || 'TBD'}')" class="btn btn-success text-center" style="background: #25D366; color: white; padding: 10px; border-radius: 8px; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px; cursor: pointer;">
                                <i class="fab fa-whatsapp"></i><span>WhatsApp</span>
                            </a>
                            <a href="tel:${booking.phone}" class="btn text-center" style="background: linear-gradient(to right, #7C3AED, #EC4899); color: white; padding: 10px; border-radius: 8px; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <i class="fas fa-phone"></i><span>Call</span>
                            </a>
                            ${booking.email ? `<a href="mailto:${booking.email}" class="btn text-center" style="background: linear-gradient(to right, #10B981, #3B82F6); color: white; padding: 10px; border-radius: 8px; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <i class="fas fa-envelope"></i><span>Email</span>
                            </a>` : ''}
                        </div>
                        <button onclick="deleteBooking(${booking.id})" class="btn btn-danger w-full">
                            <i class="fas fa-trash mr-2"></i>Delete
                        </button>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading bookings:', error);
            }
        }

        // Load Messages
        async function loadMessages() {
            try {
                const response = await fetch('/api/contact-messages');
                const data = await response.json();
                const messages = Array.isArray(data) ? data : (data.messages || []);
                
                const container = document.getElementById('messages-list');
                container.innerHTML = messages.map(msg => `
                    <div class="bg-white rounded-xl p-6 shadow-lg">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-bold text-lg">${msg.name}</h3>
                                <p class="text-gray-600">${msg.email}</p>
                                <p class="text-gray-600">${msg.phone || ''}</p>
                            </div>
                            <span class="text-xs text-gray-500">${new Date(msg.created_at).toLocaleDateString()}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-2"><strong>Subject:</strong> ${msg.subject || 'N/A'}</p>
                        <p class="text-sm text-gray-600 mb-4">${msg.message}</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 mb-3">
                            ${msg.phone ? `<a href="javascript:void(0)" onclick="openWhatsAppMessage('${msg.phone.replace(/[^0-9]/g, '')}', '${msg.name}', '${(msg.subject || '') + ' - ' + (msg.message || '')}')" class="btn text-center" style="background: #25D366; color: white; padding: 10px; border-radius: 8px; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px; cursor: pointer;">
                                <i class="fab fa-whatsapp"></i><span>WhatsApp</span>
                            </a>
                            <a href="tel:${msg.phone}" class="btn text-center" style="background: linear-gradient(to right, #7C3AED, #EC4899); color: white; padding: 10px; border-radius: 8px; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <i class="fas fa-phone"></i><span>Call</span>
                            </a>` : ''}
                            <a href="mailto:${msg.email}" class="btn text-center" style="background: linear-gradient(to right, #10B981, #3B82F6); color: white; padding: 10px; border-radius: 8px; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <i class="fas fa-envelope"></i><span>Email</span>
                            </a>
                        </div>
                        <button onclick="deleteMessage(${msg.id})" class="btn btn-danger w-full">
                            <i class="fas fa-trash mr-2"></i>Delete
                        </button>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading messages:', error);
            }
        }

        // Load Business Info
        // Load Business Information (from business_info table)
        async function loadBusinessInfo() {
            try {
                const response = await fetch('/api/business-info', {
                    cache: 'no-cache'  // Prevent caching to always get fresh data
                });
                if (!response.ok) {
                    console.error('Failed to load business info');
                    return;
                }
                const info = await response.json();
                
                if (info && Object.keys(info).length > 0) {
                    // Map business_info fields to form fields
                    if (document.getElementById('business-address')) {
                        document.getElementById('business-address').value = info.address || '';
                    }
                    if (document.getElementById('business-email')) {
                        document.getElementById('business-email').value = info.email || '';
                    }
                    if (document.getElementById('business-phone')) {
                        document.getElementById('business-phone').value = info.phone || '';
                    }
                    if (document.getElementById('business-whatsapp')) {
                        document.getElementById('business-whatsapp').value = info.whatsapp_number || '';
                    }
                    if (document.getElementById('business-website')) {
                        document.getElementById('business-website').value = info.website || '';
                    }
                    if (document.getElementById('business-location')) {
                        document.getElementById('business-location').value = info.google_location_url || '';
                    }
                    if (document.getElementById('business-hours-weekday')) {
                        document.getElementById('business-hours-weekday').value = info.hours_weekday || '';
                    }
                    if (document.getElementById('business-hours-sunday')) {
                        document.getElementById('business-hours-sunday').value = info.hours_sunday || '';
                    }
                    if (document.getElementById('facebook-url')) {
                        document.getElementById('facebook-url').value = info.facebook || '';
                    }
                    if (document.getElementById('instagram-url')) {
                        document.getElementById('instagram-url').value = info.instagram || '';
                    }
                    if (document.getElementById('youtube-url')) {
                        document.getElementById('youtube-url').value = info.youtube || '';
                    }
                    if (document.getElementById('twitter-url')) {
                        document.getElementById('twitter-url').value = info.twitter || '';
                    }
                }
            } catch (error) {
                console.error('Error loading business info:', error);
            }
        }

        // Apply navbar layout settings
        function applyNavbarLayout(settings) {
            // Apply logo position
            const logoContainer = document.querySelector('.logo-container');
            if (logoContainer && settings.logo_position) {
                logoContainer.className = `logo-container flex items-center justify-${settings.logo_position}`;
            }
            
            // Apply name position
            const nameContainer = document.querySelector('.website-name-container');
            if (nameContainer && settings.name_position) {
                nameContainer.className = `website-name-container text-${settings.name_position}`;
            }
            
            // Apply navbar height
            const navbar = document.getElementById('main-navbar');
            if (navbar && settings.navbar_height) {
                const heightClass = settings.navbar_height === 'small' ? 'h-12' : 
                                   settings.navbar_height === 'large' ? 'h-20' : 'h-16';
                navbar.className = navbar.className.replace(/h-\d+/, heightClass);
            }
        }
        
        // Load Brand & Navigation Settings (from navbar_settings table)
        async function loadBrandSettings() {
            try {
                const response = await fetch('/api/navbar-settings', {
                    cache: 'no-cache'  // Prevent caching to always get fresh data
                });
                if (!response.ok) {
                    console.error('Failed to load brand settings');
                    return;
                }
                const settings = await response.json();
                
                if (settings && Object.keys(settings).length > 0) {
                    // Load brand settings
                    if (document.getElementById('brand-website-name')) {
                        document.getElementById('brand-website-name').value = settings.name || 'Cosmic Astrology';
                    }
                    if (document.getElementById('brand-subtitle1')) {
                        document.getElementById('brand-subtitle1').value = settings.subtitle1 || '';
                    }
                    if (document.getElementById('brand-subtitle2')) {
                        document.getElementById('brand-subtitle2').value = settings.subtitle2 || '';
                    }
                    if (document.getElementById('brand-subtitle3')) {
                        document.getElementById('brand-subtitle3').value = settings.subtitle3 || '';
                    }
                    
                    // Display logo if available
                    if (settings.logo_url && document.getElementById('brand-logo-preview')) {
                        const preview = document.getElementById('brand-logo-preview');
                        preview.innerHTML = `<img src="${settings.logo_url}" alt="Logo" class="h-24 object-contain border rounded-lg p-3 bg-gray-50">`;
                        preview.classList.remove('hidden');
                        preview.dataset.currentUrl = settings.logo_url;
                    }
                    
                    // Load layout settings and apply them immediately
                    if (document.getElementById('brand-logo-position')) {
                        document.getElementById('brand-logo-position').value = settings.logo_position || 'left';
                    }
                    if (document.getElementById('brand-name-position')) {
                        document.getElementById('brand-name-position').value = settings.name_position || 'left';
                    }
                    if (document.getElementById('brand-navbar-height')) {
                        document.getElementById('brand-navbar-height').value = settings.navbar_height || 'medium';
                    }
                    if (document.getElementById('brand-navbar-style')) {
                        document.getElementById('brand-navbar-style').value = settings.navbar_style || 'solid';
                    }
                    
                    // Apply navbar layout changes immediately
                    applyNavbarLayout(settings);
                }
            } catch (error) {
                console.error('Error loading brand settings:', error);
            }
        }

        // Delete Functions
        async function deleteHeroSlide(id) {
            if (!confirm('Delete this hero slide?')) return;
            try {
                await fetch(`/api/hero-slides/${id}`, { method: 'DELETE' });
                loadHeroSlides();
                loadDashboardData();
            } catch (error) {
                console.error('Error deleting hero slide:', error);
                alert('Error deleting slide');
            }
        }

        async function editGallerySlide(id) {
            try {
                const response = await fetch(`/api/gallery-slides/${id}`);
                const slide = await response.json();
                
                // Show form
                document.getElementById('gallery-image-form-container').classList.remove('hidden');
                
                // Populate form fields
                document.getElementById('gallery-image-id').value = id;
                document.getElementById('gallery-image-title').value = slide.title || '';
                document.getElementById('gallery-image-description').value = slide.description || '';
                
                // Change button to update mode
                const submitBtn = document.querySelector('#gallery-image-form button[type="submit"]');
                submitBtn.textContent = 'Update Image';
                
                // Scroll to form
                document.getElementById('gallery-image-form-container').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Error loading gallery slide:', error);
                alert('Error loading image data');
            }
        }

        // Handle gallery form submission
        document.getElementById('gallery-image-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const id = document.getElementById('gallery-image-id').value;
            const title = document.getElementById('gallery-image-title').value;
            const description = document.getElementById('gallery-image-description').value;
            const fileInput = document.getElementById('gallery-image-file');
            
            let imageUrl = '';
            
            // Upload image if file selected
            if (fileInput.files.length > 0) {
                const formData = new FormData();
                formData.append('file', fileInput.files[0]);
                formData.append('folder', 'gallery');  // Specify gallery folder
                
                try {
                    const uploadResponse = await fetch('/api/upload', {
                        method: 'POST',
                        body: formData
                    });
                    const uploadData = await uploadResponse.json();
                    imageUrl = uploadData.url;
                } catch (error) {
                    console.error('Error uploading image:', error);
                    alert('Error uploading image');
                    return;
                }
            }
            
            const data = {
                title: title,
                description: description
            };
            
            if (imageUrl) {
                data.image = imageUrl;
            }
            
            try {
                if (id) {
                    // Update existing
                    await fetch(`/api/gallery-slides/${id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    alert('Image updated successfully!');
                } else {
                    // Create new
                    if (!imageUrl) {
                        alert('Please select an image file');
                        return;
                    }
                    data.image = imageUrl;
                    await fetch('/api/gallery-slides', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    alert('Image added successfully!');
                }
                
                // Reset form
                document.getElementById('gallery-image-form').reset();
                document.getElementById('gallery-image-id').value = '';
                document.getElementById('gallery-image-form-container').classList.add('hidden');
                const submitBtn = document.querySelector('#gallery-image-form button[type="submit"]');
                submitBtn.textContent = 'Save Image';
                
                loadGallerySlides();
                loadDashboardData();
            } catch (error) {
                console.error('Error saving gallery image:', error);
                alert('Error saving image');
            }
        });
        
        // Show gallery add form
        document.getElementById('add-gallery-image-btn').addEventListener('click', () => {
            document.getElementById('gallery-image-form').reset();
            document.getElementById('gallery-image-id').value = '';
            document.getElementById('gallery-image-form-container').classList.remove('hidden');
            document.querySelector('#gallery-image-form button[type="submit"]').textContent = 'Save Image';
            document.getElementById('gallery-image-form-container').scrollIntoView({ behavior: 'smooth' });
        });
        
        // Cancel gallery edit
        document.getElementById('cancel-gallery-image-edit').addEventListener('click', () => {
            document.getElementById('gallery-image-form').reset();
            document.getElementById('gallery-image-id').value = '';
            document.getElementById('gallery-image-form-container').classList.add('hidden');
        });

        async function editHeroSlide(id) {
            try {
                const response = await fetch(`/api/hero-slides/${id}`);
                const slide = await response.json();
                
                // Show form container
                document.getElementById('hero-slide-form-container').classList.remove('hidden');
                
                // Populate form fields with correct IDs
                document.getElementById('hero-slide-id').value = id;
                document.getElementById('hero-slide-title').value = slide.title || '';
                document.getElementById('hero-slide-description').value = slide.description || '';
                
                // Scroll to form
                document.getElementById('hero-slide-form-container').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Error loading hero slide:', error);
                alert('Error loading slide data');
            }
        }

        // Hero slide form submission handler
        document.getElementById('hero-slide-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const id = document.getElementById('hero-slide-id').value;
            const title = document.getElementById('hero-slide-title').value;
            const description = document.getElementById('hero-slide-description').value;
            const fileInput = document.getElementById('hero-slide-image');
            
            try {
                let mediaUrl = '';
                
                // Upload file if selected
                if (fileInput.files.length > 0) {
                    const file = fileInput.files[0];
                    
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('folder', 'hero-slides');
                    
                    const uploadResponse = await fetch('/api/upload', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!uploadResponse.ok) {
                        const errorData = await uploadResponse.json();
                        throw new Error(errorData.error || 'Failed to upload file');
                    }
                    
                    const uploadData = await uploadResponse.json();
                    mediaUrl = uploadData.url;
                }
                
                const data = {
                    title: title,
                    description: description
                };
                
                // Add image URL if media was uploaded
                if (mediaUrl) {
                    data.image = mediaUrl;
                }
                
                if (id) {
                    // Update existing slide
                    const updateResponse = await fetch(`/api/hero-slides/${id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    
                    if (!updateResponse.ok) {
                        throw new Error('Failed to update slide');
                    }
                    
                    alert('Hero slide updated successfully!');
                } else {
                    // Create new slide
                    if (!mediaUrl) {
                        alert('Please select an image or video for the new slide');
                        return;
                    }
                    
                    await fetch('/api/hero-slides', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    alert('Hero slide created successfully!');
                }
                
                // Reset form and hide container
                document.getElementById('hero-slide-form').reset();
                document.getElementById('hero-slide-id').value = '';
                document.getElementById('hero-slide-form-container').classList.add('hidden');
                
                // Reload slides
                loadHeroSlides();
            } catch (error) {
                console.error('Error saving hero slide:', error);
                let errorMsg = 'Error saving hero slide: ' + error.message;
                if (error.message.includes('fetch')) {
                    errorMsg = 'Network error. Please check your internet connection and try again.';
                }
                alert(errorMsg);
            }
        });
        
        // Add hero slide button handler
        document.getElementById('add-hero-slide-btn').addEventListener('click', () => {
            document.getElementById('hero-slide-form').reset();
            document.getElementById('hero-slide-id').value = '';
            document.getElementById('hero-slide-form-container').classList.remove('hidden');
            document.getElementById('hero-slide-form-container').scrollIntoView({ behavior: 'smooth' });
        });
        
        // Cancel hero slide edit button handler
        document.getElementById('cancel-hero-slide-edit').addEventListener('click', () => {
            document.getElementById('hero-slide-form').reset();
            document.getElementById('hero-slide-id').value = '';
            document.getElementById('hero-slide-form-container').classList.add('hidden');
        });
        
        async function updateHeroSlide(id) {
            // This function is no longer used - kept for backward compatibility
            const data = {
                image: document.getElementById('hero-slide-image').value,
                title: document.getElementById('hero-slide-title').value,
                description: document.getElementById('hero-slide-description').value
            };

            try {
                await fetch(`/api/hero-slides/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                // Reset form
                document.getElementById('hero-slide-form').reset();
                
                loadHeroSlides();
                alert('Slide updated successfully!');
            } catch (error) {
                console.error('Error updating hero slide:', error);
                alert('Error updating slide');
            }
        }

        // Business edit mode toggle
        document.getElementById('edit-business-btn').addEventListener('click', async function() {
            // Load existing data first
            await loadBusinessInfo();
            
            const inputs = document.querySelectorAll('#business-info-form input, #business-info-form textarea');
            inputs.forEach(input => input.removeAttribute('readonly'));
            document.getElementById('edit-business-btn').classList.add('hidden');
            document.getElementById('save-business-btn').classList.remove('hidden');
            document.getElementById('cancel-business-btn').classList.remove('hidden');
        });
        
        document.getElementById('cancel-business-btn').addEventListener('click', function() {
            const inputs = document.querySelectorAll('#business-info-form input, #business-info-form textarea');
            inputs.forEach(input => input.setAttribute('readonly', 'readonly'));
            document.getElementById('edit-business-btn').classList.remove('hidden');
            document.getElementById('save-business-btn').classList.add('hidden');
            document.getElementById('cancel-business-btn').classList.add('hidden');
            loadBusinessInfo(); // Reload original data
        });
        
        // Business info form submission handler
        document.getElementById('business-info-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const businessData = {
                address: document.getElementById('business-address').value,
                email: document.getElementById('business-email').value,
                phone: document.getElementById('business-phone').value,
                whatsapp_number: document.getElementById('business-whatsapp').value,
                website: document.getElementById('business-website').value || '',
                google_location_url: document.getElementById('business-location').value || 'https://maps.app.goo.gl/jxzHozMFWs5LKCUr8',
                hours_weekday: document.getElementById('business-hours-weekday').value,
                hours_sunday: document.getElementById('business-hours-sunday').value,
                facebook: document.getElementById('facebook-url').value || '',
                instagram: document.getElementById('instagram-url').value || '',
                youtube: document.getElementById('youtube-url').value || '',
                twitter: document.getElementById('twitter-url').value || ''
            };
            
            try {
                const response = await fetch('/api/business-info', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(businessData)
                });
                
                if (!response.ok) {
                    throw new Error('Failed to save business information');
                }
                
                alert('Business information saved successfully!');
                
                // Set form back to readonly mode
                const inputs = document.querySelectorAll('#business-info-form input, #business-info-form textarea');
                inputs.forEach(input => input.setAttribute('readonly', 'readonly'));
                document.getElementById('edit-business-btn').classList.remove('hidden');
                document.getElementById('save-business-btn').classList.add('hidden');
                document.getElementById('cancel-business-btn').classList.add('hidden');
                
                // Keep the saved data in form fields (don't clear them)
                document.getElementById('business-address').value = businessData.address;
                document.getElementById('business-email').value = businessData.email;
                document.getElementById('business-phone').value = businessData.phone;
                document.getElementById('business-website').value = businessData.website;
                document.getElementById('business-hours-weekday').value = businessData.hours_weekday;
                document.getElementById('business-hours-sunday').value = businessData.hours_sunday;
                document.getElementById('facebook-url').value = businessData.facebook;
                document.getElementById('instagram-url').value = businessData.instagram;
                document.getElementById('youtube-url').value = businessData.youtube;
                document.getElementById('twitter-url').value = businessData.twitter;
                
            } catch (error) {
                console.error('Error saving business information:', error);
                alert('Error saving business information: ' + error.message);
            }
        });
        
        // Initialize business form as readonly
        function initializeBusinessForm() {
            const inputs = document.querySelectorAll('#business-info-form input, #business-info-form textarea');
            inputs.forEach(input => input.setAttribute('readonly', 'readonly'));
        }
        
        // Chatbot config edit mode toggle
        function toggleChatbotEdit() {
            const inputs = document.querySelectorAll('#chatbot-config-form input, #chatbot-config-form textarea');
            const editBtn = document.getElementById('edit-chatbot-btn');
            const actionsDiv = document.getElementById('chatbot-form-actions');
            
            inputs.forEach(input => input.removeAttribute('readonly'));
            editBtn.style.display = 'none';
            actionsDiv.style.display = 'flex';
        }
        
        function cancelChatbotEdit() {
            const inputs = document.querySelectorAll('#chatbot-config-form input, #chatbot-config-form textarea');
            const editBtn = document.getElementById('edit-chatbot-btn');
            const actionsDiv = document.getElementById('chatbot-form-actions');
            
            inputs.forEach(input => input.setAttribute('readonly', 'readonly'));
            editBtn.style.display = 'inline-block';
            actionsDiv.style.display = 'none';
            // Reload original data
            loadChatbotConfig();
        }
        
        // Chatbot config form submission handler
        document.getElementById('chatbot-config-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const chatbotData = {
                google_maps_url: document.getElementById('chatbot-google-maps').value || '',
                google_review_url: document.getElementById('chatbot-google-review').value || '',
                services: document.getElementById('chatbot-services').value || '',
                facebook: document.getElementById('chatbot-facebook').value || '',
                instagram: document.getElementById('chatbot-instagram').value || '',
                twitter: document.getElementById('chatbot-twitter').value || '',
                youtube: document.getElementById('chatbot-youtube').value || '',
                linkedin: document.getElementById('chatbot-linkedin').value || '',
                hours_weekday: document.getElementById('chatbot-hours-weekday').value || '',
                hours_sunday: document.getElementById('chatbot-hours-sunday').value || ''
            };
            
            try {
                const response = await fetch('/api/chatbot-config', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(chatbotData)
                });
                
                if (!response.ok) {
                    throw new Error('Failed to save chatbot configuration');
                }
                
                alert('Chatbot configuration saved successfully!');
                
                // Set form back to readonly mode
                const inputs = document.querySelectorAll('#chatbot-config-form input, #chatbot-config-form textarea');
                const editBtn = document.getElementById('edit-chatbot-btn');
                const actionsDiv = document.getElementById('chatbot-form-actions');
                
                inputs.forEach(input => input.setAttribute('readonly', 'readonly'));
                editBtn.style.display = 'inline-block';
                actionsDiv.style.display = 'none';
                
                // Reload chatbot config to show updated data
                await loadChatbotConfig();
                
            } catch (error) {
                console.error('Error saving chatbot configuration:', error);
                alert('Error saving chatbot configuration: ' + error.message);
            }
        });
        
        // Initialize chatbot form as readonly
        function initializeChatbotForm() {
            const inputs = document.querySelectorAll('#chatbot-config-form input, #chatbot-config-form textarea');
            inputs.forEach(input => input.setAttribute('readonly', 'readonly'));
        }
        
        // Load chatbot config (placeholder)
        async function loadChatbotConfig() {
            try {
                const response = await fetch('/api/chatbot-config', {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' },
                    cache: 'no-cache'  // Prevent caching to always get fresh data
                });
                
                if (!response.ok) {
                    throw new Error('Failed to load chatbot configuration');
                }
                
                const data = await response.json();
                
                // Populate form fields with fetched data
                document.getElementById('chatbot-google-maps').value = data.google_maps_url || '';
                document.getElementById('chatbot-google-review').value = data.google_review_url || '';
                document.getElementById('chatbot-services').value = data.services || '';
                document.getElementById('chatbot-facebook').value = data.facebook || '';
                document.getElementById('chatbot-instagram').value = data.instagram || '';
                document.getElementById('chatbot-twitter').value = data.twitter || '';
                document.getElementById('chatbot-youtube').value = data.youtube || '';
                document.getElementById('chatbot-linkedin').value = data.linkedin || '';
                document.getElementById('chatbot-hours-weekday').value = data.hours_weekday || '';
                document.getElementById('chatbot-hours-sunday').value = data.hours_sunday || '';
            } catch (error) {
                console.error('Error loading chatbot config:', error);
            }
        }

        async function deleteGallerySlide(id) {
            if (!confirm('Delete this gallery image?')) return;
            try {
                await fetch(`/api/gallery-slides/${id}`, { method: 'DELETE' });
                loadGallerySlides();
                loadDashboardData();
            } catch (error) {
                console.error('Error deleting gallery slide:', error);
                alert('Error deleting image');
            }
        }

        async function deleteBooking(id) {
            if (!confirm('Delete this booking?')) return;
            try {
                await fetch(`/api/bookings/${id}`, { method: 'DELETE' });
                loadBookings();
                loadDashboardData();
            } catch (error) {
                console.error('Error deleting booking:', error);
                alert('Error deleting booking');
            }
        }

        async function deleteMessage(id) {
            if (!confirm('Delete this message?')) return;
            try {
                await fetch(`/api/contact-messages/${id}`, { method: 'DELETE' });
                loadMessages();
                loadDashboardData();
            } catch (error) {
                console.error('Error deleting message:', error);
                alert('Error deleting message');
            }
        }

        // About Section Functions
        async function loadAboutSection() {
            try {
                const response = await fetch('/api/about-section', {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' },
                    cache: 'no-cache'
                });
                
                if (!response.ok) {
                    throw new Error('Failed to load about section');
                }
                
                const data = await response.json();
                
                if (data && Object.keys(data).length > 0) {
                    document.getElementById('about-name').value = data.name || '';
                    document.getElementById('about-description').value = data.description || '';
                    document.getElementById('about-experience').value = data.years_of_experience || '';
                    document.getElementById('about-expertise').value = data.expertise_areas || '';
                    document.getElementById('about-location').value = data.location || '';
                    document.getElementById('about-predictions').value = data.accurate_predictions || '';
                    document.getElementById('about-image-url').value = data.img || '';
                    
                    // Show image preview if URL exists
                    if (data.img) {
                        document.getElementById('about-image-preview').innerHTML = `
                            <img src="${data.img}" alt="Astrologer" class="w-48 h-48 object-cover rounded-lg shadow-lg">
                        `;
                    }
                }
            } catch (error) {
                console.error('Error loading about section:', error);
            }
        }

        function enableAboutEdit() {
            const inputs = document.querySelectorAll('#about-form input:not([type=file]), #about-form textarea');
            const editBtn = document.getElementById('edit-about-btn');
            const actionsDiv = document.getElementById('about-form-actions');
            const uploadBtn = document.getElementById('about-upload-btn');
            const fileInput = document.getElementById('about-image-file');
            
            inputs.forEach(input => input.removeAttribute('readonly'));
            fileInput.removeAttribute('disabled');
            uploadBtn.removeAttribute('disabled');
            editBtn.style.display = 'none';
            actionsDiv.style.display = 'flex';
        }

        function cancelAboutEdit() {
            const inputs = document.querySelectorAll('#about-form input:not([type=file]), #about-form textarea');
            const editBtn = document.getElementById('edit-about-btn');
            const actionsDiv = document.getElementById('about-form-actions');
            const uploadBtn = document.getElementById('about-upload-btn');
            const fileInput = document.getElementById('about-image-file');
            
            inputs.forEach(input => input.setAttribute('readonly', 'readonly'));
            fileInput.setAttribute('disabled', 'disabled');
            uploadBtn.setAttribute('disabled', 'disabled');
            editBtn.style.display = 'inline-block';
            actionsDiv.style.display = 'none';
            
            loadAboutSection(); // Reload original data
        }

        async function uploadAboutImage() {
            const fileInput = document.getElementById('about-image-file');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Please select an image file');
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('folder', 'about');
            
            try {
                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success && result.url) {
                    document.getElementById('about-image-url').value = result.url;
                    document.getElementById('about-image-preview').innerHTML = `
                        <img src="${result.url}" alt="Astrologer" class="w-48 h-48 object-cover rounded-lg shadow-lg" onload="console.log('Image loaded successfully')" onerror="console.error('Image load failed'); this.style.display='none';">
                    `;
                    alert('Image uploaded successfully!');
                } else {
                    alert('Error uploading image: ' + (result.error || 'Unknown error'));
                }
            } catch (error) {
                console.error('Error uploading image:', error);
                alert('Error uploading image');
            }
        }

        document.getElementById('about-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const aboutData = {
                name: document.getElementById('about-name').value || '',
                description: document.getElementById('about-description').value || '',
                years_of_experience: document.getElementById('about-experience').value || '',
                expertise_areas: document.getElementById('about-expertise').value || '',
                location: document.getElementById('about-location').value || '',
                accurate_predictions: document.getElementById('about-predictions').value || '',
                img: document.getElementById('about-image-url').value || ''
            };
            
            try {
                const response = await fetch('/api/about-section', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(aboutData)
                });
                
                if (!response.ok) {
                    throw new Error('Failed to save about section');
                }
                
                alert('About section saved successfully!');
                
                // Set form back to readonly mode
                const inputs = document.querySelectorAll('#about-form input:not([type=file]), #about-form textarea');
                const editBtn = document.getElementById('edit-about-btn');
                const actionsDiv = document.getElementById('about-form-actions');
                const uploadBtn = document.getElementById('about-upload-btn');
                const fileInput = document.getElementById('about-image-file');
                
                inputs.forEach(input => input.setAttribute('readonly', 'readonly'));
                fileInput.setAttribute('disabled', 'disabled');
                uploadBtn.setAttribute('disabled', 'disabled');
                editBtn.style.display = 'inline-block';
                actionsDiv.style.display = 'none';
                
                // Reload about section to show updated data
                await loadAboutSection();
                
            } catch (error) {
                console.error('Error saving about section:', error);
                alert('Error saving about section: ' + error.message);
            }
        });

        // ====================================================================
        // NEW SECTIONS JAVASCRIPT - Navbar, Announcements, Services, Pooja, Solutions
        // ====================================================================

        // Update tab switching to handle new tabs
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', async function() {
                const tab = this.dataset.tab;
                
                // Switch active tab styling
                document.querySelectorAll('.tab-btn').forEach(b => {
                    b.classList.remove('active', 'bg-gradient-to-r', 'from-purple-600', 'to-pink-600', 'text-white');
                    b.classList.add('text-gray-600', 'hover:bg-gray-100');
                });
                this.classList.add('active', 'bg-gradient-to-r', 'from-purple-600', 'to-pink-600', 'text-white');
                this.classList.remove('text-gray-600', 'hover:bg-gray-100');
                
                // Hide all tab contents
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                
                // Show selected tab and load its data
                const section = document.getElementById(`${tab}-section`);
                if (section) {
                    section.classList.remove('hidden');
                    
                    // Load data for the selected tab
                    switch(tab) {
                        case 'announcements':
                            await loadAnnouncements();
                            break;
                        case 'astrological-services':
                            await loadAstroServices();
                            break;
                        case 'pooja-services':
                            await loadPoojaServices();
                            break;
                        case 'expert-solutions':
                            await loadExpertSolutions();
                            break;
                        case 'brand-settings':
                            await loadBrandSettings();
                            break;
                    }
                }
            });
        });

        // ============================
        // ============================
        // OLD NAVBAR & MENU CODE REMOVED
        // Now using Brand Settings instead
        // ============================

        // Similar functions for Announcements, Astro Services, Pooja Services, Expert Solutions
        // (Due to character limits, implementing key functions - patterns repeat)
        
        async function loadAnnouncements() {
            try {
                const response = await fetch('/api/announcements');
                if (response.ok) {
                    const items = await response.json();
                    const list = document.getElementById('announcements-list');
                    list.innerHTML = items.map(item => `
                        <div class="p-4 bg-orange-50 rounded-lg flex justify-between items-center">
                            <div class="flex-1">
                                <p class="font-medium">${item.text}</p>
                                <span class="text-xs ${item.active ? 'text-green-600' : 'text-gray-500'}">${item.active ? 'Active' : 'Inactive'}</span>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="editAnnouncement(${item.id})" class="admin-btn-sm admin-btn-success">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteAnnouncement(${item.id})" class="admin-btn-sm admin-btn-danger">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading announcements:', error);
            }
        }
        
        function showAnnouncementForm() {
            document.getElementById('announcement-form-container').classList.remove('hidden');
        }
        
        function cancelAnnouncementEdit() {
            document.getElementById('announcement-form-container').classList.add('hidden');
        }
        
        async function deleteAnnouncement(id) {
            if (confirm('Delete this announcement?')) {
                await fetch(`/api/announcements/${id}`, { method: 'DELETE' });
                loadAnnouncements();
            }
        }
        
        async function editAnnouncement(id) {
            try {
                const response = await fetch('/api/announcements');
                if (response.ok) {
                    const items = await response.json();
                    const item = items.find(i => i.id === id);
                    if (!item) return;
                    
                    document.getElementById('announcement-id').value = item.id;
                    document.getElementById('announcement-text').value = item.text;
                    document.getElementById('announcement-active').checked = item.active;
                    document.getElementById('announcement-order').value = item.display_order || 0;
                    
                    document.getElementById('announcement-form-container').classList.remove('hidden');
                    document.getElementById('announcement-form-container').scrollIntoView({ behavior: 'smooth' });
                    document.getElementById('announcement-text').focus();
                }
            } catch (error) {
                console.error('Error loading announcement:', error);
                alert('Error loading announcement');
            }
        }
        
        document.getElementById('announcement-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('announcement-id').value;
            const data = {
                text: document.getElementById('announcement-text').value,
                active: document.getElementById('announcement-active').checked,
                display_order: parseInt(document.getElementById('announcement-order').value) || 0
            };
            
            if (id) {
                await fetch(`/api/announcements/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
            } else {
                await fetch('/api/announcements', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
            }
            
            cancelAnnouncementEdit();
            loadAnnouncements();
        });
        
        // Astro Services, Pooja Services, Expert Solutions follow similar patterns
        // Implement with file upload support for icons/images
        
        async function loadAstroServices() {
            try {
                // Force fresh data with timestamp to prevent caching
                const response = await fetch(`/api/astrological-services?t=${Date.now()}`);
                if (!response.ok) {
                    throw new Error('Failed to fetch services');
                }
                const items = await response.json();
                console.log('Loaded astrological services (latest):', items);
                const list = document.getElementById('astro-services-list');
                list.innerHTML = items.map(item => `
                    <div class="relative group">
                        <div class="bg-white rounded-xl p-4 shadow-md hover:shadow-lg transition-all duration-300 border border-gray-200">
                            ${item.icon_url ? 
                                `<div class="flex justify-center mb-2">
                                    <img src="${item.icon_url}" class="w-16 h-16 object-contain" alt="${item.title}">
                                </div>` : 
                                `<div class="flex justify-center mb-2">
                                    <div class="w-16 h-16 bg-gray-200 rounded flex items-center justify-center">
                                        <i class="fas fa-image text-gray-400 text-xl"></i>
                                    </div>
                                </div>`
                            }
                            <h4 class="font-semibold text-center text-gray-800 text-sm mb-1">${item.title}</h4>
                            <div class="text-center text-xs text-gray-500">
                                <i class="fas fa-sort-numeric-up mr-1"></i>Order: ${item.display_order || 0}
                            </div>
                        </div>
                        <div class="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1">
                            <button onclick="editAstroService(${item.id})" class="w-7 h-7 bg-blue-500 text-white rounded-full hover:bg-blue-600 flex items-center justify-center shadow-md" title="Edit">
                                <i class="fas fa-edit text-xs"></i>
                            </button>
                            <button onclick="deleteAstroService(${item.id})" class="w-7 h-7 bg-red-500 text-white rounded-full hover:bg-red-600 flex items-center justify-center shadow-md" title="Delete">
                                <i class="fas fa-trash text-xs"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading astrological services:', error);
                showNotification('Error loading services', 'error');
            }
        }
        
        async function editAstroService(id) {
            try {
                console.log(' Loading service for editing - ID:', id);
                
                // Fetch current/latest data from database with cache buster
                const response = await fetch(`/api/astrological-services/${id}?_t=${Date.now()}`);
                if (!response.ok) {
                    throw new Error(`Service not found (Status: ${response.status})`);
                }
                const serviceData = await response.json();
                console.log(' Current service data loaded:', serviceData);
                
                // Ensure we're in edit mode, not create mode
                const formContainer = document.getElementById('astro-service-form-container');
                const form = document.getElementById('astro-service-form');
                
                // Reset form completely first
                form.reset();
                
                // Set hidden ID field to indicate UPDATE mode
                const idField = document.getElementById('astro-service-id');
                idField.value = serviceData.id;
                console.log(' Set service ID for update:', serviceData.id);
                
                // Populate form fields with EXISTING data
                const titleField = document.getElementById('astro-service-title');
                const activeField = document.getElementById('astro-service-active');
                const orderField = document.getElementById('astro-service-order');
                
                titleField.value = serviceData.title || '';
                activeField.checked = serviceData.active !== false;
                orderField.value = serviceData.display_order || 0;
                
                console.log(' Form populated with:', {
                    id: serviceData.id,
                    title: serviceData.title,
                    active: serviceData.active,
                    order: serviceData.display_order
                });
                
                // Handle existing image preview
                const preview = document.getElementById('astro-service-icon-preview');
                const fileInput = document.getElementById('astro-service-icon');
                
                if (serviceData.image_url) {
                    const img = preview.querySelector('img');
                    img.src = serviceData.image_url;
                    preview.classList.remove('hidden');
                    preview.dataset.currentUrl = serviceData.image_url;
                    console.log(' Loaded existing image:', serviceData.image_url);
                } else {
                    preview.classList.add('hidden');
                    preview.dataset.currentUrl = '';
                }
                
                // Clear file input (user can choose new image or keep existing)
                fileInput.value = '';
                
                // Show form for editing
                formContainer.classList.remove('hidden');
                formContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Focus on title field for easy editing
                titleField.focus();
                titleField.select();
                
                showNotification(`Service "${serviceData.title}" loaded for editing`, 'info');
                
            } catch (error) {
                console.error(' Error loading service for editing:', error);
                showNotification(`Failed to load service: ${error.message}`, 'error');
            }
        }
        
        async function deleteAstroService(id) {
            if (!confirm('Are you sure you want to delete this astrological service?')) return;
            try {
                const response = await fetch(`/api/astrological-services/${id}`, { method: 'DELETE' });
                if (response.ok) {
                    showNotification('Service deleted successfully', 'success');
                    loadAstroServices();
                } else {
                    showNotification('Failed to delete service', 'error');
                }
            } catch (error) {
                console.error('Error deleting service:', error);
                showNotification('Error deleting service', 'error');
            }
        }
        
        async function loadPoojaServices() {
            try {
                const response = await fetch('/api/content/pooja-services');
                const items = await response.json();
                const list = document.getElementById('pooja-services-list');
                list.innerHTML = items.map(item => `
                    <div class="bg-white border rounded-xl p-4 shadow hover:shadow-lg transition-all duration-300 hover:scale-105">
                        ${item.image_url ? `<img src="${item.image_url}" class="w-full h-32 object-cover rounded-lg mb-3">` : '<div class="w-full h-32 bg-gradient-to-br from-orange-400 to-red-500 rounded-lg mb-3 flex items-center justify-center"><i class="fas fa-om text-white text-4xl"></i></div>'}
                        <h4 class="font-bold mb-2 text-center">${item.title}</h4>
                        <p class="text-sm text-gray-600 mb-3 line-clamp-3">${item.description || ''}</p>
                        <div class="flex gap-2 justify-center">
                            <button onclick="editPoojaService(${item.id})" class="admin-btn-sm admin-btn-success" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deletePoojaService(${item.id})" class="admin-btn-sm admin-btn-danger" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading pooja services:', error);
                showNotification('Error loading pooja services', 'error');
            }
        }
        
        async function editPoojaService(id) {
            try {
                const response = await fetch('/api/content/pooja-services');
                const items = await response.json();
                const item = items.find(i => i.id === id);
                if (!item) return;
                
                document.getElementById('pooja-service-id').value = item.id;
                document.getElementById('pooja-service-title').value = item.title;
                document.getElementById('pooja-service-description').value = item.description || '';
                document.getElementById('pooja-service-active').checked = item.active !== false;
                document.getElementById('pooja-service-order').value = item.display_order || 0;
                
                // Show existing image if available
                if (item.image_url) {
                    const preview = document.getElementById('pooja-service-image-preview');
                    preview.querySelector('img').src = item.image_url;
                    preview.classList.remove('hidden');
                    preview.dataset.currentUrl = item.image_url;
                }
                
                document.getElementById('pooja-service-form-container').classList.remove('hidden');
                document.getElementById('pooja-service-form-container').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Error editing pooja service:', error);
                showNotification('Error loading pooja service', 'error');
            }
        }
        
        async function deletePoojaService(id) {
            if (!confirm('Are you sure you want to delete this pooja service?')) return;
            try {
                const response = await fetch(`/api/content/pooja-services/${id}`, { method: 'DELETE' });
                if (response.ok) {
                    showNotification('Pooja service deleted successfully', 'success');
                    loadPoojaServices();
                } else {
                    showNotification('Failed to delete pooja service', 'error');
                }
            } catch (error) {
                console.error('Error deleting pooja service:', error);
                showNotification('Error deleting pooja service', 'error');
            }
        }
        
        async function loadExpertSolutions() {
            try {
                const response = await fetch('/api/content/expert-solutions');
                const items = await response.json();
                const list = document.getElementById('expert-solutions-list');
                list.innerHTML = items.map(item => `
                    <div class="bg-white border rounded-xl p-4 shadow hover:shadow-lg transition-all duration-300 hover:scale-102 flex flex-col md:flex-row gap-4">
                        ${item.image_url ? `<img src="${item.image_url}" class="w-full md:w-48 h-32 object-cover rounded-lg">` : '<div class="w-full md:w-48 h-32 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center"><i class="fas fa-hands-helping text-white text-4xl"></i></div>'}
                        <div class="flex-1">
                            <h4 class="font-bold text-lg mb-2">${item.title}</h4>
                            <p class="text-sm text-gray-600 mb-3 line-clamp-3">${item.description || ''}</p>
                            <div class="flex gap-2">
                                <button onclick="editExpertSolution(${item.id})" class="admin-btn-sm admin-btn-success" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteExpertSolution(${item.id})" class="admin-btn-sm admin-btn-danger" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading expert solutions:', error);
                showNotification('Error loading expert solutions', 'error');
            }
        }
        
        async function editExpertSolution(id) {
            try {
                const response = await fetch('/api/content/expert-solutions');
                const items = await response.json();
                const item = items.find(i => i.id === id);
                if (!item) return;
                
                document.getElementById('expert-solution-id').value = item.id;
                document.getElementById('expert-solution-title').value = item.title;
                document.getElementById('expert-solution-description').value = item.description || '';
                document.getElementById('expert-solution-active').checked = item.active !== false;
                document.getElementById('expert-solution-order').value = item.display_order || 0;
                
                // Show existing image if available
                if (item.image_url) {
                    const preview = document.getElementById('expert-solution-image-preview');
                    preview.querySelector('img').src = item.image_url;
                    preview.classList.remove('hidden');
                    preview.dataset.currentUrl = item.image_url;
                }
                
                document.getElementById('expert-solution-form-container').classList.remove('hidden');
                document.getElementById('expert-solution-form-container').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Error editing expert solution:', error);
                showNotification('Error loading expert solution', 'error');
            }
        }
        
        async function deleteExpertSolution(id) {
            if (!confirm('Are you sure you want to delete this expert solution?')) return;
            try {
                const response = await fetch(`/api/content/expert-solutions/${id}`, { method: 'DELETE' });
                if (response.ok) {
                    showNotification('Expert solution deleted successfully', 'success');
                    loadExpertSolutions();
                } else {
                    showNotification('Failed to delete expert solution', 'error');
                }
            } catch (error) {
                console.error('Error deleting expert solution:', error);
                showNotification('Error deleting expert solution', 'error');
            }
        }
        
        async function deleteItem(endpoint, id, reloadFn) {
            if (confirm('Delete this item?')) {
                await fetch(`${endpoint}/${id}`, { method: 'DELETE' });
                reloadFn();
            }
        }

        // Reviews Management Functions
        async function loadReviewsAdmin() {
            try {
                const response = await fetch('/api/reviews');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                const reviews = await response.json();
                const list = document.getElementById('reviews-list');
                
                // Handle error response
                if (reviews.error) {
                    throw new Error(reviews.error);
                }
                
                // Ensure reviews is an array
                if (!Array.isArray(reviews)) {
                    console.error('Reviews response is not an array:', reviews);
                    list.innerHTML = '<div class="text-center py-8 text-red-500"><i class="fas fa-exclamation-triangle text-4xl mb-2"></i><p>Error: Invalid response format</p></div>';
                    return;
                }
                
                if (reviews.length === 0) {
                    list.innerHTML = '<div class="text-center py-8 text-gray-500"><i class="fas fa-star text-4xl mb-2"></i><p>No reviews yet. Add your first client review!</p></div>';
                    return;
                }
                
                list.innerHTML = reviews.map(review => `
                    <div class="bg-white border rounded-xl p-4 shadow hover:shadow-lg transition-all duration-300 hover:scale-102 flex gap-4">
                        ${review.user_image ? 
                            `<img src="${review.user_image}" class="w-16 h-16 rounded-full object-cover border-2 border-purple-200">` : 
                            `<div class="w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-2xl font-bold">${review.name.charAt(0)}</div>`
                        }
                        <div class="flex-1">
                            <div class="flex items-start justify-between mb-2">
                                <div>
                                    <h4 class="font-bold text-lg">${review.name}</h4>
                                    <div class="text-yellow-500">${''.repeat(review.rating)}</div>
                                </div>
                                <div class="flex gap-2">
                                    <span class="px-2 py-1 text-xs rounded-full ${review.active ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700'}">
                                        ${review.active ? 'Active' : 'Inactive'}
                                    </span>
                                    <button onclick="editReview(${review.id})" class="admin-btn-sm admin-btn-success" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteReview(${review.id})" class="admin-btn-sm admin-btn-danger" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-sm text-gray-600">${review.review_text}</p>
                            <p class="text-xs text-gray-400 mt-2">Order: ${review.display_order || 0}</p>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading reviews:', error);
                showNotification('Error loading reviews', 'error');
            }
        }

        function showReviewForm() {
            document.getElementById('review-form').reset();
            document.getElementById('review-id').value = '';
            document.getElementById('review-image-preview').classList.add('hidden');
            document.getElementById('review-image-preview').dataset.currentUrl = '';
            document.getElementById('review-form-container').classList.remove('hidden');
            document.getElementById('review-form-container').scrollIntoView({ behavior: 'smooth' });
        }

        function cancelReviewEdit() {
            document.getElementById('review-form-container').classList.add('hidden');
            document.getElementById('review-form').reset();
        }

        function previewReviewImage(event) {
            const file = event.target.files[0];
            if (file) {
                const preview = document.getElementById('review-image-preview');
                const img = preview.querySelector('img');
                img.src = URL.createObjectURL(file);
                preview.classList.remove('hidden');
            }
        }

        async function editReview(id) {
            try {
                const response = await fetch('/api/reviews');
                const reviews = await response.json();
                const review = reviews.find(r => r.id === id);
                if (!review) return;
                
                document.getElementById('review-id').value = review.id;
                document.getElementById('review-name').value = review.name;
                document.getElementById('review-rating').value = review.rating;
                document.getElementById('review-text').value = review.review_text;
                document.getElementById('review-active').checked = review.active;
                document.getElementById('review-order').value = review.display_order || 0;
                
                if (review.user_image) {
                    const preview = document.getElementById('review-image-preview');
                    preview.querySelector('img').src = review.user_image;
                    preview.classList.remove('hidden');
                    preview.dataset.currentUrl = review.user_image;
                }
                
                document.getElementById('review-form-container').classList.remove('hidden');
                document.getElementById('review-form-container').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Error editing review:', error);
                showNotification('Error loading review', 'error');
            }
        }

        async function deleteReview(id) {
            if (!confirm('Are you sure you want to delete this review?')) return;
            try {
                const response = await fetch(`/api/reviews/${id}`, { method: 'DELETE' });
                if (response.ok) {
                    showNotification('Review deleted successfully', 'success');
                    loadReviewsAdmin();
                } else {
                    showNotification('Failed to delete review', 'error');
                }
            } catch (error) {
                console.error('Error deleting review:', error);
                showNotification('Error deleting review', 'error');
            }
        }

        // Review Form Submit Handler
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('review-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const reviewId = document.getElementById('review-id').value;
                const formData = new FormData();
                
                formData.append('name', document.getElementById('review-name').value.trim());
                formData.append('rating', document.getElementById('review-rating').value);
                formData.append('review_text', document.getElementById('review-text').value.trim());
                formData.append('active', document.getElementById('review-active').checked);
                formData.append('display_order', document.getElementById('review-order').value || 0);
                
                const imageFile = document.getElementById('review-image').files[0];
                if (imageFile) {
                    formData.append('image', imageFile);
                } else if (document.getElementById('review-image-preview').dataset.currentUrl) {
                    formData.append('existing_image', document.getElementById('review-image-preview').dataset.currentUrl);
                }
                
                try {
                    const url = reviewId ? `/api/reviews/${reviewId}` : '/api/reviews';
                    const method = reviewId ? 'PUT' : 'POST';
                    
                    const response = await fetch(url, {
                        method: method,
                        body: formData
                    });
                    
                    if (response.ok) {
                        showNotification(`Review ${reviewId ? 'updated' : 'added'} successfully`, 'success');
                        cancelReviewEdit();
                        loadReviewsAdmin();
                    } else {
                        const error = await response.json();
                        showNotification(error.error || 'Failed to save review', 'error');
                    }
                } catch (error) {
                    console.error('Error saving review:', error);
                    showNotification('Error saving review', 'error');
                }
            });
        });
        
        function showAstroServiceForm() { 
            document.getElementById('astro-service-form').reset();
            document.getElementById('astro-service-id').value = '';
            document.getElementById('astro-service-icon-preview').classList.add('hidden');
            document.getElementById('astro-service-icon-preview').dataset.currentUrl = '';
            document.getElementById('astro-service-form-container').classList.remove('hidden'); 
        }
        
        function cancelAstroServiceEdit() { 
            document.getElementById('astro-service-form-container').classList.add('hidden'); 
            document.getElementById('astro-service-form').reset();
            document.getElementById('astro-service-icon-preview').classList.add('hidden');
        }
        
        function previewAstroServiceIcon(event) {
            const preview = document.getElementById('astro-service-icon-preview');
            if (!preview) return;
            
            const img = preview.querySelector('img');
            if (event.target.files && event.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    img.src = e.target.result;
                    preview.classList.remove('hidden');
                    preview.dataset.currentUrl = ''; // Clear old URL when new file selected
                };
                reader.readAsDataURL(event.target.files[0]);
            }
        }
        function showPoojaServiceForm() { 
            document.getElementById('pooja-service-form').reset();
            document.getElementById('pooja-service-id').value = '';
            document.getElementById('pooja-service-image-preview').classList.add('hidden');
            document.getElementById('pooja-service-image-preview').dataset.currentUrl = '';
            document.getElementById('pooja-service-form-container').classList.remove('hidden'); 
        }
        function cancelPoojaServiceEdit() { 
            document.getElementById('pooja-service-form-container').classList.add('hidden'); 
            document.getElementById('pooja-service-form').reset();
        }
        function showExpertSolutionForm() { 
            document.getElementById('expert-solution-form').reset();
            document.getElementById('expert-solution-id').value = '';
            document.getElementById('expert-solution-image-preview').classList.add('hidden');
            document.getElementById('expert-solution-image-preview').dataset.currentUrl = '';
            document.getElementById('expert-solution-form-container').classList.remove('hidden'); 
        }
        function cancelExpertSolutionEdit() { 
            document.getElementById('expert-solution-form-container').classList.add('hidden'); 
            document.getElementById('expert-solution-form').reset();
        }
        
        // Astrological Services CRUD Functions
        async function loadAstrologicalServices() {
            try {
                const response = await fetch('/api/astrological-services');
                const services = await response.json();
                displayAstrologicalServices(services);
            } catch (error) {
                console.error('Error loading astrological services:', error);
                showNotification('Error loading astrological services', 'error');
            }
        }

        function displayAstrologicalServices(services) {
            const container = document.getElementById('astro-services-list');
            if (!container) return;
            
            container.innerHTML = services.map(service => `
                <div class="astro-service-card bg-white rounded-xl shadow-md p-4 border border-gray-200 hover:shadow-lg transition-all">
                    <div class="text-center mb-3">
                        ${service.image_url ? 
                            `<div class="w-16 h-16 mx-auto mb-2 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full flex items-center justify-center">
                                <img src="${service.image_url}" alt="${service.title}" class="w-12 h-12 object-contain" style="background: transparent;">
                            </div>` : 
                            `<div class="w-16 h-16 mx-auto mb-2 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-star text-purple-600 text-xl"></i>
                            </div>`
                        }
                        <h3 class="font-semibold text-gray-800 text-sm">${service.title}</h3>
                        ${service.price ? `<p class="text-xs text-purple-600 font-medium">${service.price}</p>` : ''}
                        ${service.is_featured ? '<span class="inline-block bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full mt-1">Featured</span>' : ''}
                    </div>
                    <div class="flex justify-between items-center text-xs">
                        <span class="text-gray-500">Order: ${service.display_order}</span>
                        <div class="flex space-x-1">
                            <button onclick="editAstroService(${service.id})" class="text-blue-600 hover:bg-blue-50 p-1 rounded" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteAstroService(${service.id})" class="text-red-600 hover:bg-red-50 p-1 rounded" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function editAstroService(id) {
            try {
                console.log(' Editing service with ID:', id);
                const response = await fetch(`/api/astrological-services/${id}`);
                if (!response.ok) {
                    throw new Error(`Failed to fetch service: ${response.statusText}`);
                }
                const service = await response.json();
                console.log(' Service data loaded for edit:', service);
                
                // Show the form container WITHOUT resetting (to preserve ID for update)
                document.getElementById('astro-service-form-container').classList.remove('hidden');
                
                // Populate form with existing service data
                document.getElementById('astro-service-id').value = service.id || '';
                document.getElementById('astro-service-title').value = service.title || '';
                document.getElementById('astro-service-active').checked = service.active !== false;
                document.getElementById('astro-service-order').value = service.display_order || 0;
                
                // Show image preview if exists
                const preview = document.getElementById('astro-service-icon-preview');
                if (service.image_url) {
                    const img = preview.querySelector('img');
                    if (img) {
                        img.src = service.image_url;
                        preview.classList.remove('hidden');
                        preview.dataset.currentUrl = service.image_url;
                    }
                }
                
                // Scroll form into view
                document.getElementById('astro-service-form-container').scrollIntoView({ behavior: 'smooth' });
                
                // Focus on title field for easy editing
                const titleField = document.getElementById('astro-service-title');
                if (titleField) {
                    titleField.focus();
                    titleField.select();
                }
                
                showNotification(`Service "${service.title}" loaded for editing`, 'info');
                
            } catch (error) {
                console.error(' Error loading service for edit:', error);
                showNotification(`Error loading service: ${error.message}`, 'error');
            }
        }

        async function deleteAstroService(id) {
            if (!confirm('Are you sure you want to delete this service?')) return;
            
            try {
                const response = await fetch(`/api/astrological-services/${id}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showNotification('Service deleted successfully', 'success');
                    loadAstrologicalServices();
                } else {
                    showNotification('Error deleting service', 'error');
                }
            } catch (error) {
                console.error('Error deleting service:', error);
                showNotification('Error deleting service', 'error');
            }
        }

        // Form submission with background removal
        document.getElementById('astro-service-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const id = document.getElementById('astro-service-id').value;
            const preview = document.getElementById('astro-service-icon-preview');
            let imageUrl = preview.dataset.currentUrl || '';
            
            // Upload new image with background removal if selected
            const file = document.getElementById('astro-service-icon').files[0];
            if (file) {
                try {
                    showNotification('Processing image with background removal...', 'info');
                    const fd = new FormData();
                    fd.append('file', file);
                    fd.append('folder', 'branding'); // Use branding folder for background removal
                    fd.append('removeBackground', 'true'); // Enable background removal
                    
                    const uploadResponse = await fetch('/api/upload', { 
                        method: 'POST', 
                        body: fd 
                    });
                    
                    if (uploadResponse.ok) {
                        const uploadResult = await uploadResponse.json();
                        imageUrl = uploadResult.url;
                        showNotification('Image processed successfully!', 'success');
                    } else {
                        showNotification('Failed to upload image', 'error');
                        return;
                    }
                } catch (uploadError) {
                    console.error('Upload error:', uploadError);
                    showNotification('Failed to process image', 'error');
                    return;
                }
            }
            
            // Prepare service data - simplified
            const data = {
                title: document.getElementById('astro-service-title').value,
                image_url: imageUrl,
                active: document.getElementById('astro-service-active').checked,
                display_order: parseInt(document.getElementById('astro-service-order').value) || 0
            };
            
            try {
                console.log(' Saving service - ID present:', !!id, 'ID value:', id);
                
                const method = id ? 'PUT' : 'POST';
                const endpoint = id ? `/api/astrological-services/${id}` : '/api/astrological-services';
                
                console.log(' Using method:', method, 'endpoint:', endpoint);
                console.log(' Sending data:', data);
                
                const response = await fetch(endpoint, {
                    method: method,
                    headers: { 
                        'Content-Type': 'application/json',
                        'Cache-Control': 'no-cache'
                    },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    console.log(' Service save successful:', result);
                    
                    const action = id ? 'updated' : 'created';
                    showNotification(`Service "${data.title}" ${action} successfully!`, 'success');
                    
                    // Clear form and reset to prevent duplicates
                    document.getElementById('astro-service-form').reset();
                    document.getElementById('astro-service-id').value = '';
                    const preview = document.getElementById('astro-service-icon-preview');
                    preview.classList.add('hidden');
                    preview.dataset.currentUrl = '';
                    
                    // Hide form
                    cancelAstroServiceEdit();
                    
                    // Reload services list to show changes
                    await loadAstroServices();
                } else {
                    const errorData = await response.json();
                    console.error(' Save failed:', errorData);
                    showNotification(`Failed to save service: ${errorData.error || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error(' Error saving service:', error);
                showNotification(`Error saving service: ${error.message}`, 'error');
            }
        });
            
        
        document.getElementById('pooja-service-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const id = document.getElementById('pooja-service-id').value;
            const preview = document.getElementById('pooja-service-image-preview');
            let imageUrl = preview.dataset.currentUrl || '';
            
            const file = document.getElementById('pooja-service-image').files[0];
            if (file) {
                const fd = new FormData();
                fd.append('file', file);
                fd.append('folder', 'pooja-services');
                const res = await fetch('/api/upload', { method: 'POST', body: fd });
                if (res.ok) {
                    imageUrl = (await res.json()).url;
                } else {
                    showNotification('Failed to upload image', 'error');
                    return;
                }
            }
            
            const data = {
                title: document.getElementById('pooja-service-title').value,
                description: document.getElementById('pooja-service-description').value,
                image_url: imageUrl,
                active: document.getElementById('pooja-service-active').checked,
                display_order: parseInt(document.getElementById('pooja-service-order').value) || 0
            };
            
            try {
                const method = id ? 'PUT' : 'POST';
                const url = id ? `/api/content/pooja-services/${id}` : '/api/content/pooja-services';
                
                const response = await fetch(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    showNotification(`Pooja service ${id ? 'updated' : 'created'} successfully`, 'success');
                    cancelPoojaServiceEdit();
                    loadPoojaServices();
                } else {
                    showNotification('Failed to save pooja service', 'error');
                }
            } catch (error) {
                console.error('Error saving pooja service:', error);
                showNotification('Error saving pooja service', 'error');
            }
        });
        
        document.getElementById('expert-solution-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const id = document.getElementById('expert-solution-id').value;
            const preview = document.getElementById('expert-solution-image-preview');
            let imageUrl = preview.dataset.currentUrl || '';
            
            const file = document.getElementById('expert-solution-image').files[0];
            if (file) {
                const fd = new FormData();
                fd.append('file', file);
                fd.append('folder', 'expert-solutions');
                const res = await fetch('/api/upload', { method: 'POST', body: fd });
                if (res.ok) {
                    imageUrl = (await res.json()).url;
                } else {
                    showNotification('Failed to upload image', 'error');
                    return;
                }
            }
            
            const data = {
                title: document.getElementById('expert-solution-title').value,
                description: document.getElementById('expert-solution-description').value,
                image_url: imageUrl,
                active: document.getElementById('expert-solution-active').checked,
                display_order: parseInt(document.getElementById('expert-solution-order').value) || 0
            };
            
            try {
                const method = id ? 'PUT' : 'POST';
                const url = id ? `/api/content/expert-solutions/${id}` : '/api/content/expert-solutions';
                
                const response = await fetch(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    showNotification(`Expert solution ${id ? 'updated' : 'created'} successfully`, 'success');
                    cancelExpertSolutionEdit();
                    loadExpertSolutions();
                } else {
                    showNotification('Failed to save expert solution', 'error');
                }
            } catch (error) {
                console.error('Error saving expert solution:', error);
                showNotification('Error saving expert solution', 'error');
            }
        });
        
        // Image preview functions
        function previewAstroServiceIcon(event) {
            const preview = document.getElementById('astro-service-icon-preview');
            const img = preview.querySelector('img');
            if (event.target.files && event.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    img.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(event.target.files[0]);
            }
        }
        
        function previewPoojaServiceImage(event) {
            const preview = document.getElementById('pooja-service-image-preview');
            const img = preview.querySelector('img');
            if (event.target.files && event.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    img.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(event.target.files[0]);
            }
        }
        
        function previewExpertSolutionImage(event) {
            const preview = document.getElementById('expert-solution-image-preview');
            const img = preview.querySelector('img');
            if (event.target.files && event.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    img.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(event.target.files[0]);
            }
        }
        
        // Brand Settings Functions
        async function loadBrandSettings() {
            try {
                const response = await fetch('/api/navbar-settings');
                if (response.ok) {
                    const settings = await response.json();
                    console.log('Loading brand settings:', settings);
                    
                    // Website Identity - Fixed field mapping
                    if (document.getElementById('brand-website-name')) {
                        document.getElementById('brand-website-name').value = settings.name || '';
                    }
                    if (document.getElementById('brand-website-subtitle1')) {
                        document.getElementById('brand-website-subtitle1').value = settings.subtitle1 || '';
                    }
                    if (document.getElementById('brand-website-subtitle2')) {
                        document.getElementById('brand-website-subtitle2').value = settings.subtitle2 || '';
                    }
                    if (document.getElementById('brand-website-subtitle3')) {
                        document.getElementById('brand-website-subtitle3').value = settings.subtitle3 || '';
                    }
                    
                    // Layout settings
                    document.getElementById('brand-logo-position').value = settings.logo_position || 'left';
                    document.getElementById('brand-name-position').value = settings.name_position || 'left';
                    document.getElementById('brand-navbar-height').value = settings.navbar_height || 'medium';
                    document.getElementById('brand-navbar-style').value = settings.navbar_style || 'gradient';
                    
                    // Color settings
                    if (settings.primary_color) {
                        const primaryColorInput = document.getElementById('brand-primary-color');
                        if (primaryColorInput) primaryColorInput.value = settings.primary_color;
                    }
                    if (settings.secondary_color) {
                        const secondaryColorInput = document.getElementById('brand-secondary-color');
                        if (secondaryColorInput) secondaryColorInput.value = settings.secondary_color;
                    }
                    
                    // Language dropdown setting
                    if (settings.show_language_dropdown !== undefined) {
                        const langDropdownInput = document.getElementById('brand-show-language');
                        if (langDropdownInput) langDropdownInput.checked = settings.show_language_dropdown;
                    }
                    
                    if (settings.logo_url) {
                        const logoPreview = document.getElementById('brand-logo-preview');
                        logoPreview.querySelector('img').src = settings.logo_url;
                        logoPreview.classList.remove('hidden');
                        logoPreview.dataset.currentUrl = settings.logo_url;
                    }
                    
                    if (settings.astrological_services_bg_url) {
                        const astroBgPreview = document.getElementById('brand-astro-bg-preview');
                        astroBgPreview.querySelector('img').src = settings.astrological_services_bg_url;
                        astroBgPreview.classList.remove('hidden');
                        astroBgPreview.dataset.currentUrl = settings.astrological_services_bg_url;
                    }
                    
                    if (settings.pooja_services_bg_url) {
                        const poojaBgPreview = document.getElementById('brand-pooja-bg-preview');
                        poojaBgPreview.querySelector('img').src = settings.pooja_services_bg_url;
                        poojaBgPreview.classList.remove('hidden');
                        poojaBgPreview.dataset.currentUrl = settings.pooja_services_bg_url;
                    }
                }
            } catch (error) {
                console.error('Error loading brand settings:', error);
            }
        }
        
        // Brand Settings Edit Mode
        let brandEditMode = false;
        
        document.getElementById('brand-edit-btn').addEventListener('click', () => {
            brandEditMode = !brandEditMode;
            toggleBrandEditMode();
        });
        
        document.getElementById('brand-cancel-btn')?.addEventListener('click', () => {
            brandEditMode = false;
            toggleBrandEditMode();
            loadBrandSettings(); // Reload to revert changes
        });
        
        function toggleBrandEditMode() {
            const editBtn = document.getElementById('brand-edit-btn');
            const btnGroup = document.getElementById('brand-btn-group');
            const inputs = document.querySelectorAll('.brand-input');
            
            if (brandEditMode) {
                editBtn.innerHTML = '<i class="fas fa-lock-open mr-2"></i>Editing...';
                editBtn.disabled = true;
                btnGroup.classList.remove('hidden');
                inputs.forEach(input => {
                    input.removeAttribute('disabled');
                    input.removeAttribute('readonly');
                    input.classList.add('border-purple-300', 'focus:border-purple-500');
                });
            } else {
                editBtn.innerHTML = '<i class="fas fa-edit mr-2"></i>Edit';
                editBtn.disabled = false;
                btnGroup.classList.add('hidden');
                inputs.forEach(input => {
                    if (input.type === 'file') {
                        input.setAttribute('disabled', '');
                    } else {
                        input.setAttribute('readonly', '');
                    }
                    input.classList.remove('border-purple-300', 'focus:border-purple-500');
                });
            }
        }
        
        document.getElementById('brand-settings-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            let logoUrl = '';
            let astroBgUrl = '';
            let poojaBgUrl = '';
            
            const logoPreview = document.getElementById('brand-logo-preview');
            if (logoPreview && logoPreview.dataset.currentUrl) {
                logoUrl = logoPreview.dataset.currentUrl;
            }
            
            const astroBgPreview = document.getElementById('brand-astro-bg-preview');
            if (astroBgPreview && astroBgPreview.dataset.currentUrl) {
                astroBgUrl = astroBgPreview.dataset.currentUrl;
            }
            
            const poojaBgPreview = document.getElementById('brand-pooja-bg-preview');
            if (poojaBgPreview && poojaBgPreview.dataset.currentUrl) {
                poojaBgUrl = poojaBgPreview.dataset.currentUrl;
            }
            
            // Upload logo if new file selected
            const logoFile = document.getElementById('brand-logo').files[0];
            if (logoFile) {
                const fd = new FormData();
                fd.append('file', logoFile);
                fd.append('folder', 'branding'); // Use branding folder for automatic background removal
                const res = await fetch('/api/upload', { method: 'POST', body: fd });
                if (res.ok) {
                    logoUrl = (await res.json()).url;
                    showNotification('Logo uploaded successfully', 'success');
                }
            }
            
            // Upload Astrological Services background if new file selected
            const astroBgFile = document.getElementById('brand-astro-bg').files[0];
            if (astroBgFile) {
                const fd = new FormData();
                fd.append('file', astroBgFile);
                fd.append('folder', 'others'); // Store backgrounds in others folder
                const res = await fetch('/api/upload', { method: 'POST', body: fd });
                if (res.ok) {
                    astroBgUrl = (await res.json()).url;
                    showNotification('Astrological Services background uploaded successfully', 'success');
                }
            }
            
            // Upload Pooja Services background if new file selected
            const poojaBgFile = document.getElementById('brand-pooja-bg').files[0];
            if (poojaBgFile) {
                const fd = new FormData();
                fd.append('file', poojaBgFile);
                fd.append('folder', 'others'); // Store backgrounds in others folder
                const res = await fetch('/api/upload', { method: 'POST', body: fd });
                if (res.ok) {
                    poojaBgUrl = (await res.json()).url;
                    showNotification('Pooja Services background uploaded successfully', 'success');
                }
            }
            
            const data = {
                name: document.getElementById('brand-website-name')?.value || 'Cosmic Astrology',
                subtitle1: document.getElementById('brand-website-subtitle1')?.value || '',
                subtitle2: document.getElementById('brand-website-subtitle2')?.value || '',
                subtitle3: document.getElementById('brand-website-subtitle3')?.value || '',
                logo_url: logoUrl,
                logo_position: document.getElementById('brand-logo-position')?.value || 'left',
                name_position: document.getElementById('brand-name-position')?.value || 'left',
                navbar_height: document.getElementById('brand-navbar-height')?.value || 'medium',
                navbar_style: document.getElementById('brand-navbar-style')?.value || 'solid',
                primary_color: document.getElementById('brand-primary-color')?.value || '#667eea',
                secondary_color: document.getElementById('brand-secondary-color')?.value || '#764ba2',
                show_language_dropdown: document.getElementById('brand-show-language')?.checked || true,
                astrological_services_bg_url: astroBgUrl,
                pooja_services_bg_url: poojaBgUrl
            };
            
            try {
                const response = await fetch('/api/navbar-settings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    showNotification('Brand settings saved successfully! Website will be updated.', 'success');
                    brandEditMode = false;
                    toggleBrandEditMode();
                    loadBrandSettings(); // Reload to display updated data
                } else {
                    const error = await response.json();
                    showNotification('Failed to save brand settings: ' + (error.error || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('Error saving brand settings:', error);
                showNotification('Error saving brand settings: ' + error.message, 'error');
            }
        });
        
        function previewBrandLogo(event) {
            const preview = document.getElementById('brand-logo-preview');
            if (!preview) return;
            const img = preview.querySelector('img');
            if (event.target.files && event.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    img.src = e.target.result;
                    preview.classList.remove('hidden');
                    preview.dataset.currentUrl = ''; // Clear old URL when new file selected
                };
                reader.readAsDataURL(event.target.files[0]);
            }
        }
        
        function previewServiceBg(event, type) {
            const previewId = type === 'astro' ? 'brand-astro-bg-preview' : 'brand-pooja-bg-preview';
            const preview = document.getElementById(previewId);
            if (!preview) return;
            const img = preview.querySelector('img');
            if (event.target.files && event.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    img.src = e.target.result;
                    preview.classList.remove('hidden');
                    preview.dataset.currentUrl = ''; // Clear old URL when new file selected
                };
                reader.readAsDataURL(event.target.files[0]);
            }
        }
        
        // Section Position Control
        let sectionOrder = [
            { id: 'astrological-services', name: 'Astrological Services', icon: 'fa-star' },
            { id: 'pooja-services', name: 'Pooja Services', icon: 'fa-om' },
            { id: 'expert-solutions', name: 'Expert Solutions', icon: 'fa-hands-helping' },
            { id: 'reviews', name: 'Reviews', icon: 'fa-comments' },
            { id: 'about', name: 'About Section', icon: 'fa-user-tie' },
            { id: 'contact', name: 'Contact Section', icon: 'fa-envelope' }
        ];
        
        function loadSectionOrder() {
            const container = document.getElementById('sections-sortable');
            container.innerHTML = sectionOrder.map((section, index) => `
                <div class="section-item flex items-center gap-4 p-4 bg-gray-50 rounded-lg cursor-move hover:bg-gray-100 transition" data-id="${section.id}" draggable="true">
                    <i class="fas fa-grip-vertical text-gray-400"></i>
                    <i class="fas ${section.icon} text-purple-600"></i>
                    <span class="flex-1 font-medium">${section.name}</span>
                    <span class="text-sm text-gray-500">Position: ${index + 1}</span>
                </div>
            `).join('');
            
            // Add drag and drop functionality
            const items = container.querySelectorAll('.section-item');
            items.forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragover', handleDragOver);
                item.addEventListener('drop', handleDrop);
                item.addEventListener('dragend', handleDragEnd);
            });
        }
        
        let draggedItem = null;
        
        function handleDragStart(e) {
            draggedItem = this;
            this.style.opacity = '0.4';
        }
        
        function handleDragOver(e) {
            if (e.preventDefault) e.preventDefault();
            return false;
        }
        
        function handleDrop(e) {
            if (e.stopPropagation) e.stopPropagation();
            if (draggedItem !== this) {
                const container = document.getElementById('sections-sortable');
                const items = Array.from(container.children);
                const draggedIdx = items.indexOf(draggedItem);
                const targetIdx = items.indexOf(this);
                
                if (draggedIdx < targetIdx) {
                    this.parentNode.insertBefore(draggedItem, this.nextSibling);
                } else {
                    this.parentNode.insertBefore(draggedItem, this);
                }
            }
            return false;
        }
        
        function handleDragEnd() {
            this.style.opacity = '1';
            const container = document.getElementById('sections-sortable');
            const items = Array.from(container.children);
            items.forEach((item, index) => {
                const span = item.querySelector('.text-sm');
                span.textContent = `Position: ${index + 1}`;
            });
        }
        
        async function saveSectionOrder() {
            const container = document.getElementById('sections-sortable');
            const items = Array.from(container.children);
            const newOrder = items.map((item, index) => ({
                id: item.dataset.id,
                position: index + 1
            }));
            
            try {
                // Save to database (you'll need to create this API endpoint)
                const response = await fetch('/api/section-order', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ sections: newOrder })
                });
                
                if (response.ok) {
                    showNotification('Section order saved successfully', 'success');
                } else {
                    showNotification('Failed to save section order', 'error');
                }
            } catch (error) {
                console.error('Error saving section order:', error);
                showNotification('Error saving section order', 'error');
            }
        }
        
        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 z-50 px-6 py-4 rounded-lg shadow-2xl transform transition-all duration-300 ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 
                type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
            } text-white font-semibold flex items-center gap-3`;
            
            notification.innerHTML = `
                <i class="fas ${
                    type === 'success' ? 'fa-check-circle' : 
                    type === 'error' ? 'fa-exclamation-circle' : 
                    type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'
                }"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // WhatsApp auto-greeting functions for enhanced customer communication
        function openWhatsAppBooking(phone, name, service, date) {
            const greeting = ` Namaste ${name}!

 Thank you for booking an astrology consultation with Om Sri Mahakali Bhairavi Astrology.

 Booking Details:
 Service: ${service}
 Preferred Date: ${date}

 What to expect in your consultation:
 Detailed birth chart analysis
 Personalized predictions
 Remedial solutions
 Q&A session

 Our consultation hours:
 Mon-Sat: 9:00 AM - 8:00 PM
 Sunday: 10:00 AM - 6:00 PM

 We will contact you shortly to confirm your appointment time.

 Thank you for choosing us for your spiritual journey!

 Om Sri Mahakali Bhairavi Jyotishya Shastram`;
            
            const whatsappUrl = `https://wa.me/${phone}?text=${encodeURIComponent(greeting)}`;
            window.open(whatsappUrl, '_blank');
        }
        
        function openWhatsAppMessage(phone, name, message) {
            const greeting = ` Namaste ${name}!

 Thank you for contacting Om Sri Mahakali Bhairavi Astrology.

 Your Message:
"${message}"

 We have received your inquiry and our expert astrologer will respond to you shortly.

 Our Services:
 Horoscope Reading
 Palmistry & Face Reading
 Numerology Analysis
 Kundali Matching
 Gemstone Consultation
 Vastu Shastra
 Pooja Services

 For urgent consultations:
 Call us directly
 Visit our center

 Thank you for your trust in our services!

 Om Sri Mahakali Bhairavi Jyotishya Shastram`;
            
            const whatsappUrl = `https://wa.me/${phone}?text=${encodeURIComponent(greeting)}`;
            window.open(whatsappUrl, '_blank');
        }
    </script>
</body>
</html>